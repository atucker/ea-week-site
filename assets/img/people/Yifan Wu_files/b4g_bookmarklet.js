(function(){window.b4g=window.b4g||{};var dP,dI;var aY={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(eh){for(var ee=0;ee<eh.length;ee++){var ef=eh[ee].string;var eg=eh[ee].prop;this.versionSearchString=eh[ee].versionSearch||eh[ee].identity;if(ef){if(ef.indexOf(eh[ee].subString)!==-1){return eh[ee].identity}}else{if(eg){return eh[ee].identity}}}},searchVersion:function(ef){var ee=ef.indexOf(this.versionSearchString);if(ee===-1){return}return parseFloat(ef.substring(ee+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};aY.init();var ce="none";switch(aY.browser){case"Chrome":ce="Chrome";break;case"Firefox":ce="Firefox";break;case"Safari":if(aY.version<5.1){ce="Old Safari"}else{ce="Safari"}break;default:ce="Other";break}var dN=false;window.onbeforeunload=function(){if(dN){if(ce==="Firefox"){alert("You are editing a message that you previously scheduled with Boomerang. DO NOT LEAVE THIS PAGE WITHOUT RESCHEDULING. \n\nIf you do, you will CANCEL SENDING THIS MESSAGE ALTOGETHER and the message will remain in your Drafts folder.")}return("You are editing a message that you previously scheduled with Boomerang. DO NOT LEAVE THIS PAGE WITHOUT RESCHEDULING. \n\nIf you do, you will CANCEL SENDING THIS MESSAGE ALTOGETHER and the message will remain in your Drafts folder.")}};var cq="https://s3.amazonaws.com/BoomerangForGmail/bookmarklet/";var bp=a8();var Y=null;var aa=null;var g=Date();var a9=false;var dz=null;var dy="https://b4g.baydin.com/";var bj=["success","success","Boomerang encountered a problem during authentication. Ask Boomerang to send this message again, and we will log you back in.","Boomerang was not able to access the Sent Mail folder. Please enable IMAP and allow Sent Mail to be shown in IMAP.","403 Not Authenticated","Boomerang was not able to access the Drafts folder. Please enable IMAP and allow Drafts to be shown in IMAP.","Boomerang was not able to access the Boomerang-Outbox folder. Please enable IMAP and allow the Boomerang-Outbox label to be shown in IMAP.","Boomerang was not able to access the Inbox. Please enable IMAP. In addition, please allow All Mail to be shown in IMAP.","Boomerang was not able to access the All Mail folder. Please enable IMAP. In addition, please allow All Mail to be shown in IMAP.","Boomerang cannot uniquely identify this email, because there is another draft with the same subject and recipient. Please change the subject and try again.","Boomerang cannot uniquely identify this email, because there is another email in the Boomerang-Outbox with the same subject and recipient. Please change the subject and try again.","Boomerang was unable to find this Draft. Please allow the draft to save again after a couple seconds, then try again. If you are still unsuccessful and you don't mind sharing this message to help improve our product, please forward to support@baydin.com","Boomerang was not able to locate this email. Please try again. If you are still unsuccessful and you don't mind sharing this email to help us improve our product, please forward it to support@baydin.com.","You've reached the maximum number of messages that can be delivered at the time that you specified. Please adjust your delivery time to be at least two minutes apart from your other messages and try again.","Invalid date.","Boomerang was not able to identify the sender of this email. One possible conflict is the Gmail Labs: Authentication icon for verified senders. If you do not have this Labs enabled, please let us know at support@baydin.com.","Boomerang encountered a problem while processing this email. Please try again. If you are still unsuccessful and you don't mind sharing this email to help us improve our product, please forward it to support@baydin.com","nag_screen_1","nag_screen_2","nag_screen_3","paywall","pro","personal","basic","none","account error","Boomerang was not able to access the Boomerang folder. Please enable IMAP and allow the Boomerang label to be shown in IMAP.","Boomerang was not able to access the Boomerang Outbox folder. Please enable IMAP and allow the Boomerang-Outbox label to be shown in IMAP.","Third party cookies must be enabled for Boomerang to work, but they are not currently enabled in your browser.<br/><br/> Please enable them, or create an exception for <strong>b4g.baydin.com</strong>. For information on how to do this, please visit the help page for your browser: <br /><a target='_blank' href='http://support.google.com/chrome/bin/answer.py?hl=en&answer=95647'>Chrome</a> | <a target='_blank' href='http://support.mozilla.org/en-US/kb/Enabling%20and%20disabling%20cookies'>Firefox</a> | <a target='_blank' href='http://docs.info.apple.com/article.html?path=Safari/5.0/en/9277.html'>Safari</a>","You have scheduled too many messages to be sent during that 24-hour period. This message was NOT scheduled. Please schedule your message to be sent at least 24 hours earlier or later. If you want to remove this limit, please upgrade to a paid plan.","premium","Boomerang doesn't support attaching Google+ Photos at this time. Please download this photo to your computer and drag-and-drop the saved copy into the email instead. Alternatively, add it as a regular attachment to the email."];var d8=0;var dV=1;var dG=12;var aq=16;var bZ=17;var dL=18;var bI=19;var cT=0;function dY(ee){return ee===bZ||ee===dL||ee===bI||ee>=b0}var bb=20;var b0=100;var cn=21;var bB=22;var T=23;var aM=24;var cj=25;var a2=30;var v=28;var ds=1;var c1=2;var bk=1;var bP=2;var cm="<div class='overlay' style='background:#bcbcbc; opacity:0.95; filter:alpha(opacity=95);'><img id='blue-arrow' style='position:fixed;top:50px;right:100px;visibility:hidden;' width='200px' height='266px' src='"+cq+"bluegiantarrow.gif' /><div id='dialog' style='height:auto;'><div id='title-bar'>Authenticating...</div><div class='dialog-content' style='text-align:center;'><img src='"+cq+"auth-loader.gif'/></div></div></div>";var cd="<div class='overlay' style='background:#bcbcbc; opacity:0.9; filter:alpha(opacity=9);'></div>";var c6="If you did not see an authentication window, please allow pop-ups for mail.google.com. <ol><li>Click this icon in the upper right corner of your browser window: <img src='"+cq+"popupblockericon.jpg' style='padding-top:5px;padding-bottom:5px;'/> </li><li>Select <strong>\"Always allow popups from mail.google.com\"</strong>.</li><li><a href='javascript: window.location.reload()'>Refresh</a> the page, and try again.</li></ol>";var P="<div id='error_dialog' style=''><ol><li>Do you have a pop-up blocker enabled?<br/><b>Click 'Options' or 'Preferences'</b> in the notification bar above, click on <b>'Allow pop-ups on mail.google.com'</b>, and <a href='javascript: window.location.reload()'>refresh</a>.</li> <li>Added the exception to your pop-up blocker but still getting this? <br/> <a href='http://boomeranggmail.com/faq.html#Troubleshoot'>Click here</a> to troubleshoot.</a></li></div>";var bL="<div class='overlay' style='background:#bcbcbc; opacity:0.9;filter:alpha(opacity=90);'><div id='dialog' style='height:100px'><div id='title-bar'>Logging in...</div><div class='dialog-content'> Please <a id='safari-boomerang' href='javascript:void(0)'>click here</a> so we can log you in with Boomerang.</div></div></div>";var dl="You should try Boomerang for Gmail";var bT="Hey,\r\nI thought you might like this awesome Gmail plugin I have been using.\r\n\r\nHere are some of the things you can do with Boomerang:\r\n1. Write messages now and schedule them to deliver at any time\r\n2. Schedule messages to return to your inbox at a later time\r\n3. Remind yourself to follow up on messages that don't get a response within a certain time\r\n\r\n";var cW=3;var ed=4;var H=/[a-zA-Z0-9\._+\-]+@[a-zA-Z0-9\.\-]+\.[a-z\.A-Z]+/g;function dO(ee){var ef=/^[a-zA-Z0-9\._+\-]+@[a-zA-Z0-9\.\-]+\.[a-z\.A-Z]+$/;return(ef.test(dP.trim(ee)))}var ch=0;var dJ=0;var bG=new Array(7);bG[0]="Monday";bG[1]="Tuesday";bG[2]="Wednesday";bG[3]="Thursday";bG[4]="Friday";bG[5]="Saturday";bG[6]="Sunday";var dd=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;var dt=1;var b2=2;var aT=3;var dr="ddd, dd MMM yyyy HH:mm:ss";var aZ=1;var bH=2;function s(eh){bt(["nag screen","show",eh]);if(ce!=="Old Safari"){if(eh===bZ){c8("<p style='margin: 15px;'>Hey, did you know that you’ve already scheduled more than 10 messages with Boomerang this month?</p> <a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank'>Upgrade</a>",false,"Give me 1 more message!")}else{if(eh===dL){c8("<p style='margin: 15px;'>You have already scheduled beyond the 10 messages Boomerang Basic provides for free.</p> <div style='text-align:center;'><img src='"+cq+"coffecup.png' style='margin:0px auto;'/></div> <p style='margin:0 15px 15px;'>For not much more than a trip to Starbucks a month, you can schedule an unlimited number of messages and help us keep Boomerang running. We've scheduled your message anyway.</p> <a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank'>Upgrade</a>",false,"Give me 1 more message!")}else{if(eh===bI){c8("<p style='margin: 15px;'>You have already scheduled beyond the 10 messages Boomerang Basic provides for free.</p>  <p style='margin: 0 15px 15px 15px;'>You can get more free messages by telling others about Boomerang!</p> <span class='b4g-button green' id='multi-friend-button'>INVITE YOUR CONTACTS</span>",false,"Give me 1 more message!")}else{if(eh===bb){c8("<ul style='list-style-type: none;'><li><i>Our dinner's not steak and fondue</i></li><li><i>Instead it's ramen and stew</i></li><li><i>If our users don't buy</i></li><li><i>We'll starve and then die</i></li><li><i>So no more messages for you!</i></li></ul><p style='margin: 0 15px;'>You’ve hit your quota of messages for this month. Boomerang Basic provides for 10, but you’ve scheduled more than 15. <span style='color:red;'><strong>Your message was NOT scheduled.</strong></span></p><p style='margin: 5px 0 0 15px;'>Please upgrade your subscription to get unlimited message scheduling.</p> <a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank' style='margin-left: 80px;'>Upgrade Subscription</a> <p style='margin: 5px 0 0 15px;'>You can also refer a friend to earn some message credits. </p><a href='https://b4g.baydin.com/refer' class=' b4g-button dialog-gray' id='refer-button' target='_blank'>Refer a friend</a>",false,"<span id='referral_confirm'>No, thanks.</span>")}else{if(eh>=b0){var ee=eh-b0;var ei=(ee&1)===0;var eg=(ee&2)===0;var ef="<div id='referral_success'></div><div id='referral_dialog'><p style='margin: 0 0 18px 0;'>Boomerang Basic provides 10 messages per month for free. You’ve already scheduled 15 this month.</p><p>It costs us money to provide Boomerang to you, so to continue scheduling messages, you can either buy a subscription, or share Boomerang with your followers and earn 25 more credits as thanks.</p> <p class='referral-share-options'><a href='https://b4g.baydin.com/subscriptions' class='b4g-button green' id='signup-button' target='_blank' href='javascript:void(0);'>Upgrade</a> <span>or</span> ";if(eg){ef+="<span class='referral-gplus'><g:plusone callback='b4g_plus' href='http://www.boomeranggmail.com' /></span>"}if(ei){ef+="<a class='b4g-button blue' id='tweet-button' target='_blank' onclick='b4g_tweet();' href='javascript:void(0);'>Tweet Now</a>"}ef+="</p></div>";c8(ef,false,"<span id='referral_confirm'>No! Give me 1 more message anyway.</span>");(function(){var ej=document.createElement("script");ej.type="text/javascript";ej.async=true;ej.src="https://apis.google.com/js/plusone.js";var ek=document.getElementsByTagName("script")[0];ek.parentNode.insertBefore(ej,ek)})()}}}}}}else{if(eh===bZ){alert("Hey, did you know that you’ve already scheduled more than 10 messages with Boomerang this month? That's okay. We've scheduled your message anyway.")}else{if(eh===dL){alert("You have already scheduled beyond the 10 messages Boomerang Basic provides for free. For not much more than a trip to Starbucks a month, you can schedule an unlimited number of messages and help us keep Boomerang running. We've scheduled your message anyway. ")}else{if(eh===bI){alert("Boomerang Basic provides 10 messages per month for free. You’ve already scheduled 15 this month. It costs us money to provide Boomerang to you, so to continue scheduling messages, please upgrade your subscription from Boomerang menu at the top right of your Gmail screen. We've scheduled your message anyway.")}else{alert("Our dinner's not steak and fondue. Instead it's ramen and stew. If our users don't buy. We'll starve and then die. So no more messages for you! You’ve hit your quota of messages for this month. Boomerang Basic provides for 10, but you’ve scheduled more than 15. Please upgrade your subscription to Boomerang Personal or Boomerang Professional. Your message was NOT scheduled. ")}}}}}var ci=document.getElementsByTagName("head")[0];function b4(ef){ef=ef||0;var ee;if(!document.getElementById("b4g-style-css")){ee=document.createElement("link");ee.id="b4g-style-css";ee.type="text/css";ee.rel="stylesheet";ee.href=cq+"css/extensionsafestyle.css?v=2";ee.media="screen";ee.onerror=function(){var eg=document.getElementById("b4g-style-css");eg.parentElement.removeChild(eg);if(ef<10){b4(ef+1)}};ci.appendChild(ee)}if(!document.getElementById("b4g-jqueryui-css")){ee=document.createElement("link");ee.id="b4g-jqueryui-css";ee.type="text/css";ee.rel="stylesheet";ee.href=cq+"css/extensionsafejqueryui.css";ee.media="screen";ee.onerror=function(){var eg=document.getElementById("b4g-jqueryui-css");eg.parentElement.removeChild(eg);if(ef<10){b4(ef+1)}};ci.appendChild(ee)}}var bt=function(){console.log("b4g-track",arguments)};var aR={read:function(ee,ef){setTimeout(function(){var eg=bO(ee);ef(null,eg)},0)},write:function(ee,ef,eg){z(ee,ef);setTimeout(function(){eg(null)},0)}};(function(){var ee=document.createElement("iframe");ee.width=0;ee.height=0;ee.id="b4g-helper";ee.src="https://b4g.baydin.com/site_media/bookmarklet/b4g-helper.html";ee.className="invfr";ee.setAttribute("tabindex","-1");ee.setAttribute("aria-hidden","true");ee.setAttribute("style","position: absolute; top: -10px;");document.body.appendChild(ee);var ef=/https?:\/\/b4g.baydin.com/;window.addEventListener("message",function(ej){if(!ef.test(ej.origin)){return}var ek=null;try{ek=JSON.parse(ej.data)}catch(ei){}if(!ek){return}var eh=ek.contents;if(!eh){return}if(ek.type==="keyboard-migration"||ek.type==="inline-manage-migration"){var eg=ek.contents.key;if(eg in localStorage){return}z(eg,ek.contents.val)}})})();var a;function cp(){a={};var eh=window.location.toString();var ef=eh.indexOf("?");var ee=eh.lastIndexOf("#");if(ef<0){return}if(ee<0){ee=eh.length}var eg=eh.substring(ef+1,ee).split("&");eg.forEach(function(ej){var ei=ej.indexOf("=");a[ej.substr(0,ei)]=ej.substr(ei+1)})}var I;var o=String(document.location);if(o===top.location.toString()&&o.indexOf("ContactManager")<0&&o.indexOf("mu/mp")<0&&o.indexOf("mail-static")===-1&&window.innerWidth>1&&window.innerHeight>1&&document.body.contentEditable!=="true"&&document.body.className.indexOf("editable")===-1){cp();var bs=document.createElement("script");bs.type="text/javascript";bs.src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.2/jquery.min.js";bs.onload=function(){clearTimeout(I);al()};ci.appendChild(bs);al();b4()}function al(){o=String(document.location);if(typeof window.jQuery==="undefined"&&o.indexOf("ContactManager")<0){I=setTimeout(al,500)}else{dR(0)}}function dR(ee){if(ee===0||typeof window.jQuery.ui==="undefined"){I=setTimeout(function(){dR(ee+1)},500);if(ee%10===0){var ef=document.createElement("script");ef.onerror=ef.onload=function(){clearTimeout(I);dR(ee+1)};ef.src=cq+"b4g-jquery-extensions.js?1";ci.appendChild(ef)}}else{dP=dI=window.jQuery.noConflict(true);window.b4g.$=dP;setTimeout(U,0);setTimeout(c9,0)}}function c9(){cS.init();an.init()}function U(){var ee=ao();if(ee!=null&&ee!==""){co()}setInterval(cK,500);aQ(function(){L({type:"is-inbox-zero"})});d();if(a.b4g_troubleshoot==="1"){cA()}}var bn=(function(){var ee=0;return function(eg,ef){clearTimeout(ee);ee=setTimeout(eg,ef)}})();function cK(){if(dP.fn.overlaps==null&&cT<5){document.body.appendChild(document.createElement("script")).src=cq+"b4g-jquery-extensions.js";dP=dI;cT++}else{cT=0}o=String(document.location);if(o.indexOf("mbox")>0){a9=true}if(o.indexOf("inbox")>0){a9=false}if(!cr()){cF()}bp=a8();if(dx()){cQ();return}var ef=dP(cu,bp);var ee=dP(bu,bp);var eg=dP(".aDh").length>0;if(eg){if(cr()){bh()}else{d4()}}if(ee.length>0){ag();if(!bw()){da()}i();bU()}dk();j()}var j=function(){var ee=dP(".D.E.G-atb");ee.each(function(){if(dP(this).css("z-index")!==3){dP(this).css("z-index",3)}})};function bU(){var ee=a8();dP(".nH .hh",ee).filter(function(){if(dP(".cZ",this).text()==="Boomerang for Gmail"){return true}}).hide()}function co(){var ee=bO("hasSeenB4GTutorial");var ef=ao();if(ee==null&&ef){if(bO("b4gMenuEntries")!=null){z("hasSeenB4GTutorial","yes")}else{a4("https://b4g.baydin.com/mailcruncher/hasseentutorial?guser="+encodeURIComponent(ef),ck,"")}}}function ck(eg,ee,ef){z("hasSeenB4GTutorial","yes");if(eg===ds&&ce!=="Old Safari"){bv()}}function cN(){var ef=a8();dP(".dialogdiv").remove();var ee="<div class='dialogdiv multi-friend-content' style='display:none'><div class='multi-friend-load' style='text-align:center; padding: 20px;'><img src='https://b4g.baydin.com/site_media/bookmarklet/auth-loader.gif' style='position:absolute; top: 50px;'/></div><div class='multi-friend-main' style='display:none;'><div class='multi-friend-max-num' style='padding:8px 0 0 0; width:100%; color:#b93f24; text-align:center;font-size: 14px;display: none;'>You may send invites to up to 200 friends.</div><div style='padding: 8px 20px 0px 20px;'><input type='text' class='multi-friend-search' placeholder='Search by name, email, or company'/></div><div id='multi-friend-list'><b class='multi-friend-contacts-non-found' style='display:none;'>No contacts found.</b><div id='most-contact-container' style='display:none;'><div class='top-of-list multi-friend-list-item'><input type='checkbox' value='blank' class='multi-friend-select-all recommended-contacts' style='margin: 3px 10px 3px 0.5ex;' checked/><b>Recommended Contacts (<span class='multi-friend-most-contacted-count'></span>)</b></div><div id='multi-friend-most-contacted'></div></div><div id='all-contact-container' style='display:none;'><div class='top-of-list multi-friend-list-item'><b style='margin: 3px 10px 3px 27px;'>Other Contacts (<span class='multi-friend-contacts-count'></span>)</b></div><div id='multi-friend-contacts'></div></div></div><div class='multi-friend-lower-portion'><div class='multi-friend-credit-count' style='vertical-align: middle; padding-bottom: 15px;'><b>Message Credits Earned: <span id='multi-friend-credit-count-value'>0</span></b></div><div class='multi-friend-credit-help' style='vertical-align: middle; padding-bottom: 15px;'>You receive 1 message credit for each person you email to join Boomerang. If they download Boomerang, you will earn 10+ credits and a chance to win a Kindle Fire!</div><div><input type='button' class='b4g-button green' value='INVITE CONTACTS' id='multiInvitesSubmit' style='font-size:13px;padding: 7px 16px;margin:0 0 3px 0;'/><input type='button' class='b4g-button' value='CANCEL' id='multiInvitesCancel' style='font-size:13px;padding: 7px 16px;margin:0 0 3px 10px;'/></div></div></div></div>";dP("body",ef).append(dP(ee));dP(".dialogdiv",ef).dialog({resizable:false,modal:true,position:["center",75],closeOnEscape:true,width:500,dialogClass:"multi-friend",title:"Invite your contacts to Boomerang for Gmail",});dP.ajax({type:"GET",dataType:"json",position:["center",75],xhr:w,url:"https://b4g.baydin.com/getcontactslist?guser="+encodeURIComponent(aa),success:function(ej){if(ej.rec.length<=0){bt(["multi-friend-selector","error","no recommended contacts"]);dP(".multi-friend-load",ef).text("It doesn't look like you have any contacts!");setTimeout(function(){dP(".dialogdiv").dialog("close")},3000);return}var ei=ej.rec.length+ej.other.length;var eh=ej.rec.length;var eg=ej.other.length;bf(dP("#multi-friend-most-contacted",ef),ej.rec,"recommendedContactsCheck");dP(".multi-friend-most-contacted-count",ef).text(ej.rec.length);dP("#most-contact-container",ef).show();bf(dP("#multi-friend-contacts",ef),ej.other,"otherContactsCheck");dP(".multi-friend-contacts-count",ef).text(0);dP(".otherContactsCheck",ef).parent().hide();dP(".multi-friend-main",ef).show();dP(".multi-friend-load",ef).hide();dP(".b4g-ui-dialog-titlebar-close",ef).hide();dP(".multi-friend-search",ef).keyup(function(em){var en=dP(".multi-friend-search",ef).val().toLowerCase();if(en){var el=0;dP("#all-contact-container",ef).show();dP(".top-of-list",ef).hide();dP(".contact-info",ef).each(function(){if(dP(this).text().toLowerCase().indexOf(en)>=0){dP(this).parent(".contact",ef).show();el++}else{dP(this).parent(".contact",ef).hide()}});if(!el){dP(".multi-friend-contacts-non-found",ef).show()}else{dP(".multi-friend-contacts-non-found",ef).hide()}}else{dP(".top-of-list",ef).show();dP(".recommendedContactsCheck",ef).parent().show();var ek=dP(".otherContactsCheck:checked",ef);if(ek.size()>0){ek.parent().addClass("searchedAndFoundContact",ef);dP(".otherContactsCheck:not(:checked)",ef).parent().hide();dP(".multi-friend-contacts-count",ef).text(dP(".searchedAndFoundContact",ef).size());dP(".searchedAndFoundContact",ef).show()}else{if(dP(".searchedAndFoundContact",ef).size()<=0){dP("#all-contact-container",ef).hide()}else{dP(".otherContactsCheck",ef).parent().hide();dP(".searchedAndFoundContact",ef).show()}}}});dP(".multiFriendCheck",ef).change(function(){var ek=dP(".multiFriendCheck:checked",ef).size();if(ek>=200){dP(".multiFriendCheck:not(:checked)",ef).attr("disabled","disabled");dP(".multi-friend-max-num:not(:visible)",ef).show();dP(".b4g-ui-dialog-title",ef).text("Invite your contacts to Boomerang for Gmail ("+ek+" selected)")}else{if(ek>=190){dP(".multi-friend-max-num:not(:visible)",ef).show();dP(".b4g-ui-dialog-title",ef).text("Invite your contacts to Boomerang for Gmail ("+ek+" selected)")}else{if(ek===0){dP(".b4g-ui-dialog-title",ef).text("Invite your contacts to Boomerang for Gmail")}else{dP(".multi-friend-max-num:visible",ef).hide();dP(".multiFriendCheck:not(:checked) :disabled",ef).removeAttr("disabled");dP(".b4g-ui-dialog-title",ef).text("Invite your contacts to Boomerang for Gmail ("+ek+" selected)")}}}dP("#multi-friend-credit-count-value",ef).text(ek)});dP(".multi-friend-select-all",ef).change(function(){var ek=dP(".multiFriendCheck:checked",ef).size();if(dP(this).is(":checked")){dP(".recommendedContactsCheck:not(:checked)",ef).slice(0,200-ek).attr("checked","checked");dP(".multiFriendCheck",ef).trigger("change");return}dP(".recommendedContactsCheck:checked",ef).removeAttr("checked");dP(".multiFriendCheck",ef).trigger("change")});dP(".multi-friend-select-all",ef).trigger("change");dP("#multiInvitesSubmit",ef).click(function(){bt(["multi-friend-selector","send emails"]);var ek=[];dP(".multiFriendCheck:checked",ef).each(function(){ek.push(dP(this).val())});dM(ef,ek.join(", "),dl,bT)});dP("#multiInvitesCancel",ef).click(function(){bt(["multi-friend-selector","close"]);dP(".dialogdiv").dialog("close")})},error:function(ei,eg,eh){dP(".dialogdiv").dialog("close");if(ei.responseText==="revoked"){bt(["multi-friend-selector","error","OAuth keys revoked"]);d5(cN)}else{if(ei.responseText==="invalid email"){bt(["multi-friend-selector","error","invlaid email"]);bE("Attempt failed: Boomerang cannot identify your email. Contact support@baydin.com for help resolving the issue.")}else{bt(["multi-friend-selector","error",ei.responseText]);bE("Something went wrong. Reload the page and try again.")}}}})}function dM(ej,ei,ef,ee){var eh=/[a-zA-Z0-9\._+-]+@[a-zA-Z0-9\.-]+\.[a-z\.A-Z]+/g;var eg=ei.toLowerCase().match(eh);if(eg==null){alert("Please select at least one email address.");return}document.body.style.cursor="wait";dP.ajax({url:"https://b4g.baydin.com/sendreferralemailinvitations",data:{addresses:ei,subject:ef,body:ee,origin:"f1jp4fqjip"},type:"POST",xhr:w,success:function(ek){document.body.style.cursor="default";dP(".multi-friend-main",ej).hide();dP(".multi-friend-load").show().html("<h2>"+ek+"</h2>");window.setTimeout(function(){dP(".dialogdiv",ej).dialog("close")},2000)},error:function(){document.body.style.cursor="default";alert("There was an error sending out your emails. Try again.")}})}function bf(ej,ei,eg){for(var ef=0;ef<ei.length;ef++){var eh="<span class='contact-info'>"+ei[ef].name+" &lt;"+ei[ef].email+"&gt;</span>";var ee="<div class='contact multi-friend-list-item'><input type='checkbox' value='"+ei[ef].email+"' class='multiFriendCheck "+eg+"'/>"+eh+"</div>";ej.append(dP(ee))}}function bE(eh,ek,eg,ef,ej){var el={Ok:{text:"OK","class":"b4g-button dialog-gray",click:function(){dP(this).dialog("destroy")}}};eg=(typeof eg==="undefined")?el:eg;ek=(typeof ek==="undefined")?"&nbsp &nbsp Boomerang for Gmail":ek;ej=(typeof ej==="undefined")?"dialogdiv":ej;var ei;if(ce==="Old Safari"){alert(eh)}else{var ee=a8();dP("."+ej).remove();ei=dP("<div class='"+ej+"' style='display:none;'>"+eh+"</div>");dP("body",ee).append(ei);dP("."+ej,ee).dialog(dP.extend({title:ek,modal:true,closeOnEscape:true,buttons:eg},ef||{}));aj()}bt(["Show dialog",eh]);return ei}function m(eg,eh){if(ce==="Old Safari"){alert(eg)}else{var ef=a8();dP(".dialogdiv").remove();var ee="<div class='dialogdiv' style='display:none;'>"+eg+"</div>";dP("body",ef).append(dP(ee));dP(".dialogdiv",ef).dialog({title:" &nbsp &nbsp   "+eh,modal:true,closeOnEscape:true,width:450,buttons:{Ok:{text:"Ok","class":"b4g-button dialog-gray",click:function(){dP(this).dialog("destroy")}}}});aj()}}function c8(ej,eh,eg){if(ce==="Old Safari"){alert(ej)}else{var ef,ei=a8();dP(".dialogdiv").remove();if(eg){ef="<div class='dialogdiv' style='display:none;'>"+ej+"<span style='float:right; margin:0 15px 0 0;'><a class='closeLink' href='javascript:void(0)'>"+eg+"</a></span></div>"}else{ef="<div class='dialogdiv' style='display:none;'>"+ej+"</div>"}dP("body",ei).append(dP(ef));if(ej.indexOf("INVITE YOUR CONTACTS")!==-1){dP("#multi-friend-button").click(function(){bt(["multi-friend-selector","click","nag screen"]);d5(cN)})}var ee={title:"Boomerang for Gmail",modal:true,closeOnEscape:true,width:370};if(eh){ee.buttons={Ok:{text:"OK Fine!","class":"b4g-button dialog-gray",click:function(){dP(this).dialog("destroy")}}}}dP(".dialogdiv",ei).dialog(ee);dP(".closeLink").click(function(){dP(".dialogdiv").dialog("close")});aj()}}function A(ee,eg,ef){dP.ajax({method:"get",url:ee,xhr:w,success:function(eh){eg(eh,ee,ef)}})}function d5(eh){var ef=ao();var ee="https://b4g.baydin.com/contacts/checklogin?guser="+ef;function ej(em,ek,el){if(em!=="success"){eg(ei,el)}else{eh()}}function ei(en,el,em){if(en==="success"){eh()}else{if(en==="cookies"){alert("Attempt failed: "+en)}else{if(ce==="Firefox"){bE(P)}else{if(ce==="Safari"||ce==="Old Safari"){var ek=dP(bL);dP("body").append(ek);dP("#safari-boomerang").click(function(){ej(en,el,em);ek.remove()})}else{bE("Attempt failed: "+bj[en])}}}}}function eg(eu,eq){var ep,el=ao();if(ce==="Chrome"){ep=dP(cm);setTimeout(ea,5000)}else{ep=dP(cd)}var eo=800;var et=600;var es=0;var em=0;try{es=window.screenY+Math.max(0,Math.floor((dP(window).height()-et)/2));em=window.screenX+Math.max(0,Math.floor((dP(window).width()-eo)/2))}catch(en){}dP("body").append(ep);var er=window.open("https://b4g.baydin.com/contacts/login?guser="+el,"","width="+eo+",height="+et+",location=1,status=1,resizable=1,top="+es+",left="+em);var ek=setInterval(function(){if((!er&&ce!=="Chrome")||er.closed){ep.remove();clearInterval(ek);if(ce.indexOf("Safari")===-1&&ce.indexOf("Firefox")===-1){A("https://b4g.baydin.com/contacts/checklogin?guser="+el+"&hasAlreadyAuthenticated=True",eu,eq)}else{A("https://b4g.baydin.com/contacts/checklogin?guser="+el,eu,eq)}}},100)}A(ee,ej,"")}function aj(){var ee=a8();if(ce==="Chrome"){dP(".dialogdiv a",ee).click(function(){var ef=dP(this).attr("href");if(ef.indexOf("javascript")===-1){window.open(ef,"_blank")}})}}function t(ee){bt(["welcome dialog","show",ee]);var ef="";var eh="";switch(ee){case 1:ef="<div id='wc_screen'> <div class='wc_header'>Thank you for installing Boomerang.</div> <div class='wc_text'>Let's take you on a tour of Boomerang features inside Gmail.</div> <div class='wc_img'><div style='margin-top: 15px; margin-bottom: 5px;'><span style='margin-left: 100px;'><strong>Return messages to inbox</strong></span><span style='margin-left:100px;'><strong>Schedule messages</strong></span></div><img class='wc_screenshot' width='475px' style='margin-left: 70px;' src='"+cq+"1_ftuepic.png' /></div><div class='wc_pg_no'>1 of 5 <span class='startButton b4g-button red'>START</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";eh="This feature is available in Safari versions 5.1 and higher. Please update Safari to use this feature.";break;case 2:ef="<div id='wc_screen'> <div class='wc_header'>Boomerang</div> <div class='wc_text'>Bring a message back to your inbox when you want it.</div> <div class='wc_img'><p class='wc_img_header'>Clicking on the Boomerang button will allow you to specify the time you want the message back in your inbox.</p><div align='center'><img class='wc_screenshot' height='106px' src='"+cq+"2_boomerangbutton.png' /></div><br/> <a class='wc_video_link' href='http://www.youtube.com/watch?v=XU1iRwqJC1U' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'> Watch a video to learn more.</a></div><div class='wc_pg_no'>2 of 5 <span class='previousButton b4g-button'>BACK</span><span class='nextButton b4g-button green'>NEXT</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";break;case 3:ef="<div id='wc_screen'> <div class='wc_header'>Send Later</div> <div class='wc_text'>Schedule a message to be sent anytime as long as it's in the future.</div> <div class='wc_img'><p class='wc_img_header'>Write a message in Gmail like you always do and then click Send Later menu to specify the time you want it sent. You don’t need to do anything else, we will handle the rest.</p><div align='center'><img class='wc_screenshot' height='160px' src='"+cq+"3_sendlater.jpg' /></div><a class='wc_video_link' href='http://www.youtube.com/watch?v=abqz45EN98w' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'> Watch a video to learn more.</a></div><div class='wc_pg_no'>3 of 5 <span class='previousButton b4g-button'>BACK</span><span class='nextButton b4g-button green'>NEXT</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";break;case 4:ef="<div id='wc_screen'> <div class='wc_header'>Manage Scheduled Messages</div> <div class='wc_text'>View, reschedule or cancel scheduled messages all in one place.</div> <div class='wc_img'><p class='wc_img_header'>Open the Boomerang  menu on the top right of Gmail screen. and click on  the Manage scheduled messages option. There, you will be able to see the list of all scheduled messages and reschedule or cancel them if you change your mind. You can also set your preferences for Booomerang.</p><div align='center'><img class='wc_screenshot' width='253px' src='"+cq+"4_manage.jpg' /></div><br/><a class='wc_video_link' href='http://www.youtube.com/watch?v=_gWiqyVYOrc' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'> Watch a video to learn more.</a></div><div class='wc_pg_no'>4 of 5 <span class='previousButton b4g-button'>BACK</span><span class='nextButton b4g-button green'>NEXT</span><a class='skipButton b4g-button' href='javascript:void(0)'>SKIP</a> </div></div>";break;case 5:ef="<div id='wc_screen'><div class='wc_header'>More Advanced Features</div><div class='wc_text'>Boomerang includes a few more features that can help you with your Inbox management.</div><div class='wc_img' ><ul><li><span class='wc_text'><strong>Response Tracking</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=IfqOJV_3uqI' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Track responses to any email you send or receive and get a reminder if you don't get a reply</span></li><br/><li><span class='wc_text'><strong>Recurring Messages</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=_2BlqvRmi-s' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'></a><br/><span>Write an email and send it every day, week, month or any interval you choose</span></li><br/><li><span class='wc_text'><strong>Notes</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=uwNoNCUBP4M' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Add notes to your Boomerang'ed messages</span></li><br/><li><span class='wc_text'><strong>Boomerang Mobile</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=MUZppQm08LM' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Schedule messages on the go on any smart phone or tablet</span></li><br/><li><span class='wc_text'><strong>Read Receipts</strong></span><a class='wc_video_link' href='http://www.youtube.com/watch?v=YJiMO1weJhA' target='_blank'><img src='"+cq+"playbutton.png' style='position:relative; top:3px;'></a><br/><span class='wc_img_header'>Receive a notification about whether an email is opened or if links in the email are clicked.</span></li></ul></div><div class='wc_pg_no'>5 of 5<span class='previousButton b4g-button last'>BACK</span><a class='skipButton b4g-button green' href='javascript:void(0)'>FINISH</a></div></div></div>";break}if(ce==="Old Safari"){alert(eh)}else{bp=a8();dP(".dialogdiv").remove();var eg="<div class='dialogdiv' style='display:none;'>"+ef+"</div>";dP("body",bp).append(dP(eg));dP(".dialogdiv",bp).dialog({modal:true,closeOnEscape:true,width:770,dialogClass:"welcomeDialog"});dP(".startButton").click(function(){t(2)});dP(".skipButton").click(function(){dP(".dialogdiv").dialog("close")});dP(".nextButton").click(function(){t(ee+1)});dP(".previousButton").click(function(){t(ee-1)});aj()}}function bo(){var eg=bO("b4gshowcardexpired")==="true";var ee=Date.parse(bO("b4gshowcardexpiredafter"))||Date.today().addDays(-4);var ef=Date.parse(bO("b4glastcheckedbillingstatusdate")||Date.today().addDays(-365));if(eg&&(Date.compare(Date.today(),ee)>-1)){bq()}else{if(Date.compare(Date.today(),Date.parse(ef).addDays(5))>-1){bq()}}}function bq(){function ef(){var ei=new Date(2013,3,17);var eg=new Date();var eh=(eg-ei)/(24*60*60*1000);var ej=eh/5;return ej>Math.random()}if(!ef()){return}a4("https://b4g.baydin.com/mailcruncher/checkbillinginfo?guser="+ao(),function ee(ei,eh,ej){var eg=ei;z("b4glastcheckedbillingstatusdate",Date.today().toString(dr));if(eg===aT){N();z("b4gshowcardexpired",true)}else{if(eg===b2){z("b4gshowcardexpired",false)}else{z("b4gshowcardexpired",false)}}})}function N(){var eg=a8();var ef=ao();var ee=dP("<div class='b4g_card_expired_bar'><div>Your credit card payment for Boomerang was declined. <strong>Please update your billing information.</strong></div> <div style='height: 50px; line-height: 50px;'><a class='b4g-button red' id='b4g_card_expired_fix' style='display: inline; margin:0px;' target='_blank' href='https://b4g.baydin.com/fixexpiredbilling?guser="+encodeURIComponent(ef)+"'>FIX THIS</a><a id='billing_expired_snooze'>Remind me later</a><a id='billing_expired_downgrade' style='text-decoration: none;' target='_blank' href='https://b4g.baydin.com/cancelsubscription?guser="+encodeURIComponent(ef)+"'>Cancel my subscription</a></div></div>");ee.css({padding:"20px 0px 10px 0px",color:"#555",background:"#FFF1A8",border:"1px solid #EEE","text-align":"center"});if(dP(".b4g_card_expired_bar",eg).length===0){dP(".aiw",eg).find(".nH").first().show().append(ee)}dP("#billing_expired_snooze",eg).click(function(){ee.hide();z("b4gshowcardexpiredafter",Date.today().addDays(3).toString(dr));z("b4gshowcardexpired",true);bt(["credit card expiration","clicked_RemindLater"])});dP("#b4g_card_expired_fix",eg).click(function(){ee.hide();z("b4gshowcardexpired",true);z("b4gshowcardexpiredafter",Date.today().addDays(3).toString(dr));bt(["credit card expiration","clicked_FixThis"])});dP("#billing_expired_downgrade",eg).click(function(){ee.hide();z("b4gshowcardexpired",false);bt(["credit card expiration","clicked_CancelMySubscription"])});bt(["credit card expiration","show"])}function aA(){var eg=a8();var ef=ao();var ee=bO("b4gshowcoupon")==="true";var ei=Date.parse(bO("b4glastcheckedcouponstatusdate")||Date.today().addDays(-365));if(ee){b7()}else{if(Date.compare(Date.today(),Date.parse(ei).addDays(2))>-1){a4("https://b4g.baydin.com/mailcruncher/checkcouponstatus?guser="+ef,function eh(ek,ej,el){z("b4glastcheckedcouponstatusdate",Date.today().toString(dr));var em=ek;if(em===aZ){z("b4gshowcoupon",true);b7()}})}}}function b7(){var ef=a8();var ee=ao();var eg=dP("<div class='b4g_coupon_bar'><div style='text-align:right; padding:5px; height:0px;'><span style='text-align:right; cursor:pointer; padding:10px; font-size:1.3em;' class='b4g_coupon_dismiss_forever'>x</span></div><div style='display:inline-block;'><img src='"+cq+"bts_image.png' style='position:relative; top:2px; margin-right:20px'/></div><div style='display:inline-block; text-align:center;'><div style='margin:2px'><strong>Today only! Save 30% off your first year of Boomerang.</strong>*</div><div style='margin:2px'><strong>Use coupon \"back2school\"</strong></div><div><a style='margin-top: 10px;' class='b4g-button green' id='b4g_coupon_buy' href='javascript:void(0)'>SUBSCRIBE NOW</a> <a style='color: #999;' class='b4g_coupon_dismiss_forever' href='javascript:void(0)'>No thank you. Please go away.</a></div><p style='color: #999;margin:0px; font-size:.7em;'>*New individual subscribers only. Discount applies the first year only.</p></div></div>");eg.css({color:"rgb(249,249,249)",background:"#34383b",padding:"0px","text-align":"center",});if(dP(".b4g_coupon_bar",ef).length===0){dP(".aiw",ef).find(".nH").first().show().append(eg);dP("#b4g_coupon_buy",ef).click(function(){z("b4gshowcoupon",false);window.open("https://b4g.baydin.com/subscriptions","_blank");b4g_send_image_request("https://b4g.baydin.com/mailcruncher/clearcouponstatus?guser="+ee,function(){},"success");bt(["coupon notification","clicked_buy"])});dP(".b4g_coupon_dismiss_forever",ef).click(function(){eg.hide();b4g_send_image_request("https://b4g.baydin.com/mailcruncher/clearcouponstatus?guser="+ee,function(){},"success");z("b4gshowcoupon",false);bt(["coupon notification","clicked_dismiss"])})}bt(["coupon notification","show"])}function ai(eh,ef){if(!ef){ef=a8()}var eg="";var ee=dP("[name='"+eh+"']",ef);ee.each(function(){eg+=dP(this).val()+" "});return(!eg?"":n(eg))}function x(){var ef=a8();dP(".dialogdiv").remove();var ee=dn();dP("body",ef).append(dP(ee));bQ();dP(".dialogdiv",ef).dialog({modal:true,closeOnEscape:true,width:500,title:"Boomerang Settings",buttons:{Ok:{text:"OK",style:"padding: 5px 20px;","class":"b4g-button by-button by-button-secondary",click:function(){if(bC(dP(this))){dP(this).dialog("destroy")}}},Cancel:{text:"Cancel",style:"padding: 5px 20px;","class":"b4g-button dialog-gray by-button",click:function(){dP(this).dialog("destroy")}}}});aj();dP(".dialogdiv .b4g_settings_dialog").hide();dP(".dialogdiv .b4g_settings_shortcuts_question").click(function(eg){dP(this).next("ul").toggle();bt(["keyboard-shortcuts-explanation","toggle"])});dP.ajax({method:"get",url:"https://b4g.baydin.com/getpreferences/",xhr:function(){var eg=dP.ajaxSettings.xhr();eg.withCredentials=true;return eg},success:function(en){if(!en){bt(["Settings Dialog","failed launch"]);dP(".dialogdiv").remove();bE("<p>There seems to be an issue with your login credentials. Try visiting the <a href='https://b4g.baydin.com/settings'>manage page</a> to adjust your settings.</p>");return}var eo=(en.unread?"checked":"");var ei=(en.starred?"checked":"");var eh=(en.topInbox?"checked":"");var ep=(en.labelled?"checked":"");var eu=(en.onSendSetting?"checked":"");var ej=(en.onSendOffset==null)?"1_weeks":en.onSendOffset;var eg=(en.onSendCond==null)?"reply":en.onSendCond;var et=(en.readReceipts?"checked":"");var ek=(en.plan==="premium"?true:false);dP("#unread",ef).attr("checked",eo);dP("#starred",ef).attr("checked",ei);dP("#topinbox",ef).attr("checked",eh);dP("#labelled",ef).attr("checked",ep);dP("#keyboard-shortcuts",ef).attr("checked",an.is_enabled());bt(["Settings Dialog","successful launch"]);if(ek){dP(".b4g_settings_premium_link",ef).hide();dP(".b4g_premium-text-disabled",ef).removeClass(".b4g_premium-text-disabled").css("color","#333");dP(".b4g_send_condition_settings_box",ef).show();dP("#b4g_send_check",ef).attr("checked",eu);dP("[name=ifResponseSettingCond]",ef).val(eg);dP("#b4g_read_receipt_check",ef).attr("checked",et);var em=ej.split("_");dP("[name=ifResponseSettingNum]",ef).val(em[0]);dP("[name=ifResponseSettingUnit]",ef).val(em[1]);if(eu!=="checked"){dP(".pref-select",ef).attr("disabled","disabled").removeClass("b4g-enabled-pref").addClass("b4g-disabled-pref");dP(".b4g_send_condition_value_settings_box",ef).addClass("b4g-disabled-send-condition")}dP("#b4g_crm_enabled").click(function(){if(dP(this).is(":checked")){dP(".b4g_crm_hide_if_disabled").show()}else{dP(".b4g_crm_hide_if_disabled").hide()}});if(en.crm.active){dP("#b4g_crm_enabled").attr("checked",true);dP(".b4g_crm_hide_if_disabled").show()}var ew=en.crm.bccAddress;dP("#b4g_bccAddress").val(ew);dP("#b4g_bccAddressDisplay").text(ew);var er=en.crm.crm;dP("#b4g_crm_select").val(er);var el=en.crm.bccIncludeWith;dP(".b4g_crm_include_with[value="+el+"]").attr("checked",true);var eq=function(){dP("#b4g_bccAddress").show().select();dP("#b4g_bccAddressDisplay").hide();dP("#b4g_edit_link").hide();dP("#b4g_save_link").show()};var es=function(){dP("#b4g_bccAddress").hide();dP("#b4g_bccAddressDisplay").show();dP("#b4g_edit_link").show();dP("#b4g_save_link").hide();var ex=dP("#b4g_bccAddress").val();if(dO(ex)){dP("#b4g_bccAddressDisplay").text(ex);return true}else{eq();console.log(ex);alert("Please enter a valid email address.");return false}};if(dP.trim(ew).length>0){es()}else{eq()}dP("#b4g_edit_link").click(eq);dP("#b4g_save_link").click(es);var ev=function(){var ey=dP("#b4g_crm_select").val();var ex=dP("#b4g_bccAddress");switch(ey){case"salesforce":ex.attr("placeholder","example@salesforce.com");break;case"highrise":ex.attr("placeholder","dropbox@12345678.highrisehq.com");break;case"insightly":ex.attr("placeholder","example@mailbox.insight.ly");break;case"capsule":ex.attr("placeholder","dropbox@12345678.example.capsulecrm.com");break;case"sugar":ex.attr("placeholder","example@sugarondemand.com");break;case"pipedrive":ex.attr("placeholder","12345@dropbox.pipedrive.com");break;case"zoho":ex.attr("placeholder","example@emails.zohocrm.com");break;default:ex.attr("placeholder","example@example.com");break}};ev();dP("#b4g_crm_select").change(ev)}else{dP(".b4g_send_condition_settings_box",ef).show();dP(".pref-select",ef).attr("disabled","disabled").removeClass("b4g-enabled-pref").addClass("b4g-disabled-pref");dP("#b4g_send_check",ef).attr("disabled","disabled");dP("#b4g_read_receipt_check",ef).attr("disabled","disabled");dP("#b4g_crm_enabled",ef).attr("disabled","disabled");dP(".b4g_send_condition_settings_box",ef).addClass("b4g-disabled-send-condition")}dP(".b4g_settings_loading",ef).hide();dP(".b4g_settings_dialog",ef).show();dP(".pref",ef).change(function(){if(this===dP("#unread",ef).get(0)&&this.checked==0){dP("#topinbox",ef).get(0).checked=0}else{if(this===dP("#topinbox").get(0)&&this.checked==1){dP("#unread").get(0).checked=1}}if(ek){if(this===dP("#b4g_send_check_cond").get(0)){if(dP(this).val()==="no open"){dP("#b4g_read_receipt_check").attr("checked","checked")}}else{if(this===dP("#b4g_read_receipt_check").get(0)){if(!dP(this).is(":checked")&&dP("#b4g_send_check_cond").val()==="no open"){dP("#b4g_send_check_cond").val("always")}}}if(dP("#b4g_send_check",ef).get(0).checked){dP(".pref-select",ef).removeAttr("disabled").removeClass("b4g-disabled-pref").addClass("b4g-enabled-pref");dP(".b4g_send_condition_value_settings_box",ef).removeClass("b4g-disabled-send-condition")}else{dP(".pref-select",ef).attr("disabled","disabled").removeClass("b4g-enabled-pref").addClass("b4g-disabled-pref");dP(".b4g_send_condition_value_settings_box",ef).addClass("b4g-disabled-send-condition")}}})},error:function(){window.open("https://b4g.baydin.com/settings","_blank");dP(".dialogdiv").remove();bt(["dev-CORS","failure","XHR-failure"])},dataType:"json"})}function dn(){return"<div class='dialogdiv' style='display:none; margin: 3px; color: #333'><div class='b4g_settings_loading' style='margin: 20px 0; font-size: 24px; width: %100; text-align: center;'>Loading...</div><div class='b4g_settings_dialog' style='font-size: 13px;'><div class='b4g_send_condition_settings_box'><div style='margin: 2px 0 0 0;'><h3 style='margin: 0 0 10px 0;'>When messages are returned, they should be:</h3><div class='bullet_text' style='margin:10px 0 0 0;'><input type='checkbox' class='pref' id='unread' style='margin: 4px 0;vertical-align: middle;'> <label for='unread' style='vertical-align: middle;'>Marked as unread</label><br/><input type='checkbox' class='pref' id='starred' style='margin: 4px 0;vertical-align: middle;'> <label for='starred' style='vertical-align: middle;'>Starred</label> <br/><input type='checkbox' class='pref' id='topinbox' style='margin: 4px 0;vertical-align: middle;'> <label for='topinbox' style='vertical-align: middle;'>At the top of your inbox</label><br/><input type='checkbox' class='pref' id='labelled' style='margin: 4px 0;vertical-align: middle;'> <label for='labelled' style='vertical-align: middle;'>Labeled as 'Boomerang-Returned'</label> <br/></div></div><div style='margin: 15px 0'><input type='checkbox' class='pref' id='keyboard-shortcuts' style='margin: 4px 0;vertical-align: middle;'> <label style='vertical-align: middle;' for='keyboard-shortcuts'>Enable keyboard shortcuts</label> <img src='"+cq+"questionmark.png' class='b4g_settings_shortcuts_question' style='cursor:pointer; width:14px; height:14px; vertical-align:middle;'><ul style='display:none; padding-left: 35px; margin-top: 5px;'><li>Press <strong>b</strong> to open the Boomerang menu</li><li>Press <strong>Ctrl/Cmd + s</strong> to open the send later menu (while you are composing a message)</li><li>Use the arrow keys, space bar, and enter to navigate inside the menus.</li></ul></div><div class='bullet_text'><h3 style='margin: 0 0 10px 0;'>Premium Settings</h3><div class='b4g_settings_premium_link' style='margin-bottom:5px;'><a href='https://b4g.baydin.com/subscriptions?utm_source=b4g&utm_medium=settings&utm_campaign=settingslink'>Upgrade to the Premium plan to enable these features.</a></div><div class='b4g_premium-text-disabled' style='color: #999;'><input type='checkbox' class='pref pref-check' id='b4g_read_receipt_check' style='margin: 4px 0;vertical-align: middle;'> <label for='b4g_read_receipt_check' style='vertical-align: middle;'>Request a read receipt for every email I send</label><br/><input type='checkbox' class='pref pref-check' id='b4g_send_check' style='margin: 4px 0;vertical-align: middle;'> <label for='b4g_send_check' style='vertical-align: middle;'>Enable Boomerang for every email I send:</label> <div class='b4g_send_condition_value_settings_box' style='margin-top:5px;'><span style='margin:8px 9px 8px 18px; color:#777;'>Remind me</span><span class='' style='height: 20px; top: 3px; margin: 0 0 6px 10px; padding: 1px 0px;'><select name='ifResponseSettingNum' id='b4g_send_check_num' class='b4g-enabled-pref pref pref-select' style=''><option value='1'>1</option><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option><option value='13'>13</option><option value='14'>14</option><option value='15'>15</option><option value='16'>16</option><option value='17'>17</option><option value='18'>18</option><option value='19'>19</option><option value='20'>20</option><option value='21'>21</option><option value='22'>22</option><option value='23'>23</option><option value='24'>24</option><option value='25'>25</option><option value='26'>26</option><option value='27'>27</option><option value='28'>28</option><option value='29'>29</option><option value='30'>30</option><option value='31'>31</option></select></span><span class='' style='height: 20px; top: 3px; margin: 0 0 6px 4px; padding: 1px 0px;'><select name='ifResponseSettingUnit' id='b4g_send_check_unit' class='b4g-enabled-pref pref pref-select' style=''><option value='hours'>hours</option><option value='days'>days</option><option value='weeks'>weeks</option><option value='months'>months</option></select></span><span style='margin:8px 7px 8px 8px; color:#777;'>after sending</span><span class='' style='height: 20px; top: 3px; margin: 0 0 6px 4px; padding: 1px 0px;'><select name='ifResponseSettingCond' id='b4g_send_check_cond' class='b4g-enabled-pref pref pref-select' style=''><option value='no reply'>if no reply</option><option value='no open'>if not opened</option><option value='always'>regardless</option></select></span></div></div><div class='b4g_premium-text-disabled' style='color: #999;margin-top:10px;'><input type='checkbox' id='b4g_crm_enabled' class='pref' style='vertical-align: middle;'> <label style='vertical-align: middle;' for='b4g_crm_enabled'>Enable CRM Integration</label><br/><div class='b4g_crm_hide_if_disabled' style='display:none;'><div style='clear:both; margin-top:10px; color:#777;'><span style='margin:3px 0px 12px 18px; width:120px; float:left; color:#777;' >Select CRM</span> <select id='b4g_crm_select' class='pref' style='float:left;'><option value='salesforce'>Salesforce</option><option value='highrise'>Highrise</option><option value='insightly'>Insightly</option><option value='capsule'>Capsule</option><option value='sugar'>Sugar</option><option value='pipedrive'>Pipedrive</option><option value='zoho'>Zoho</option><option value='other'>Other</option></select></div><div style='clear:both; color:#777;'><span style='margin:3px 0px 12px 18px; width:120px; float:left; color:#777;' >Bcc Address <img src='https://s3.amazonaws.com/BoomerangForGmail/bookmarklet/questionmark.png' class='b4g_settings_bccaddress_question' style='margin-right: 5px; cursor:pointer; width:14px; height:14px; vertical-align:middle;'></span> <input id='b4g_bccAddress' class='' placeholder='example@salesforce.com' type='text' style='float:left;width:250px; margin-left:0px; padding-left:4px;'><span id='b4g_bccAddressDisplay' style='margin:3px 0px 12px 2px; float:left;'></span><a id='b4g_edit_link' href='javascript:void(0);' style='margin:3px 0px 12px 15px; float:left;'>Edit</a><a id='b4g_save_link' href='javascript:void(0);' style='margin:3px 0px 12px 15px; float:left;'>Save</a></div><div style='clear:both; color:#777;'><span style='margin:0px 2px 0px 18px; width:120px; float:left; color:#777;' >Include with</span> <input style='margin-left: 0px; margin-right: 2px; vertical-align:middle;' class='pref b4g_crm_include_with' type='radio' id='b4g_crm_include_with_every' name='b4g_crm_include_with' value='every'/><label for='b4g_crm_include_with_every'>every email I send</label></div><div style='clear:both; margin-top: 5px; color:#777;'><span style='margin:3px 2px 0px 18px; width:120px; float:left;' ></span> <input style='margin-left: 0px; margin-right: 2px; vertical-align:middle;' class='pref b4g_crm_include_with' type='radio' id='b4g_crm_include_with_boomerang' name='b4g_crm_include_with' value='boomerang' /><label for='b4g_crm_include_with_boomerang'>only emails I Boomerang when sending</label></div></div></div></div></div></div></div>"}function bQ(){dP(".b4g_settings_bccaddress_question").click(function(){var eh=dP("#b4g_crm_select").val();var eg="<p style='margin-left:20px;'>Enter the email address that your CRM provides.</p>";var ef="Other";switch(eh){case"salesforce":ef="How to Find the Bcc Address for Salesforce";eg="<p><strong>How to activate:</strong></p><ol>   <li>Find where it says 'Setup' in the upper right corner and select this option.</li>   <li>In the left menu bar, select 'Email Administration'. </li>   <li>Select the 'Email to Salesforce' tab.</li>   <li>Edit the settings and select the box to activate this feature.</li></ol><p><strong>How to find your Bcc address:</strong></p> <ol>   <li>Find your user name at the upper right corner and select the drop down bar.</li>   <li>Select 'My Settings'.</li>   <li>Select the Email tab under 'My Settings'</li>   <li>Select the 'My Email to Salesforce Tab' (this does not exist until you activate the feature).</li>   <li>You will see your email to salesforce address highlighted.</li></ol>";break;case"highrise":ef="How to Find the Bcc Address for Highrise";eg="<ol>   <li>Log into your Highrise account.</li>   <li>Find 'Account and Settings' and select the drop down bar.</li>   <li>Select 'My Info' from the drop down list.</li>   <li>You will see your BCC email address displayed under '<strong>Your Personal Email Dropbox</strong>'.</li></ol>";break;case"insightly":ef="How to Find the Bcc Address for Insightly";eg="<ol>   <li>Log into your Insightly account.</li>   <li>Select 'Emails' from the menu bar on the left.</li>   <li>You will see your BCC email address displayed there.</li></ol>";break;case"capsule":ef="How to Find the Bcc Address for Capsule";eg="<ol>   <li>Log into your Capsule account.</li>   <li>Select 'User' and then 'My Preferences' in the Capsule navigation bar.</li>   <li>You will see your BCC email address under <strong>'Mail Drop Box'</strong>.</li></ol>";break;case"sugar":ef="How to Find the Bcc Address for Sugar";eg="<p><strong>To activate Sugar Email Archiving for your instance, you must be the admin or request your account admin to follow the steps below:</strong></p><ol>   <li>Log into Sugar CRM.</li>   <li>Navigate to Admin > Email Archiving.</li>   <li>Read and agree to the privacy agreement.</li>   <li>Click <strong>'Enable Email Archiving'</strong>.</li>   <li>Then you will see your BCC address in the field 'Email Archiving Address'.</li></ol>";break;case"pipedrive":ef="How to Find the Bcc Address for Pipedrive";eg="<ol>   <li>Log into Pipedrive CRM.</li>   <li>Go to your Personal Settings.</li>   <li>Select the section named 'Email drop-box'.</li>   <li>Click the radio button 'Enabled' next to Dropbox status.</li>   <li>You will find your BCC address in the 'Your dropbox address' field.</li>   <li>Enter your email address in the box below and click 'Save changes'.</li></ol>";break;case"zoho":ef="How to Find the Bcc Address for Zoho";eg="<p>To activate BCC Dropbox in Zoho:</p><ol>   <li>Log into your Zoho account.</li>   <li>Click <strong>Setup > Users &amp; Permissions > Profiles</strong>.</li>   <li>In the <em>Profiles</em> page, click the <strong>Edit</strong> link corresponding to the profile that you want to edit.</li>   <li>From the list of profiles, select the <strong>BCC Dropbox</strong> check box under <em>General Permissions</em>.</li>   <li>Click <strong>Save</strong>.</li></ol><p>The BCC Dropbox email address will be available in Zoho CRM under <strong>Setup > Personal Settings >BCCDropbox.</strong></p><p>Note: This feature in Zoho is only available to the users on Professional and Enterprise plans.</p>";break;default:break}var ee=eg;if(eh!=="other"){ee="<div class='dialogdiv'>"+ee+"<p><img style='vertical-align:middle;' src='"+cq+"email.png'/><a id='emailme' href='javascript:void(0)' style='vertical-align:middle;'>Email me these instructions</a></p></div>"}bE(ee,ef,undefined,{width:500},"crmhelp");dP("#emailme").click(function(){var ei="https://b4g.baydin.com/mailcruncher/sendcrmreminder?instructions="+encodeURIComponent(eg)+"&subject="+ef;a4(ei,dP.noop());dP(this).replaceWith("<span style='vertical-align:middle;'>Instructions sent!</span>")})})}function ad(ek){var eg=a8();if(ce==="Old Safari"){alert("This feature is available in Safari versions 5.1 and higher. Please update Safari to use this feature.")}else{if(!ek){var ej=ai("to");var ei=ai("cc");var ef=ai("bcc");if(!ej&&!ei&&!ef){bE("Please enter a recipient.");return}}dP(".dialogdiv").remove();var eh=dP("<div class='dialogdiv' style='display:none;'><div id='recurring_dialog'><div id='start_date_time' class='recurring_field'><span class='recurring-row-title'>Starts</span><span id='start_date' class='recurring_right_col'><input id='start_date_input' type='text' name='starts' size='15'/><span id='start_time'>Send Time: <input id='start_time_input' name='time' size='10'/></span></span></div><div  class='recurring_field'><span class='recurring-row-title'>Repeats</span><select id='frequency'  class='recurring_right_col'><option value='day'> Daily</option><option value='week' selected='selected'>Weekly</option><option value='weekday' >Every Weekday</option><option value='month' >Monthly</option><option value='year'>Yearly</option></select></div><div id='num_time_interval'  class='recurring_field'><span class='recurring-row-title'>Every</span><span class='recurring_right_col'><input type='number' value='1' min='1' max='12' name='num_interval' id='num_interval'/><span id='interval'> week</span></span></div><div id='days_of_week'  class='recurring_field'><span class='recurring-row-title'>On</span><span class='recurring_right_col' style='vertical-align: top;'><input class='day_cb' type='checkbox' value='6' name='Sun' style='margin-left:0px'/> Sun<input class='day_cb' type='checkbox' value='0' name='Mon'/> Mon<input class='day_cb' type='checkbox' value='1' name='Tue'/> Tue<input class='day_cb' type='checkbox' value='2' name='Wed'/> Wed<input class='day_cb' type='checkbox' value='3' name='Thur'/> Thur<input class='day_cb' type='checkbox' value='4' name='Fri'/> Fri<input class='day_cb' type='checkbox' value='5' name='Sat'/> Sat</span></div><div  class='recurring_field'><span class='recurring-row-title'> Ends </span><div class='recurring_right_col' style='display:inline-block;vertical-align: middle; line-height: 24px;'><div style='margin-bottom:3px;'><input type='radio' id='radio_num_occurences' name='end_group' checked/> After <input type='number' value='10' min='1' max='100' id='num_occurences' name='num_occurences'/> messages</div><div style='margin-bottom:3px;'><input type='radio' id='radio_end_date' name='end_group'/> On <input id='end_date' value='' name='end_date' size='15'/></div><div style='margin-bottom:3px;'><input type='radio' id='radio_no_end' name='end_group'/> No end date <br/></div></div></div><br/><br/><br/><br/><div id='summary' class='recurring_field'><span class='recurring-row-title'>Summary:</span><div id='recurring_feedback' class='recurring_right_col' style='display:inline-block;padding-right:20px;'> </div></div><div class='b4g-button-container' align='center'><button id='schedule_recurring' class='b4g-button red' style='margin:4px 10px;'> Schedule </button><button id='cancel_recurring' class='b4g-button dialog-gray' style='margin:4px 10px;'>Cancel</button></div><br/></div></div>");dP("body",eg).append(eh);dP(".dialogdiv",eg).dialog({modal:true,title:"Schedule Recurring Message",closeOnEscape:true,width:530,dialogClass:"recurringDialog"});dP(".dialogdiv",eg).css({padding:"0px"});dP("#start_date_input",eg).datepicker({showOn:"button",buttonImage:cq+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,});dP("#end_date",eg).datepicker({showOn:"button",buttonImage:cq+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,onClose:function(em,el){dP("#radio_end_date").attr("checked",true)},});dP(".b4g-ui-datepicker-trigger",eg).css({cursor:"pointer",margin:"-2px 0px 0px -25px"}).hover(function(){dP(this).css("box-shadow","0px 0px 3px #aaa");dP(this).css("-moz-box-shadow","0px 0px 3px #aaa")},function(){dP(this).css("box-shadow","none");dP(this).css("-moz-box-shadow","none")});a1();dP("#schedule_recurring").click(function(){(ek||schedule_recurring)()});dP("#cancel_recurring").click(function(){dP(".dialogdiv").dialog("close")});var ee=new Date().addMinutes(10);dP("#start_date_input").val(ee.toString("MM/dd/yy"));dP("#start_time_input").val(ee.toString("hh:mm tt"));return eh}}function b5(ee){return ee.replace("6","x").replace("5","6").replace("4","5").replace("3","4").replace("2","3").replace("1","2").replace("0","1").replace("x","0")}function c(ee){return ee.replace("0","x").replace("1","0").replace("2","1").replace("3","2").replace("4","3").replace("5","4").replace("6","5").replace("x","6")}function dX(){var ee=dP("#frequency").val();switch(ee){case"day":ee="DAILY";break;case"week":ee="WEEKLY";break;case"weekday":ee="WEEKLY";break;case"month":ee="MONTHLY";break;case"YEARLY":ee="YEARLY";break;default:ee="YEARLY";break}return ee}function cg(eh){var eg=dP(".day_cb:checked").map(function(ei,ej){return dP(ej).val()}).get();var ee="";for(var ef=0;ef<eg.length;ef++){if(ee===""){ee+="("+eg[ef]}else{ee+=","+eg[ef]}}if(ee!==""){ee+=")"}if(eh.getUTCDay()>eh.getDay()||(eh.getUTCDay()===0&&eh.getDay()===6)){ee=b5(ee)}else{if(eh.getUTCDay()<eh.getDay()||(eh.getUTCDay()===6&&eh.getDay()===0)){ee=c(ee)}}return ee}function dQ(){aU();var eg="";try{var em=dX();var eh=dP("#num_interval").val();var eo=dP("#start_date_input").val()+" "+dP("#start_time_input").val();var ef=Date.parse(eo);var ei=ef.getUTCMinutes();var el=ef.getUTCHours();var en=ef.getUTCDate();var ee=ef.getUTCMonth()+1;var ej=cg(ef);eg=ap(em,eh,ei,el,en,ee,ej)}catch(ek){}dP("#recurring_feedback").text(eg)}function ap(ep,eg,ei,ek,er,ef,ej){var en=Date.UTC(new Date().getFullYear(),ef-1,er,ek,ei);var em=new Date(en);var eh=ej;if(em.getUTCDay()>em.getDay()||(em.getUTCDay()===0&&em.getDay()===6)){eh=c(ej)}else{if(em.getUTCDay()<em.getDay()||(em.getUTCDay()===6&&em.getDay()===0)){eh=b5(ej)}}var el="";var eo=eh.replace("(","").replace(")","");for(var eq=0;eq<bG.length;eq++){eo=eo.replace(eq.toString(),bG[eq])}el+=eo;if(el===""){return""}var ee="Every ";if(eg>1){ee+=eg+" "}switch(ep){case"DAILY":ee+="day";break;case"WEEKLY":ee+="week";break;case"MONTHLY":ee+="month";break;case"YEARLY":ee+="year";break}if(eg>1){ee+="s"}ee+=", ";if(ep==="WEEKLY"){ee+="on "+el.split(",").join(", ")+" "}if(ep==="MONTHLY"){ee+="on day "+em.getDate();if(em.getDate()>28){ee+="(or the last day of the month)"}ee+=" "}if(ep==="YEARLY"){ee+="on "+em.toString("MMM d")+" "}ee+="at "+em.toString("hh:mm tt");return ee}function aU(){dP("#recurring_feedback").text("")}function dg(){dP("input.day_cb").each(function(){dP(this).removeAttr("checked")});dP("#days_of_week").css("display","none")}function cM(){dP("#days_of_week").css("display","block")}function a1(){dP("#frequency").change(function(){dP("#num_interval").val(1);if(dP("#frequency").val()==="week"){cM();dP("input.day_cb").attr("checked",false);dP("#interval").text(" week")}else{if(dP("#frequency").val()==="weekday"){cM();dP("input.day_cb").filter("[value='0'], [value='1'], [value='2'], [value='3'], [value='4']").attr("checked",true);dP("input.day_cb").filter("[value='5'], [value='6']").attr("checked",false);dP("#interval").text(" week")}else{dg();dP("input.day_cb").attr("checked",true);dP("#interval").text(" "+dP("#frequency").val())}}dQ()});dP("#num_interval").change(function(){dQ()});dP("#num_interval").click(function(){dQ()});dP(".day_cb, #start_date, #start_time").change(function(){dQ()});dP("#start_time").keyup(function(){dQ()})}function cF(){var ei=a8();var ef=dP("#b4g_manage",ei);if(ef.length>0||ao()===""){return}var eg=dP(".gb_z");if(eg.length===0){eg=dP(".gb_y")}eg.first().before('<div class="manage_menu" style="display: inline-block; -webkit-flex: 0 0 auto; flex: 0 0 auto;" id="b4g_manage"><div><img id="b4g_app_loader_icon" src="'+cq+'b4g_launcher_light.png" title="Boomerang" style="position: relative; top: 7px; left:3px;"/></div></div>');var ek=dP(".gb_A");ek.click(function(){dP(ei).click()});dP("#b4g_app_loader_icon").hover(function(){dP(this).attr("src",cq+"b4g_launcher_color.png")},function(){dP(this).attr("src",cq+"b4g_launcher_light.png")});dP("#b4g_manage",ei).click(function(){p(dP(this))});var ej=40;var eh=dP(".gb_5.gb_tb.gb_f.gb_sb");var ee=eh.css("min-width");var el=(parseInt(ee,10)+ej).toString()+"px";eh.css("min-width",el)}function p(ej){var en,el,er,ei,em;ei=dP(".b4g_manage_dropdown",bp);if(ei.length>0){dP(ei).remove();return}el=ct();em=dy+"managelogin?guser="+encodeURIComponent(ao())+"&userNum="+el;er=dy+"submitinvitelogin?email="+encodeURIComponent(ao());var eo=dy+"toolbox";var eq=dy+"premiumsupport";var ep=aJ();if(av(ep)){var ef="<ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px;'> <li id='tmmanage' > <a href='"+em+"' class='top_menu_option' target='_blank' >Manage scheduled messages</a></li><li id='tmsettings' ><a class='top_menu_option' target='_blank' style='cursor:pointer;'>Settings</a></li><li id='tmtoolbox' > <a href='"+eo+"' class='top_menu_option' target='_blank' >Toolbox</a></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div><ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px;'> <li id='tmpremiumsupport' > <a href='"+eq+"' class='top_menu_option' target='_blank' >Premium Support</a></li><li id='tmfaq' > <a href='http://boomeranggmail.com/faq.html' class='top_menu_option' target='_blank' >Help</a></li><li id='tmhowto' > <a href='javascript:void(0)' class='top_menu_option' target='_blank'>How To</span></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div><ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px'> <li id='tmfriend' ><a href='"+er+"' class='top_menu_option' target='_blank'>Refer a friend</a></li><li id='tmbuy' > <a href='http://b4g.baydin.com/subscriptions?guser="+encodeURIComponent(ao())+"' class='top_menu_option' target='_blank'>Buy a subscription</a></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div>"}else{var ef="<ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px;'> <li id='tmmanage' > <a href='"+em+"' class='top_menu_option' target='_blank' >Manage scheduled messages</a></li><li id='tmsettings' ><a class='top_menu_option' target='_blank' style='cursor:pointer;'>Settings</a></li><li id='tmfaq' > <a href='http://boomeranggmail.com/faq.html' class='top_menu_option' target='_blank' >Help</a></li><li id='tmhowto' > <a href='javascript:void(0)' class='top_menu_option' target='_blank'>How To</span></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div><ul style='list-style-type: none; line-height: 1.8em; padding: 0px 10px; margin-top: 10px; margin-bottom: 10px'> <li id='tmfriend' ><a href='"+er+"' class='top_menu_option' target='_blank'>Refer a friend</a></li><li id='tmbuy' > <a href='http://b4g.baydin.com/subscriptions?guser="+encodeURIComponent(ao())+"' class='top_menu_option' target='_blank'>Buy a subscription</a></li></ul><div style='padding:0px 8px'><div style=\"border-top-style: solid;border-width: 1px;border-color: #ccc;\"></div></div>"}en=dP('<div class="b4g_manage_dropdown manage_menu" style="display: block; width:200px; margin-left:-5px; left:0px; background: #fff; border: 1px solid #ccc; border-color: rgba(0,0,0,.2); box-shadow: 0 2px 10px rgba(0,0,0,.2); overflow: hidden; position: absolute; right: 0; top: 44px; -webkit-animation: gb__a .2s; animation: gb__a .2s; -webkit-border-radius: 2px; border-radius: 2px; -webkit-user-select: text; ">'+ef+'</div><div class="b4g_manage_dropdown" style="display:block; margin-left:5px; left:auto; border-color: transparent;border-style: dashed dashed solid;border-width: 0 8px 8px;position: absolute;z-index: 1;height: 0;width: 0;-webkit-animation: gb__a .2s;animation: gb__a .2s;border-bottom-color: #ccc;border-bottom-color: rgba(0,0,0,.2);top: 36px;"></div><div class="b4g_manage_dropdown" style="display:block; margin-left:5px; left:auto; border-color: transparent;border-bottom-color: #fff;border-style: dashed dashed solid;border-width: 0 8px 8px;position: absolute;top: 37px;z-index: 1;height: 0;width: 0;-webkit-animation: gb__a .2s;animation: gb__a .2s;"></div>');var eg=en.find("a");eg.css("color","#36c");eg.css("text-decoration","none");eg.hover(function(){dP(this).css("text-decoration","underline")},function(){dP(this).css("text-decoration","none")});en.appendTo("#b4g_manage");bt(["Top Menu","Open menu"]);var ek=bO("b4g-inline-manage-last-update-"+ao());if(ek==null){var ee=new Date();var eh=(ee.getMonth()+1)+"/"+ee.getDate()+"/"+ee.getFullYear();ek=eh+" 12:00 AM"}dP(".tmdataupdate",bp).text(ek);dP(bp).click(function(et){var es=cE(et);if(dP(es).parents().andSelf().filter("#b4g_manage").length===0){dP(en).remove();dP(bp).unbind("click")}});dP("#tmdata",bp).click(function(){Q(function(){az(bp)})});dP("#tmmanage",bp).click(function(){bt(["Top Menu","Click manage scheduled messages"])});dP("#tmbuy",bp).click(function(){bt(["Top Menu","Click buy a subscription"])});dP("#tmfaq",bp).click(function(){bt(["Top Menu","Click help"])});dP("#tmhowto",bp).click(function(){bv();bt(["Top Menu","Click How To"])});dP("#tmfriend",bp).click(function(){bt(["Top Menu","Click tell a friend"])});dP("#tmtoolbox",bp).click(function(){bt(["Top Menu","Click toolbox"])});dP("#tmpremiumsupport",bp).click(function(){bt(["Top Menu","Click premium support"])});dP("#tmsettings",bp).click(function(){Q(x);bt(["Top Menu","Click settings"])})}function az(ee){cS.expire_cache();bY("Updating...",2000)}function bv(){t(1)}function ag(){var eh=a8();var ek=dP(".boomerang-button",eh);if(ek.length>0){return}var ef=dP(u,eh);if(ef.length<1){return}var ej=document.createElement("div");ej.innerHTML="<div aria-haspopup='true' style='-webkit-user-select: none; -moz-user-select:none;margin-bottom:0px;margin-top:-2px; outline: none;' role='button' class='J-J5-Ji W6eDmd L3 J-Zh-I J-J5-Ji Bq L3' tabindex='0'><img class='f tk3N6e-I-J3' src='"+cq+"tinyboomlogo.png' style='vertical-align: middle;'/> Boomerang <div class='VP5otc-d2fWKd tk3N6e-I-J3 J-J5-Ji'> </div></div>";var el=dP(".Ykrj7b",eh).html();var ee=dP("html",document).attr("lang");if(ee==="am"){el=dP(".Ykrj7b",eh).html().replace(" ","")}var eg=dP(G,eh).filter(function(){return dP(this).text().trim()===el}).attr("class");dP(ej).attr("class",eg+" boomerang-button b4g_button");var en=null;var em=dP(dc,eh);for(var ei=0;ei<em.length;ei++){en=ej.cloneNode(true);dP(en).click(function(eo){aW(eo,this,cC);bt(["thread menu","click"])});em.get(ei).appendChild(en)}}function da(){var eh=a8();var ek=dP(".b4g-magic",eh);var eo=dP(".cf.hX:contains('Boomerang')",eh);if(ek.length>0||eo.length>0){return}var ee=bg();ee=ah(ee);var ej=b1(ee,new Date(),6);var ei=dP(cV,eh);if(ej.length>0&&ej[0]>new Date()&&ej[0]<new Date().addMonths(18)){var en=extractTime(ee)!=null;var eg="";var ef=new Date(ej[0]);if(en){eg="2 hours before";ef=ef.addHours(-2)}else{eg="1 day before";ef=ef.addDays(-1)}if(ef>new Date()){var em=" <img class='f' src='"+cq+"tinyboomlogo.png' style='margin: 1px 0px -1px 0px; vertical-align: middle;'/> Boomerang this? ";var el=ej[0];em+="<select style='padding: 1px  0;line-height: 12px;' name='magicChoice' id='magicChoice' >";em+="<option value='the week before'>the week before</option><option value='the day before'>the day before</option><option value='the morning of'>the morning of</option><option value='2 hours before'>2 hours before</option><option value='the afternoon of'>the afternoon of</option><option value='the day after'>the day after</option><option value='the week after'>the week after</option></select>";em+="<strong> "+el.toString("MMM d, yyyy")+" "+el.toString("h:mmtt")+"</strong>. ";em+="<input type='submit' id='confirmMagic' value='Confirm'/>";ei.attr("style","height: 25px; padding-top: 5px; margin-bottom: 5px; text-align:center;");ei.html("<span class='vh boomerang b4g-magic' style='font-weight: normal !important; background-color: #FFC; padding: 5px 5px 5px 5px; font-size: 80%; color: rgb(42, 93, 176);'>"+em+"</span> ");if(en){dP("#magicChoice option[value='2 hours before']",eh).attr("selected","selected")}else{dP("#magicChoice option[value='the day before']",eh).attr("selected","selected")}dP("#confirmMagic",eh).click(function(){var er=dP("#magicChoice",eh).val();var eq=6;var ep="";switch(er){case"the week before":ep=new Date(el).clearTime().addDays(-7).addHours(eq);break;case"the day before":ep=new Date(el).clearTime().addDays(-1).addHours(eq);break;case"the morning of":ep=new Date(el).clearTime().addHours(eq);break;case"2 hours before":ep=new Date(el).addHours(-2);break;case"the afternoon of":ep=new Date(el).clearTime().addHours(12);break;case"the day after":ep=new Date(el).clearTime().addDays(1).addHours(eq);break;case"the week after":ep=new Date(el).clearTime().addDays(7).addHours(eq);break;default:ep=new Date(el).addHours(-2)}ei.attr("style","height: 31px; list-style-type:none;padding: 0px 5px 5px 5px;text-align:center;");ei.html("<img class='b4g-magic' src='"+cq+"ajax-loader.gif' alt='Loading...'>");cC(ep,{isByMagic:true});bt(["magic link","click",er])})}}else{ei.html("<span class='vh boomerang b4g-magic' style='display:none'></span>")}}function a0(ee){if(!ee){ee=a8()}var ef=dP(".boomerangSendCheck",ee);if(ef.is(":checked")){ef.hide();ef.attr("disabled",true);ef.after("<img src='"+cq+"checkbox-loader.gif' class='b4g_checkbox_loader' alt='Loading...'>");Q(function(){ef.show();ef.attr("disabled",false);dP(".b4g_checkbox_loader").remove();if(aJ()==="premium"){var eh=JSON.parse(bO("b4g_preferences-"+ao()));if(eh.crm.active&&eh.crm.bccIncludeWith==="boomerang"){var eg=eh.crm.bccAddress;dZ(ee,eg)}}})}}var aF="<div class='b4g-notes' style='width: 220px'><h3 style='margin: 7px 0 10px 0;'>Enter your note below.</h3><textarea rows='10' id='note_entry' style='border:1pxsolid#999;background-color:#fbf1b5;width:100%;box-sizing:border-box;'>Some text</textarea><div style='font-size:.9em'>This note will return with your message.</div><div style='text-align:center;padding:10px 10px 7px 10px;'><button id='notes_save_button' class='by-button by-button-secondary' style='width:70px;'><span class='by-button-text'>Save</span></button><button id='notes_cancel_button' class='by-button' style='width:70px;margin-left:5px;'><span class='by-button-text'>Cancel</span></button></div></div>";function aW(el,eg,ei){var ek=a8();var em=el.target;if(dP(em).closest("#b4g_menu").length>0){return}var ep=ek.getElementById("b4g_menu");if(ep){cD(el,eg)}else{dP("div",eg).addClass("J-Zh-I-JO");dP("div",eg).addClass("J-Zh-I-Kq");var eh='<ul id="b4g_menu" tabindex="0" class="b4g_menu" style="padding:0px;position:absolute;left:'+dP(el.currentTarget).position().left+'px;  background-color: rgb(255, 255, 255); -webkit-user-select: none; min-width: 17em;min-height:auto;" role="menu" aria-haspopup="true" aria-activedescendant=""><div id="b4g_inner_menu" class="b4g_menu SK AX" style="-webkit-user-select: none; font-size:12px;color:#333;padding:0;"><li class="menu-caption" style="list-style-type:none;padding: 7px 11px 0 11px;margin: 0 0 1px 0;"><span style="padding:0px;">Return Conversation to Inbox:</span><img class="b4g_menu" id="notes_toggle" data-tooltip="Add Note" data-tooltip-delay="400" src="'+cq+'notes_off.png"  height="16px" style="opacity:.9;position:absolute;right:31px;top:6px;cursor:pointer;"/><img id="b4g-menu-customization-button" data-tooltip="Customize Menu" data-tooltip-delay="400" src="'+cq+'gear.png" height="16px" style="opacity:.9;position:absolute;right:11px;top:7px;cursor:pointer;"></li><div id="notes_menu" class="b4g_menu SK AX" style="display:none;min-width:17em;min-height:auto;left:2px;margin:5px;border:none;box-shadow:none;-moz-box-shadow:none;">'+aF+'</div><li class="b4g_menu b4g-menu-option" style="padding:6px 11px 6px 11px;"><input type="checkbox" id="conditionalBoomerang" class="b4g_menu" name="condBoomerang"/> Only if nobody responds</li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 6px 11px;background:#ddd;"></li><li class="b4g-standard-times"></li><li class="b4g-custom-times"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 0px 11px;background:#ddd;"></li><li class="menu-caption" style="padding:7px 11px 4px 11px;">At a specific time:</li><li class="b4g-menu-option" style="padding: 0 0 7px 11px;"><div style="color: #666; font-style: italic; font-size: 10px; margin-top: 3px;" class="b4g_menu">Examples: "Monday 9am", "Dec 23"</div><form onsubmit="return false;"><div style="padding-top:3px; vertical-align: middle;" class="b4g_menu"><input style="margin-left:1px;padding:3px 22px 2px 2px;" class="b4g_menu" type="text" name="time" id="datepicker"><input id="specific-time-submit" type="submit" value="Confirm" style="margin: 0px 7px 5px 9px;font-size:11px;vertical-align:top;" class="b4g_menu by-button by-button-secondary"></div><div style="color:#969696;margin-left:1px;"><span id="date-preview" class="b4g_menu" style="color:green;"></span></div></form></li><li class="b4g-menu-divider" style="height:1px;margin:0px 11px;background:#ddd;"></li><li class="b4g-menu-option"><a id="random-time" class="menu-anchor" style="margin:4px 0px;border-width:0px;color:#333;padding: 6px 11px;cursor:pointer;" href="javascript:void(0)"><span style="vertical-align:bottom;margin-left:0px;">Random time</span><img src="'+cq+'down.png" width="10px" style="opacity:.7;vertical-align:middle;margin:-2px 0px 0px 5px;"/></a></li><li class="random b4g-menu-option" style="display:none;"><a class="random_link menu-anchor" href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding:3px 13px;display:block;cursor:pointer;">- By 5pm today</a></li><li class="random b4g-menu-option" style="display:none;"><a class="random_link menu-anchor" href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding:3px 13px;display:block;cursor:pointer;">- Within 1 week</a></li><li class="random b4g-menu-option" style="display:none;margin-bottom:6px;"><a class="random_link menu-anchor" href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding:3px 13px;display:block;cursor:pointer;">- Within 1 month</a></li></div></ul>';dP(eg).parent().append(eh);var eq=dP("#b4g_menu",ek);an.enable_menu_arrow_keys(eq);dP("#conditionalBoomerang",ek).change(function(){bt(["thread menu","conditional boomerang",(dP(this).is(":checked")?"checked":"un-checked")])});h(dP(".b4g-standard-times",ek));X(ek);dP(".b4g_menu_item",ek).click(function(){function eu(ev){ei(ev);bt(["boomerang menu","send later time",ev])}eu(dP(this).text())});if(dz==null||dz<new Date()){Y=Date.today().addDays(2).addHours(8)}else{Y=dz}var er=Y.toString("M/d/yyyy h:mm tt");var ej=dP("#datepicker",ek);ej.val(er);ej.keyup(function(){var eu=dP(this).val();aN(eu)});ej.focus(function(){var eu=dP(this).val();aN(eu)});dP("input#specific-time-submit",ek).click(function(eu){cz(eu,ei)});var eo=a6();if(eo.length>0){dP(".b4g-custom-times",ek).before("<div class='b4g-menu-divider' style='height:1px;margin:6px 11px;background:#ddd;'></div>");for(var es=0;es<eo.length;es++){var ee=cX(eo[es],null);dP(".b4g-custom-times",ek).append(ee)}dP(".b4g-custom-menu-item",ek).hover(function(){dP(this).addClass("J-N-JT")},function(){dP(this).removeClass("J-N-JT")});dP(".b4g-custom-menu-item",ek).click(function(){function eu(ev){bm(ev,ei);bt(["b4g menu","picked",ev])}eu(dP(this).text())})}var et=function(){bW(dP("#random-time:first-child",ek),ep);eb();bt(["thread menu","random time","opened"])};var en=function(){M(dP("#random-time:first-child",ek),ep);eb();bt(["thread menu","random time","closed"])};dP("#random-time",ek).parent().toggle(et,en);dP(".random_link",ek).click(function(){function eu(ev){ei(ev);bt(["b4g menu","random time","picked - "+ev])}eu(dP(this).text())});var ef=dP("#b4g-menu-customization-button",ek);ef.click(function(){ae()});ef.hover(function(){dP(this).css("opacity","1")},function(){dP(this).css("opacity",".9")});dP(ek).bind("click",{owner:eg},aw);cJ(ej);dP(".b4g-ui-datepicker-trigger",ek).css("cursor","pointer");dP(".b4g-ui-datepicker-trigger",ek).css("margin-left","-21px");dP(".b4g-ui-datepicker-trigger",ek).css("margin-top","-2px");dP(".b4g-ui-datepicker-trigger",ek).hover(function(){dP(this).css("box-shadow","0px 0px 3px #aaa")},function(){dP(this).css("box-shadow","none")});ej.mousedown(function(eu){eu.stopImmediatePropagation()});ej.css("-moz-user-select","text");ej.parents().each(function(){dP(this).css("-moz-user-select","text")});ej.focus();ej.select();dP("span#date-preview.b4g_menu",ek).text("");dP("#note_entry",ek).val("");dP("#notes_toggle",ek).click(function(){ak(am,by);bt(["notes","click"])}).hover(function(){dP(this).css("opacity","1")},function(){dP(this).css("opacity",".9")});dP("#notes_save_button",ek).click(function(){cs();if(dP("#note_entry",ek).val()){dP("#notes_toggle",ek).attr("src",cq+"notes_on.png");dP("#notes_toggle",ek).attr("data-tooltip","Edit Note");dP("#notes_toggle",ek).css("top","6px")}eb()});dP("#notes_cancel_button",ek).click(function(){cs();dP("#note_entry",ek).val("");dP("#notes_toggle",ek).attr("src",cq+"notes_off.png");dP("#notes_toggle",ek).attr("data-tooltip","Add Note");dP("#notes_toggle",ek).css("top","6px");eb()});eb()}}function aw(eg){var ee=a8();var ef=cE(eg);if(ef.className.indexOf("ui")!==0&&ef.className.indexOf("J-Zh-I J-J5-Ji Bq L3 J-Zh-I-JO J-Zh-I-Kq")===-1&&ef.className.indexOf("f")!==0&&ef.className.indexOf("VP5otc-d2fWKd")===-1&&ef.className.indexOf("menu-anchor")===-1&&ef.className.indexOf("b4g_menu")===-1&&ef.className.indexOf("menu-caption")===-1&&ef.className.indexOf("send-later-button")===-1&&ef.className.indexOf("boomerang-button")===-1&&ef.className.indexOf("sendboomerang-button")===-1&&ef.className.indexOf("conditional-caption")===-1&&dP(ef).closest(".b4g-ui-datepicker,.b4g_menu").length===0){cD(eg,eg.data.owner);dP(ee).unbind("click",aw)}}function cD(ef,ee){dP("#b4g_menu").remove()}function cJ(ee){ee.datepicker({showOn:"button",buttonImage:cq+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,dateFormat:"m/dd/yy",minDate:0,onSelect:function(eh,eg){var ef=ee;var ei=new Date().toString("hh:mm tt");ef.val(ef.val()+" "+ei);bt(["boomerang menu","select custom time",ef.val()])},onClose:function(eg,ef){ee.focus()}});dP(".b4g-ui-datepicker-trigger",bp).css("margin-left","5px");dP(".b4g-ui-datepicker-trigger",bp).css("vertical-align","middle")}function am(){cs();dP("#note_entry",bp).focus()}function by(){bE("A Personal or Pro subscription is required to use this feature. To add notes, please upgrade your subscription.","Boomerang for Gmail",{Upgrade:{text:"Upgrade to add notes","class":"b4g-button green",click:function(){window.open("https://b4g.baydin.com/subscriptions","_blank")}},"Never mind":{text:"Never mind","class":"b4g-button dialog-gray",click:function(){dP(this).dialog("destroy")}}},{width:350,dialogClass:"b4g-upgradenag-dialog"});bt(["notes","blocked non-subscriber"])}function O(eh,ef){var ee='<a href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding: 3px 11px;display:block;cursor:pointer;" class="b4g_menu_item menu-anchor J-N">'+eh+"</a>";var eg='<div class="b4g-menu-option">'+ee+"</div>";if(ef){eg+='<div class="b4g-menu-divider" style="height:1px;margin:6px 11px;background:#ddd;"></div>'}return eg}function cX(eg,eh){var ee='<a href="javascript:void(0)" style="border-width:0px;text-decoration:none;color:#333;line-height:1.1em;padding: 3px 11px;display:block;cursor:pointer;" class="b4g-custom-menu-item menu-anchor J-N">'+eg+"</a>";var ef='<div class="b4g-menu-option">'+ee+"</div>";return ef}function bW(ef,ee){dP(".random",ee).show();ef.html('<span style="vertical-align:bottom;margin-left:0px;">Random time</span><img src="'+cq+'up.png" width="10px" style="opacity:.7;vertical-align:middle;margin:-2px 0px 0px 5px;"/>')}function M(ef,ee){dP(".random",ee).hide();ef.html('<span style="vertical-align:bottom;margin-left:0px;">Random time</span><img src="'+cq+'down.png" width="10px" style="opacity:.7;vertical-align:middle;margin:-2px 0px 0px 5px;"/>')}function aS(){var ef=a8();var ee=dP("#b4g_inner_menu",ef);if(ee.length>0){ee.empty();dP(".b4g-ui-datepicker").css("display","none");ee.append('<li style="list-style-type:none;text-align:center;padding:0px 2px;margin:6px 0px;">Processing message...</li>');ee.append('<li style="list-style-type:none;padding:5px 10px;text-align:center;"><img src="'+cq+'ajax-loader.gif" alt="Loading..."></li>');eb()}}function a7(ee){var ef=ee.replace(/^\s+|\s+$/g,"").replace(/^in|^In|^IN/,"+");var eg=Date.parse(ef.toLowerCase().replace("tomorrow","").replace("tom",""));if(eg&&eg<new Date()&&dE(ef)&&ef.indexOf("yester")===-1&&ef.indexOf("today")===-1){eg=eg.addDays(7)}if(ef.toLowerCase().indexOf("tom")!==-1){if(!eg){eg=new Date()}eg=eg.addDays(1)}if(eg&&eg<(new Date()).addDays(-1)&&eg>(new Date()).addYears(-1)&&ef.indexOf("day")===-1&&ef.indexOf("now")===-1&&!hasYear(ef)){eg=eg.addYears(1)}if(/^\d{1,2}:\d{1,2}$/.test(ef.trim())&&eg<new Date()){eg=eg.addHours(12);if(eg<new Date()){eg=eg.addHours(12)}}return eg}function dE(ee){var ef=ee.toLowerCase();return(ef.indexOf("sun")===0||ef.indexOf("mon")===0||ef.indexOf("tue")===0||ef.indexOf("wed")===0||ef.indexOf("thu")===0||ef.indexOf("fri")===0||ef.indexOf("sat")===0)}function aN(ee){var ef=a8();if(!ee){return}Y=a7(ee);var eg=ar(Y,true);if(Y==null){dP("#date-preview",ef).html("<span class='b4g_menu' style='color:#ff0000;'>"+eg+"</span>")}else{if(Y<new Date()){dP("#date-preview",ef).html("<span class='b4g_menu' style='color:#ff0000;'>"+eg+"</span>")}else{dP("#date-preview",ef).html("<span class='b4g_menu'>"+eg+"</span>")}}eb()}function ea(){try{var ef=dP(".dialog-content");ef.css("text-align","left");ef.html(c6);dP("#blue-arrow").css("visibility","visible")}catch(ee){}}function dA(){dP(".UD",bp).first().css("visibility","");dP(".UB",bp).first().css("visibility","");dP(".vh",bp).first().html("").css("visibility","").closest(".b8.UC").css("top",-10000)}function dH(){dP(".UD",bp).first().css("visibility","visible");dP(".UB",bp).first().css("visibility","visible");dP(".vh",bp).first().css("visibility","visible").closest(".b8.UC").css("top",0)}function bY(ee,ef){dP(".vh",bp).first().html(ee);dH();setTimeout(dA,ef)}function a8(){var ef=document.getElementById("canvas_frame");if(!ef){return document}var ee=(ef.contentWindow||ef.contentDocument);if(ee.document){ee=ee.document}return ee}function dh(){var ee=null;var ef=document.getElementById("js_frame");if(ef!=null){ee=(ef.contentWindow||ef.contentDocument);if(ee.document){ee=ee.document}}return ee}function W(){return dP(dh()).text().indexOf("Sending in the background")>=0}function ax(){var ej,ee,eg=window.location.hash.toString();if(!eg){var ei=window.location.toString();ee=ei.lastIndexOf("#");if(ee>-1){eg=ei.substr(ei.lastIndexOf("#"))}}ee=eg.lastIndexOf("/");if(ee>-1){var eh=eg.substr(ee+1);var ef=/[0-9a-f]+(?=$|\?)/;ej=ef.exec(eh)}if(ej){ej=ej[0]}else{ej=a.th||""}return ej}function q(ee){return bi("draft",ee).val()}function cE(ee){ee=ee||window.event;return ee.target||ee.srcElement}function bi(ee,ef){if(!ef){ef=a8()}return dP("*[name='"+ee+"']",ef).filter(":first")}function ao(){if(aa){return aa}else{var ee=H;var ej=dP(".msg").html();var eg=ee.exec(ej);if(!eg){eg="";var eh=document.title.split(" ");for(var ei=0;ei<eh.length;ei++){var ef=ee.exec(eh[ei]);if(ef){eg=ef[0]}}}else{eg=eg[0]}aa=eg;return eg}}function ak(ee,ef){y(dD,ee,ef)}function Z(ee,ef){y(aI,ee,ef)}function aH(ee,ef){y(av,ee,ef)}function y(ef,ee,eh){var eg=aJ();if(eg&&ef(eg)){ee()}else{Q(function(){var ei=aJ();if(ef(ei)){ee()}else{eh()}})}}function aJ(){var ee=ao();return bO("b4g_plan-"+ee)}function dD(ee){return ee&&ee!=="basic"}function aI(ee){return ee&&(ee.indexOf("pro")>-1||ee==="premium")}function av(ee){return ee&&(ee==="premium")}function ct(){var ef=String(document.location);var ee=/mail\.google\.com\/mail\/u\/(\d+)/;var eg=ee.exec(ef);var eh;if(eg==null){eh=0}else{eh=eg[1]}return eh}function dx(){return a.b4gEdit==="true"}function bg(){var ei=a8();var ee=ei.getElementsByClassName("hP");var ef=ee[0].childNodes;var eh="";for(var eg=0;eg<ef.length;eg++){var ek=ef[eg].nodeValue;if(ek!=null){eh=eh+ek}}var ej=dP(u,ei);if(ej.length<1){return""}return eh+" "+ej.get(0).firstChild.textContent}function be(eg){var ee,ef=this;ee=bp.createEvent("MouseEvents");ee.initMouseEvent("mousedown",true,true,window,0,0,0,0,0,false,false,false,false,0,null);ef.dispatchEvent(ee);ee=bp.createEvent("MouseEvents");ee.initMouseEvent("mouseup",true,true,window,0,0,0,0,0,false,false,false,false,0,null);ef.dispatchEvent(ee)}function bl(){bp=a8();var ef=dP(".iH .J-Zh-I-KE",bp);if(ef.length===0){ef=dP("[role='button']:visible",bp)}var ee=ef.filter(function(){return dP(this).attr("act")==="7"});ee.each(be)}function bN(){bp=a8();var eg=dP("[role='button']",bp);var ef=eg.filter(function(){return dP(this).attr("act")==="19"}).first();var eh=dP('div[act="19"]',bp).attr("aria-label");if(ef.length<1){eg=dP(".iH .VP5otc-tOAp0c",bp);ef=eg.filter(function(){return dP(this).text().indexOf(eh)!==-1}).first()}if(ef.length<1){eg=dP(".iH .QkhFhe",bp);ef=eg.filter(function(){return dP(this).parent().attr("title").indexOf(eh)!==-1}).first()}var ee=ef.length>0;ef.each(be);return ee}function dp(ef,ee){var eh=window.location.hash;if(dx()){dN=false;window.close()}if(ee==="return"){if(cr()){bl();dN=false;window.onbeforeunload=false;alert(ef);window.close();return}else{bl();bN()}}else{if(ee==="send"||ee==="send_new_compose"){o=String(document.location);if(cr()){alert(ef);window.close();return}else{if(!bN()){if(a9){window.location.hash="#mbox"}else{window.location.hash="#inbox"}if(bw()){dP(".gB.acO",bp).hide().after("<div>"+ef+"</div>");cD()}setTimeout(aX,5000)}}}}dA();aX();var eg=setInterval(function(){if(window.location.hash!==eh||eh==="#inbox"||eh==="#mbox"){bY(ef,5000);clearInterval(eg)}},2000)}function aC(eg,ef,ee){setTimeout(function(){dp(eg,ee)},ef)}function cz(ef,ei){var ee=a8();var eh=Date.parse(Y);if(eh!=null){var eg=dP("#datepicker",ee).val();if(r(eg)){b6(eg);ei(eh)}else{bE("The time you entered is in the past. We can only schedule messages for the future.");bt(["boomerang menu","confirm specific time","error time in the past entered"])}}else{bE("Unable to read specified time. Please try again.");bt(["boomerang menu","confirm specific time","error invalid time"])}bt(["boomerang menu","confirm specific time","clicked"])}function bm(eg,ef){var ee=a7(eg);if(ee!=null){ef(ee)}else{bE("Something went wrong processing the customized date. Please let the Boomerang team know.")}}function aP(eg,ef){if(!ef){ef=a8()}var eh=dP(".conditional-caption",ef);var ee=dC(eg,6);g=ee;eh.data("returnDate",ee);eh.text(String(eg));dP(".b4g-ui-datepicker").css("display","none");eh.removeClass("J-Zh-I-JO");eh.removeClass("J-Zh-I-Kq");dP(".boomerangSendCheck",ef).attr("checked",true);a0(ef);dP(".b4g_menu",ef).remove();bt(["boomerang menu","send boomrang menu","clicked"])}function aO(eh,ef){if(!ef){ef=a8()}var eg=dP(".conditional-caption",ef);var ee=dC(eh,6);g=ee;eg.data("returnDate",ee);eg.text("by "+eh.toString("ddd MMM d h:mm tt"));dP(".b4g-ui-datepicker").css("display","none");eg.removeClass("J-Zh-I-JO");eg.removeClass("J-Zh-I-Kq");dP(".boomerangSendCheck",ef).attr("checked",true);a0(ef);dP(".b4g_menu",ef).remove();bt(["boomerang menu","send specific time","clicked"])}function e(ee,eg){var eh=new Date();var ef=Math.floor(Math.random()*30)-15;switch(eg){case"hours":eh=eh.addHours(parseInt(ee));break;case"days":eh=eh.addDays(parseInt(ee)).addMinutes(ef);break;case"weeks":eh=eh.addWeeks(parseInt(ee)).addMinutes(ef);break;case"months":eh=eh.addMonths(parseInt(ee)).addMinutes(ef);break;default:eh=0}return eh}function cC(er,eh){eh=eh||{};var ej=a8();var eg=ao();var eo=cf();var eq=ay();var ep=bX();var ei=dC(er,6);var ek=ar(ei,false);var el=dP("#note_entry",ej).val();if(el==null){el=""}var ee="https://b4g.baydin.com/mailcruncher/schedulereturn";ee=ee+"?subject="+encodeURIComponent(eo);ee=ee+"&senders="+encodeURIComponent(JSON.stringify(eq));ee=ee+"&guser="+encodeURIComponent(eg);ee=ee+"&sentDates="+encodeURIComponent(JSON.stringify(ep));ee=ee+"&offset="+encodeURIComponent(ei.valueOf());ee=ee+"&threadId="+encodeURIComponent(ax());var ef=dP("html",document).attr("lang");if(!ef||ef==="en-GB"){ee=ee+"&language=English"}else{ee=ee+"&language=notEnglish-"+ef}if(dP("#conditionalBoomerang",ej).attr("checked")){ee=ee+"&conditional="+encodeURIComponent("True")}else{ee=ee+"&conditional="+encodeURIComponent("False")}if(bi("^i").length>0&&o.indexOf("label")>0){ee=ee+"&inbox=True"}else{ee=ee+"&inbox=False"}ee=ee+"&notes="+encodeURIComponent(el);var en=String(document.location);var es="Message will return "+ek+". ";aS();Q(function(){em()});function em(){function et(ev,ew,eu){if(dY(ev)){s(ev)}else{if(ev===bb){s(ev);window.location=en}else{if(ev!==dV){bE("Attempt failed: "+bj[ev]);window.location=en}else{if(ev===dV){L({type:"return-later",isByMagic:eh.isByMagic});cS.expire_cache()}}}}}a4(ee,et,es);aC(es,300,"return")}}function dw(){var ee=dP(".dU",bp);return(ee.length>0)}function a4(eg,ej,eh){var ef=new Image();var ei=new Date();var ee="&uniquestring="+ei.getTime();ef.onload=function(){var ek=ef.width;if(ek>=bj.length&&ek<b0){ek=aq}ef.style.display="none";ej(ek,eg,eh)};ef.src=eg+"&image=True"+ee}function bC(ef){if(dP("#keyboard-shortcuts",ef).is(":checked")){an.enable();bt(["keyboard-shortcuts","toggle","enabled"])}else{an.disable();bt(["keyboard-shortcuts","toggle","disabled"])}var en=(dP("#unread",ef).get(0).checked==1)?"True":"False";var ei=(dP("#starred",ef).get(0).checked==1)?"True":"False";var eh=(dP("#topinbox",ef).get(0).checked==1)?"True":"False";var eo=(dP("#labelled",ef).get(0).checked==1)?"True":"False";var et=(dP("#b4g_send_check",ef).get(0).checked==1)?"True":"False";var ek=dP("#b4g_send_check_num option:selected",ef).val()+"_"+dP("#b4g_send_check_unit",ef).val();var eg=dP("#b4g_send_check_cond option:selected",ef).val();var es=(dP("#b4g_read_receipt_check",ef).get(0).checked==1)?"True":"False";var ej="&onSendSetting="+et+"&onSendOffset="+ek+"&onSendCond="+eg+"&readReceipts="+es;var eu=dP("#b4g_crm_enabled").is(":checked")?"True":"False";var eq=dP("#b4g_crm_select").val();var er=dP("#b4g_bccAddress").val();if(eu==="True"&&!dO(er)){alert("Please enter a valid email address.");return false}var el=dP(".b4g_crm_include_with:checked").val();ej+="&crmActive="+eu+"&crmSelect="+eq+"&crmBcc="+er+"&crmInclude="+el;var ee="https://b4g.baydin.com/changepreferences?unread="+en+"&starred="+ei+"&topInbox="+eh+"&labelled="+eo+ej;var em=ao();var ep={readReceipts:es==="True",onSendOffset:ek,onSendSetting:et==="True",onSendCond:eg,crm:{active:eu,bccIncludeWith:el,bccAddress:er,crm:el}};z("b4g_preferences-"+em,JSON.stringify(ep));dP.ajax({method:"get",url:ee,xhr:function(){var ev=dP.ajaxSettings.xhr();ev.withCredentials=true;return ev},success:function(ev){bt(["Settings Dialog","settings changed successfully"])},error:function(ev){bt(["dev-CORS","failure","XHR-failure"])},});return true}function Q(eg,ee){function ej(eo,ek){function el(et,eq){function ep(ew,ey,ex){if(ew===ed){eu(er,ex)}else{if(ew===dV){et()}else{if(ew===bb){s(ew)}}}}function er(ez,ex,ew){if(ez===dV){et();bo()}else{if(ez===bb){s(ez)}else{if(ez===v){bE("Attempt failed: "+bj[ez]);if(eq){eq("Failed to authenticate.")}}else{if(ce==="Firefox"){bE(P)}else{if(ce==="Safari"||ce==="Old Safari"){var ey=dP(bL);dP("body").append(ey);dP("#safari-boomerang").click(function(){ep(ez,ex,ew);ey.remove()})}else{bE("Attempt failed: "+bj[ez]);if(eq){eq("Failed to authenticate.")}}}}}}}function eu(eC,eF){var ey,ew=ao();if(ce==="Chrome"){ey=dP(cm);setTimeout(ea,5000)}else{ey=dP(cd)}var eA=800;var eG=450;var ex=0;var eE=0;try{ex=window.screenY+Math.max(0,Math.floor((dP(window).height()-eG)/2));eE=window.screenX+Math.max(0,Math.floor((dP(window).width()-eA)/2))}catch(eD){}dP("body").append(ey);var eB=window.open("https://b4g.baydin.com/mailcruncher/login?guser="+ew,"","width="+eA+",height="+eG+",location=1,status=1,resizable=1,top="+ex+",left="+eE);var ez=setInterval(function(){if(!eB&&ce!=="Chrome"||eB.closed){ey.remove();clearInterval(ez);if(ce.indexOf("Safari")===-1&&ce.indexOf("Firefox")===-1){a4("https://b4g.baydin.com/mailcruncher/checklogin?guser="+ew+"&hasAlreadyAuthenticated=True",eC,eF)}else{a4("https://b4g.baydin.com/mailcruncher/checklogin?guser="+ew,eC,eF)}}},100)}var ev=ao();var es="https://b4g.baydin.com/mailcruncher/checklogin?guser="+ev;a4(es,ep,"")}var em=ao();var en={guser:em};if(ek){en.hasAlreadyAuthenticated="True"}dP.ajax({url:"https://b4g.baydin.com/mailcruncher/checklogin2",data:en,type:"GET",xhr:w,success:function(er){var ep=er.status;if(ep==="success"){var es=er.plan;z("b4g_plan-"+em,es);var eq=er.preferences;z("b4g_preferences-"+em,JSON.stringify(eq))}eo(ep)},error:function(){z("b4g_plan-"+em,"pro - trial");el(eg,ee);bt(["dev","checkloginerror",ce])}})}function ei(ek){if(ek==="unauthenticated"){ef(eh)}else{if(ek==="success"){eg();bo()}else{if(ek==="paywall"){s(bb)}}}}function eh(el){if(el==="success"){eg();bo()}else{if(el==="paywall"){s(bb)}else{if(el==="cookies"){bE("Attempt failed: "+bj[v]);if(ee){ee("Failed to authenticate.")}}else{if(ce==="Firefox"){bE(P)}else{if(ce==="Safari"||ce==="Old Safari"){var ek=dP(bL);dP("body").append(ek);dP("#safari-boomerang").click(function(){ei(el);ek.remove()})}else{bE("Attempt failed: Failed to authenticate");if(ee){ee("Failed to authenticate.")}}}}}}}function ef(et){var ep,el=ao();if(ce==="Chrome"){ep=dP(cm);setTimeout(ea,5000)}else{ep=dP(cd)}var eo=800;var es=600;var er=0;var em=0;try{er=window.screenY+Math.max(0,Math.floor((dP(window).height()-es)/2));em=window.screenX+Math.max(0,Math.floor((dP(window).width()-eo)/2))}catch(en){}dP("body").append(ep);var eq=window.open("https://b4g.baydin.com/mailcruncher/login?guser="+el,"","width="+eo+",height="+es+",location=1,status=1,resizable=1,top="+er+",left="+em);var ek=setInterval(function(){if((!eq&&ce!=="Chrome")||eq.closed){ep.remove();clearInterval(ek);if(ce.indexOf("Safari")===-1&&ce.indexOf("Firefox")===-1){ej(et,true)}else{ej(et,false)}}},100)}ej(ei,false)}function cU(ee){var eh=new Date();var eg=ee;if(eh>eg){return new Date()}var ef=Math.floor(Math.random()*(eg-eh));var ei=new Date(eh.valueOf()+ef);return ei}function dS(eg,ee){var ef=new Date(eg);var eh=Date.parse(ee);if(eh==null){return new Date().addDays(7)}else{if(eh.clearTime()<ef.clearTime()){return new Date(eh.addDays(7))}}return new Date(eh)}function aE(ef){var ee=/dinner|evening|night|party/i;return !ee.test(ef)}function S(el,ej,ee,ef){var ek=el.toLowerCase();ek=ek.replace(/(th|rd|nd|st)/g,"");ek=ek.replace(/augu/g,"august");ek=ek.replace(/september/g,"sep");ek=ek.replace(/sept/g,"sep");var ei=hasYear(ek);if(!ei){ek+=", "+ef.getFullYear()}var eh=ej.toLowerCase();eh=eh.replace(/noon/g,"12:00pm");eh=eh.replace(/midnight/g,"12:00am");eh=eh.replace(/at|to|from|until|around/g,"");eh=eh.replace(/[ \.\-\n\r\t]/g,"");eh=eh.replace(/o('|’)?clock|ish/g,":00");eh=eh.replace(/(a\.?m\.?)/g,"am");eh=eh.replace(/(p\.?m\.?)/g,"pm");if(/^\d+$/.test(eh)){eh+=":00"}if(/^\d?\d:?\d*:?\d*$/.test(eh)){if(/^(8|9|10|11):?\d*:?\d*$/.test(eh)&&ee){eh+="am"}else{eh+="pm"}}var eg=Date.parse(ek+" "+eh);if(eg==null){return null}if(!/((a|p)\.?m\.?)/i.test(ej)&&ej&&eg<ef){eg=eg.addHours(12)}if(!ei&&eg<ef&&eg.clone().addDays(21)<new Date()){eg=eg.addYears(1)}return eg}function cG(eh,eg){var ee=[];var ef=new Date(eh);ee.push(new Date(ef));ef=new Date(eh).clearTime().addDays(-7).addHours(eg);ee.push(new Date(ef));ef=new Date(eh).clearTime().addDays(-1).addHours(eg);ee.push(new Date(ef));ef=new Date(eh).clearTime().addHours(eg);ee.push(new Date(ef));ef=new Date(eh).clearTime().addHours(12);ee.push(new Date(ef));ef=new Date(eh).clearTime().addDays(1).addHours(eg);ee.push(new Date(ef));ef=new Date(eh).clearTime().addDays(7).addHours(eg);ee.push(new Date(ef));return ee}function b1(ee,ef,ek){if(ee==null){return[]}var eh=extractDate(ee);var eg=extractTime(ee);var el=extractDay(ee);var ej=aE(ee);if(eg==null){eg="6:45am"}var ei=[];var em=null;if(eh!=null){em=S(eh,eg,ej,ef)}else{if(el!=null){em=S(dS(ef,el).toString("MMM d yyyy"),eg,ej,ef)}}if(em!=null){ei=cG(em,ek)}return ei}function dC(ee,ek){var ej=new Date();var eg=ej.getHours();var eh=false;if(eg<4){eh=true}var ef=Math.floor(Math.random()*30)-15;try{switch(ee.toLowerCase()){case"in 1 hour":ej=ej.addHours(1);break;case"in 2 hours":ej=ej.addHours(2);break;case"in 4 hours":ej=ej.addHours(4);break;case"tomorrow morning":ej=Date.today().addDays(1).addHours(ek).addMinutes(ef);if(eh){ej=ej.addDays(-1)}break;case"tomorrow afternoon":ej=Date.today().addDays(1).addHours(12).addMinutes(ef);if(eh){ej=ej.addDays(-1)}break;case"in 1 day":ej=new Date().addDays(1).addMinutes(ef);break;case"in 2 days":ej=new Date().addDays(2).addMinutes(ef);break;case"in 4 days":ej=new Date().addDays(4).addMinutes(ef);break;case"in 1 week":ej=new Date().addWeeks(1).addMinutes(ef);break;case"in 2 weeks":ej=new Date().addWeeks(2).addMinutes(ef);break;case"in 1 month":ej=new Date().addMonths(1).addMinutes(ef);break;case"- by 5pm today":ej=cU(Date.today().addHours(17));break;case"- within 1 week":ej=cU(Date.today().addDays(7));break;case"- within 1 month":ej=cU(Date.today().addMonths(1));break;default:ej=a7(ee)}}catch(ei){ej=ee}dz=ej;return ej}function ar(ef,ee){if(ef==null){return"Not a valid date/time"}var eg="";if(ef.is().today()){eg+=ee?"Today":"today"}else{if(Date.today().add(1).days().same().day(ef)){eg+=ee?"Tomorrow":"tomorrow"}else{eg+=(ee?"":"on ")+ef.toString("ddd, MMM d, yyyy")}}eg+=(ee?" ":" at ")+ef.toString("h:mm tt");return eg}function n(ei){var ef=H;var eh=ei.match(ef);var ee="";for(var eg=0;eh!=null&&eg<eh.length;eg++){ee+=eh[eg];if(eg<eh.length-1){ee+=" "}}return ee}function ah(ei){var ee=/^Subject:/m;var eg=ei.search(ee);if(eg>0){ei=ei.substring(eg)}var ef=/Show quoted text/;var eh=ei.search(ef);if(eh>0){ei=ei.substring(0,eh)}return ei}function dv(ef){var eh;var ee=ef.length;var eg=[];var ei={};for(eh=0;eh<ee;eh++){ei[ef[eh]]=0}for(eh in ei){if(ei.hasOwnProperty(eh)){eg.push(eh)}}return eg}Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i,feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i,today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"},{name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]};(function(){var ef=Date,ee=ef.prototype,eh=ef.CultureInfo,ek=function(em,el){if(!el){el=2}return("000"+em).slice(el*-1)};ee.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};ee.setTimeToNow=function(){var el=new Date();this.setHours(el.getHours());this.setMinutes(el.getMinutes());this.setSeconds(el.getSeconds());this.setMilliseconds(el.getMilliseconds());return this};ef.today=function(){return new Date().clearTime()};ef.compare=function(em,el){if(isNaN(em)||isNaN(el)){throw new Error(em+" - "+el)}else{if(em instanceof Date&&el instanceof Date){return(em<el)?-1:(em>el)?1:0}else{throw new TypeError(em+" - "+el)}}};ef.equals=function(em,el){return(em.compareTo(el)===0)};ef.getDayNumberFromName=function(em){var eq=eh.dayNames,el=eh.abbreviatedDayNames,ep=eh.shortestDayNames,eo=em.toLowerCase();for(var en=0;en<eq.length;en++){if(eq[en].toLowerCase()==eo||el[en].toLowerCase()==eo||ep[en].toLowerCase()==eo){return en}}return -1};ef.getMonthNumberFromName=function(em){var ep=eh.monthNames,el=eh.abbreviatedMonthNames,eo=em.toLowerCase();for(var en=0;en<ep.length;en++){if(ep[en].toLowerCase()==eo||el[en].toLowerCase()==eo){return en}}return -1};ef.isLeapYear=function(el){return((el%4===0&&el%100!==0)||el%400===0)};ef.getDaysInMonth=function(el,em){return[31,(ef.isLeapYear(el)?29:28),31,30,31,30,31,31,30,31,30,31][em]};ef.getTimezoneAbbreviation=function(eo){var en=eh.timezones,em;for(var el=0;el<en.length;el++){if(en[el].offset===eo){return en[el].name}}return null};ef.getTimezoneOffset=function(el){var eo=eh.timezones,en;for(var em=0;em<eo.length;em++){if(eo[em].name===el.toUpperCase()){return eo[em].offset}}return null};ee.clone=function(){return new Date(this.getTime())};ee.compareTo=function(el){return Date.compare(this,el)};ee.equals=function(el){return Date.equals(this,el||new Date())};ee.between=function(em,el){return this.getTime()>=em.getTime()&&this.getTime()<=el.getTime()};ee.isAfter=function(el){return this.compareTo(el||new Date())===1};ee.isBefore=function(el){return(this.compareTo(el||new Date())===-1)};ee.isToday=function(){return this.isSameDay(new Date())};ee.isSameDay=function(el){return this.clone().clearTime().equals(el.clone().clearTime())};ee.addMilliseconds=function(el){this.setMilliseconds(this.getMilliseconds()+el);return this};ee.addSeconds=function(el){return this.addMilliseconds(el*1000)};ee.addMinutes=function(el){return this.addMilliseconds(el*60000)};ee.addHours=function(el){return this.addMilliseconds(el*3600000)};ee.addDays=function(el){this.setDate(this.getDate()+el);return this};ee.addWeeks=function(el){return this.addDays(el*7)};ee.addMonths=function(el){var em=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+el);this.setDate(Math.min(em,ef.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};ee.addYears=function(el){return this.addMonths(el*12)};ee.add=function(em){if(typeof em=="number"){this._orient=em;return this}var el=em;if(el.milliseconds){this.addMilliseconds(el.milliseconds)}if(el.seconds){this.addSeconds(el.seconds)}if(el.minutes){this.addMinutes(el.minutes)}if(el.hours){this.addHours(el.hours)}if(el.weeks){this.addWeeks(el.weeks)}if(el.months){this.addMonths(el.months)}if(el.years){this.addYears(el.years)}if(el.days){this.addDays(el.days)}return this};var ei,ej,eg;ee.getWeek=function(){var es,er,eq,ep,eo,en,em,el,eu,et;ei=(!ei)?this.getFullYear():ei;ej=(!ej)?this.getMonth()+1:ej;eg=(!eg)?this.getDate():eg;if(ej<=2){es=ei-1;er=(es/4|0)-(es/100|0)+(es/400|0);eq=((es-1)/4|0)-((es-1)/100|0)+((es-1)/400|0);eu=er-eq;eo=0;en=eg-1+(31*(ej-1))}else{es=ei;er=(es/4|0)-(es/100|0)+(es/400|0);eq=((es-1)/4|0)-((es-1)/100|0)+((es-1)/400|0);eu=er-eq;eo=eu+1;en=eg+((153*(ej-3)+2)/5)+58+eu}em=(es+er)%7;ep=(en+em-eo)%7;el=(en+3-ep)|0;if(el<0){et=53-((em-eu)/5|0)}else{if(el>364+eu){et=1}else{et=(el/7|0)+1}}ei=ej=eg=null;return et};ee.getISOWeek=function(){ei=this.getUTCFullYear();ej=this.getUTCMonth()+1;eg=this.getUTCDate();return ek(this.getWeek())};ee.setWeek=function(el){return this.moveToDayOfWeek(1).addWeeks(el-this.getWeek())};ef._validate=function(eo,en,el,em){if(typeof eo=="undefined"){return false}else{if(typeof eo!="number"){throw new TypeError(eo+" is not a Number.")}else{if(eo<en||eo>el){throw new RangeError(eo+" is not a valid value for "+em+".")}}}return true};ef.validateMillisecond=function(el){return ef._validate(el,0,999,"millisecond")};ef.validateSecond=function(el){return ef._validate(el,0,59,"second")};ef.validateMinute=function(el){return ef._validate(el,0,59,"minute")};ef.validateHour=function(el){return ef._validate(el,0,23,"hour")};ef.validateDay=function(em,el,en){return ef._validate(em,1,ef.getDaysInMonth(el,en),"day")};ef.validateMonth=function(el){return ef._validate(el,0,11,"month")};ef.validateYear=function(el){return ef._validate(el,0,9999,"year")};ee.set=function(el){if(ef.validateMillisecond(el.millisecond)){this.addMilliseconds(el.millisecond-this.getMilliseconds())}if(ef.validateSecond(el.second)){this.addSeconds(el.second-this.getSeconds())}if(ef.validateMinute(el.minute)){this.addMinutes(el.minute-this.getMinutes())}if(ef.validateHour(el.hour)){this.addHours(el.hour-this.getHours())}if(ef.validateMonth(el.month)){this.addMonths(el.month-this.getMonth())}if(ef.validateYear(el.year)){this.addYears(el.year-this.getFullYear())}if(ef.validateDay(el.day,this.getFullYear(),this.getMonth())){this.addDays(el.day-this.getDate())}if(el.timezone){this.setTimezone(el.timezone)}if(el.timezoneOffset){this.setTimezoneOffset(el.timezoneOffset)}if(el.week&&ef._validate(el.week,0,53,"week")){this.setWeek(el.week)}return this};ee.moveToFirstDayOfMonth=function(){return this.set({day:1})};ee.moveToLastDayOfMonth=function(){return this.set({day:ef.getDaysInMonth(this.getFullYear(),this.getMonth())})};ee.moveToNthOccurrence=function(em,en){var el=0;if(en>0){el=en-1}else{if(en===-1){this.moveToLastDayOfMonth();if(this.getDay()!==em){this.moveToDayOfWeek(em,-1)}return this}}return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(em,+1).addWeeks(el)};ee.moveToDayOfWeek=function(el,em){var en=(el-this.getDay()+7*(em||+1))%7;return this.addDays((en===0)?en+=7*(em||+1):en)};ee.moveToMonth=function(en,el){var em=(en-this.getMonth()+12*(el||+1))%12;return this.addMonths((em===0)?em+=12*(el||+1):em)};ee.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/86400000)+1};ee.getTimezone=function(){return ef.getTimezoneAbbreviation(this.getUTCOffset())};ee.setTimezoneOffset=function(en){var el=this.getTimezoneOffset(),em=Number(en)*-6/10;return this.addMinutes(em-el)};ee.setTimezone=function(el){return this.setTimezoneOffset(ef.getTimezoneOffset(el))};ee.hasDaylightSavingTime=function(){return(Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset())};ee.isDaylightSavingTime=function(){return(this.hasDaylightSavingTime()&&new Date().getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset())};ee.getUTCOffset=function(){var em=this.getTimezoneOffset()*-10/6,el;if(em<0){el=(em-10000).toString();return el.charAt(0)+el.substr(2)}else{el=(em+10000).toString();return"+"+el.substr(1)}};ee.getElapsed=function(el){return(el||new Date())-this};if(!ee.toISOString){ee.toISOString=function(){function el(em){return em<10?"0"+em:em}return'"'+this.getUTCFullYear()+"-"+el(this.getUTCMonth()+1)+"-"+el(this.getUTCDate())+"T"+el(this.getUTCHours())+":"+el(this.getUTCMinutes())+":"+el(this.getUTCSeconds())+'Z"'}}ee._toString=ee.toString;ee.toString=function(en){var el=this;if(en&&en.length==1){var eo=eh.formatPatterns;el.t=el.toString;switch(en){case"d":return el.t(eo.shortDate);case"D":return el.t(eo.longDate);case"F":return el.t(eo.fullDateTime);case"m":return el.t(eo.monthDay);case"r":return el.t(eo.rfc1123);case"s":return el.t(eo.sortableDateTime);case"t":return el.t(eo.shortTime);case"T":return el.t(eo.longTime);case"u":return el.t(eo.universalSortableDateTime);case"y":return el.t(eo.yearMonth)}}var em=function(ep){switch(ep*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return en?en.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(ep){if(ep.charAt(0)==="\\"){return ep.replace("\\","")}el.h=el.getHours;switch(ep){case"hh":return ek(el.h()<13?(el.h()===0?12:el.h()):(el.h()-12));case"h":return el.h()<13?(el.h()===0?12:el.h()):(el.h()-12);case"HH":return ek(el.h());case"H":return el.h();case"mm":return ek(el.getMinutes());case"m":return el.getMinutes();case"ss":return ek(el.getSeconds());case"s":return el.getSeconds();case"yyyy":return ek(el.getFullYear(),4);case"yy":return ek(el.getFullYear());case"dddd":return eh.dayNames[el.getDay()];case"ddd":return eh.abbreviatedDayNames[el.getDay()];case"dd":return ek(el.getDate());case"d":return el.getDate();case"MMMM":return eh.monthNames[el.getMonth()];case"MMM":return eh.abbreviatedMonthNames[el.getMonth()];case"MM":return ek((el.getMonth()+1));case"M":return el.getMonth()+1;case"t":return el.h()<12?eh.amDesignator.substring(0,1):eh.pmDesignator.substring(0,1);case"tt":return el.h()<12?eh.amDesignator:eh.pmDesignator;case"S":return em(el.getDate());default:return ep}}):this._toString()}}());(function(){var ev=Date,el=ev.prototype,ew=ev.CultureInfo,ep=Number.prototype;el._orient=+1;el._nth=null;el._is=false;el._same=false;el._isSecond=false;ep._dateElement="day";el.next=function(){this._orient=+1;return this};ev.next=function(){return ev.today().next()};el.last=el.prev=el.previous=function(){this._orient=-1;return this};ev.last=ev.prev=ev.previous=function(){return ev.today().last()};el.is=function(){this._is=true;return this};el.same=function(){this._same=true;this._isSecond=false;return this};el.today=function(){return this.same().day()};el.weekday=function(){if(this._is){this._is=false;return(!this.is().sat()&&!this.is().sun())}return false};el.at=function(ef){return(typeof ef==="string")?ev.parse(this.toString("d")+" "+ef):this.set(ef)};ep.fromNow=ep.after=function(ef){var eA={};eA[this._dateElement]=this;return((!ef)?new Date():ef.clone()).add(eA)};ep.ago=ep.before=function(ef){var eA={};eA[this._dateElement]=this*-1;return((!ef)?new Date():ef.clone()).add(eA)};var ej=("sunday monday tuesday wednesday thursday friday saturday").split(/\s/),em=("january february march april may june july august september october november december").split(/\s/),eo=("Millisecond Second Minute Hour Day Week Month Year").split(/\s/),eq=("Milliseconds Seconds Minutes Hours Date Week Month FullYear").split(/\s/),eg=("final first second third fourth fifth").split(/\s/),ey;el.toObject=function(){var eA={};for(var ef=0;ef<eo.length;ef++){eA[eo[ef].toLowerCase()]=this["get"+eq[ef]]()}return eA};ev.fromObject=function(ef){ef.week=null;return Date.today().set(ef)};var ex=function(ef){return function(){if(this._is){this._is=false;return this.getDay()==ef}if(this._nth!==null){if(this._isSecond){this.addSeconds(this._orient*-1)}this._isSecond=false;var eB=this._nth;this._nth=null;var eA=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(ef,eB);if(this>eA){throw new RangeError(ev.getDayName(ef)+" does not occur "+eB+" times in the month of "+ev.getMonthName(eA.getMonth())+" "+eA.getFullYear()+".")}return this}return this.moveToDayOfWeek(ef,this._orient)}};var ek=function(ef){return function(){var eB=ev.today(),eA=ef-eB.getDay();if(ef===0&&ew.firstDayOfWeek===1&&eB.getDay()!==0){eA=eA+7}return eB.addDays(eA)}};for(var eu=0;eu<ej.length;eu++){ev[ej[eu].toUpperCase()]=ev[ej[eu].toUpperCase().substring(0,3)]=eu;ev[ej[eu]]=ev[ej[eu].substring(0,3)]=ek(eu);el[ej[eu]]=el[ej[eu].substring(0,3)]=ex(eu)}var ez=function(ef){return function(){if(this._is){this._is=false;return this.getMonth()===ef}return this.moveToMonth(ef,this._orient)}};var en=function(ef){return function(){return ev.today().set({month:ef,day:1})}};for(var et=0;et<em.length;et++){ev[em[et].toUpperCase()]=ev[em[et].toUpperCase().substring(0,3)]=et;ev[em[et]]=ev[em[et].substring(0,3)]=en(et);el[em[et]]=el[em[et].substring(0,3)]=ez(et)}var eh=function(ef){return function(){if(this._isSecond){this._isSecond=false;return this}if(this._same){this._same=this._is=false;var eE=this.toObject(),eD=(arguments[0]||new Date()).toObject(),eC="",eB=ef.toLowerCase();for(var eA=(eo.length-1);eA>-1;eA--){eC=eo[eA].toLowerCase();if(eE[eC]!=eD[eC]){return false}if(eB==eC){break}}return true}if(ef.substring(ef.length-1)!="s"){ef+="s"}return this["add"+ef](this._orient)}};var ei=function(ef){return function(){this._dateElement=ef;return this}};for(var es=0;es<eo.length;es++){ey=eo[es].toLowerCase();el[ey]=el[ey+"s"]=eh(eo[es]);ep[ey]=ep[ey+"s"]=ei(ey)}el._ss=eh("Second");var ee=function(ef){return function(eA){if(this._same){return this._ss(arguments[0])}if(eA||eA===0){return this.moveToNthOccurrence(eA,ef)}this._nth=ef;if(ef===2&&(eA===undefined||eA===null)){this._isSecond=true;return this.addSeconds(this._orient)}return this}};for(var er=0;er<eg.length;er++){el[eg[er]]=(er===0)?ee(-1):ee(er)}}());(function(){var ee,ek;Date.Parsing={Exception:function(eo){this.message="Parse error at '"+eo.substring(0,10)+" ...'"}};var en=Date.Parsing;var el=en.Operators={rtoken:function(eo){return function(ep){var eq=ep.match(eo);if(eq){return([eq[0],ep.substring(eq[0].length)])}else{throw new en.Exception(ep)}}},token:function(eo){return function(ep){return el.rtoken(new RegExp("^\\s*"+ep+"\\s*"))(ep)}},stoken:function(eo){return el.rtoken(new RegExp("^"+eo))},until:function(eo){return function(ep){var eq=[],es=null;while(ep.length){try{es=eo.call(this,ep)}catch(er){eq.push(es[0]);ep=es[1];continue}break}return[eq,ep]}},many:function(eo){return function(ep){var es=[],eq=null;while(ep.length){try{eq=eo.call(this,ep)}catch(er){return[es,ep]}es.push(eq[0]);ep=eq[1]}return[es,ep]}},optional:function(eo){return function(ep){var eq=null;try{eq=eo.call(this,ep)}catch(er){return[null,ep]}return[eq[0],eq[1]]}},not:function(eo){return function(ep){try{eo.call(this,ep)}catch(eq){return[null,ep]}throw new en.Exception(ep)}},ignore:function(eo){return eo?function(ep){var eq=null;eq=eo.call(this,ep);return[null,eq[1]]}:null},product:function(){var ep=arguments[0],eq=Array.prototype.slice.call(arguments,1),er=[];for(var eo=0;eo<ep.length;eo++){er.push(el.each(ep[eo],eq))}return er},cache:function(eq){var eo={},ep=null;return function(er){try{ep=eo[er]=(eo[er]||eq.call(this,er))}catch(es){ep=eo[er]=es}if(ep instanceof en.Exception){throw ep}else{return ep}}},any:function(){var eo=arguments;return function(eq){var er=null;for(var ep=0;ep<eo.length;ep++){if(eo[ep]==null){continue}try{er=(eo[ep].call(this,eq))}catch(es){er=null}if(er){return er}}throw new en.Exception(eq)}},each:function(){var eo=arguments;return function(eq){var et=[],er=null;for(var ep=0;ep<eo.length;ep++){if(eo[ep]==null){continue}try{er=(eo[ep].call(this,eq))}catch(es){throw new en.Exception(eq)}et.push(er[0]);eq=er[1]}return[et,eq]}},all:function(){var ep=arguments,eo=eo;return eo.each(eo.optional(ep))},sequence:function(eo,ep,eq){ep=ep||el.rtoken(/^\s*/);eq=eq||null;if(eo.length==1){return eo[0]}return function(eu){var ev=null,ew=null;var eA=[];for(var et=0;et<eo.length;et++){try{ev=eo[et].call(this,eu)}catch(ez){break}eA.push(ev[0]);try{ew=ep.call(this,ev[1])}catch(es){ew=null;break}eu=ew[1]}if(!ev){throw new en.Exception(eu)}if(ew){throw new en.Exception(ew[1])}if(eq){try{ev=eq.call(this,ev[1])}catch(er){throw new en.Exception(ev[1])}}return[eA,(ev?ev[1]:eu)]}},between:function(ep,eq,eo){eo=eo||ep;var er=el.each(el.ignore(ep),eq,el.ignore(eo));return function(es){var et=er.call(this,es);return[[et[0][0],ee[0][2]],et[1]]}},list:function(eo,ep,eq){ep=ep||el.rtoken(/^\s*/);eq=eq||null;return(eo instanceof Array?el.each(el.product(eo.slice(0,-1),el.ignore(ep)),eo.slice(-1),el.ignore(eq)):el.each(el.many(el.each(eo,el.ignore(ep))),ek,el.ignore(eq)))},set:function(eo,ep,eq){ep=ep||el.rtoken(/^\s*/);eq=eq||null;return function(eF){var er=null,et=null,es=null,eu=null,ev=[[],eF],eE=false;for(var ez=0;ez<eo.length;ez++){es=null;et=null;er=null;eE=(eo.length==1);try{er=eo[ez].call(this,eF)}catch(eC){continue}eu=[[er[0]],er[1]];if(er[1].length>0&&!eE){try{es=ep.call(this,er[1])}catch(eD){eE=true}}else{eE=true}if(!eE&&es[1].length===0){eE=true}if(!eE){var eA=[];for(var ew=0;ew<eo.length;ew++){if(ez!=ew){eA.push(eo[ew])}}et=el.set(eA,ep).call(this,es[1]);if(et[0].length>0){eu[0]=eu[0].concat(et[0]);eu[1]=et[1]}}if(eu[1].length<ev[1].length){ev=eu}if(ev[1].length===0){break}}if(ev[0].length===0){return ev}if(eq){try{es=eq.call(this,ev[1])}catch(eB){throw new en.Exception(ev[1])}ev[1]=es[1]}return ev}},forward:function(eo,ep){return function(eq){return eo[ep].call(this,eq)}},replace:function(ep,eo){return function(eq){var er=ep.call(this,eq);return[eo,er[1]]}},process:function(ep,eo){return function(eq){var er=ep.call(this,eq);return[eo.call(this,er[0]),er[1]]}},min:function(eo,ep){return function(eq){var er=ep.call(this,eq);if(er[0].length<eo){throw new en.Exception(eq)}return er}}};var eh=function(eo){return function(){var ep=null,es=[];if(arguments.length>1){ep=Array.prototype.slice.call(arguments)}else{if(arguments[0] instanceof Array){ep=arguments[0]}}if(ep){for(var er=0,eq=ep.shift();er<eq.length;er++){ep.unshift(eq[er]);es.push(eo.apply(null,ep));ep.shift();return es}}else{return eo.apply(null,arguments)}}};var em="optional not ignore cache".split(/\s/);for(var eg=0;eg<em.length;eg++){el[em[eg]]=eh(el[em[eg]])}var ei=function(eo){return function(){if(arguments[0] instanceof Array){return eo.apply(null,arguments[0])}else{return eo.apply(null,arguments)}}};var ej="each any all".split(/\s/);for(var ef=0;ef<ej.length;ef++){el[ej[ef]]=ei(el[ej[ef]])}}());(function(){var ei=Date,eo=ei.prototype,ej=ei.CultureInfo;var ek=function(eq){var er=[];for(var ep=0;ep<eq.length;ep++){if(eq[ep] instanceof Array){er=er.concat(ek(eq[ep]))}else{if(eq[ep]){er.push(eq[ep])}}}return er};ei.Grammar={};ei.Translator={hour:function(ep){return function(){this.hour=Number(ep)}},minute:function(ep){return function(){this.minute=Number(ep)}},second:function(ep){return function(){this.second=Number(ep)}},meridian:function(ep){return function(){this.meridian=ep.slice(0,1).toLowerCase()}},timezone:function(ep){return function(){var eq=ep.replace(/[^\d\+\-]/g,"");if(eq.length){this.timezoneOffset=Number(eq)}else{this.timezone=ep.toLowerCase()}}},day:function(ep){var eq=ep[0];return function(){this.day=Number(eq.match(/\d+/)[0])}},month:function(ep){return function(){this.month=(ep.length==3)?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(ep)/4:Number(ep)-1}},year:function(ep){return function(){var eq=Number(ep);this.year=((ep.length>2)?eq:(eq+(((eq+2000)<ej.twoDigitYearMax)?2000:1900)))}},rday:function(ep){return function(){switch(ep){case"yesterday":this.days=-1;break;case"tomorrow":this.days=1;break;case"today":this.days=0;break;case"now":this.days=0;this.now=true;break}}},finishExact:function(ep){ep=(ep instanceof Array)?ep:[ep];for(var er=0;er<ep.length;er++){if(ep[er]){ep[er].call(this)}}var eq=new Date();if((this.hour||this.minute)&&(!this.month&&!this.year&&!this.day)){this.day=eq.getDate()}if(!this.year){this.year=eq.getFullYear()}if(!this.month&&this.month!==0){this.month=eq.getMonth()}if(!this.day){this.day=1}if(!this.hour){this.hour=0}if(!this.minute){this.minute=0}if(!this.second){this.second=0}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.day>ei.getDaysInMonth(this.year,this.month)){throw new RangeError(this.day+" is not a valid value for days.")}var es=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);if(this.timezone){es.set({timezone:this.timezone})}else{if(this.timezoneOffset){es.set({timezoneOffset:this.timezoneOffset})}}return es},finish:function(ep){ep=(ep instanceof Array)?ek(ep):[ep];if(ep.length===0){return null}for(var eu=0;eu<ep.length;eu++){if(typeof ep[eu]=="function"){ep[eu].call(this)}}var er,eq=ei.today();if(this.now&&!this.unit&&!this.operator){return new Date()}else{if(this.now){eq=new Date()}}var ev=!!(this.days&&this.days!==null||this.orient||this.operator);var ew,et,es;es=((this.orient=="past"||this.operator=="subtract")?-1:1);if(!this.now&&"hour minute second".indexOf(this.unit)!=-1){eq.setTimeToNow()}if(this.month||this.month===0){if("year day hour minute second".indexOf(this.unit)!=-1){this.value=this.month+1;this.month=null;ev=true}}if(!ev&&this.weekday&&!this.day&&!this.days){er=Date[this.weekday]();this.day=er.getDate();if(!this.month){this.month=er.getMonth()}this.year=er.getFullYear()}if(ev&&this.weekday&&this.unit!="month"){this.unit="day";ew=(ei.getDayNumberFromName(this.weekday)-eq.getDay());et=7;this.days=ew?((ew+(es*et))%et):(es*et)}if(this.month&&this.unit=="day"&&this.operator){this.value=(this.month+1);this.month=null}if(this.value!=null&&this.month!=null&&this.year!=null){this.day=this.value*1}if(this.month&&!this.day&&this.value){eq.set({day:this.value*1});if(!ev){this.day=this.value*1}}if(!this.month&&this.value&&this.unit=="month"&&!this.now){this.month=this.value;ev=true}if(ev&&(this.month||this.month===0)&&this.unit!="year"){this.unit="month";ew=(this.month-eq.getMonth());et=12;this.months=ew?((ew+(es*et))%et):(es*et);this.month=null}if(!this.unit){this.unit="day"}if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null){this[this.unit+"s"]=this[this.unit+"s"]+((this.operator=="add")?1:-1)+(this.value||0)*es}else{if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value){this.value=1}this[this.unit+"s"]=this.value*es}}if(this.meridian&&this.hour){if(this.meridian=="p"&&this.hour<12){this.hour=this.hour+12}else{if(this.meridian=="a"&&this.hour==12){this.hour=0}}}if(this.weekday&&!this.day&&!this.days){er=Date[this.weekday]();this.day=er.getDate();if(er.getMonth()!==eq.getMonth()){this.month=er.getMonth()}}if((this.month||this.month===0)&&!this.day){this.day=1}if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month){return Date.today().setWeek(this.value)}if(ev&&this.timezone&&this.day&&this.days){this.day=this.days}return(ev)?eq.add(this):eq.set(this)}};var el=ei.Parsing.Operators,eh=ei.Grammar,en=ei.Translator,ef;eh.datePartDelimiter=el.rtoken(/^([\s\-\.\,\/\x27]+)/);eh.timePartDelimiter=el.stoken(":");eh.whiteSpace=el.rtoken(/^\s*/);eh.generalDelimiter=el.rtoken(/^(([\s\,]|at|@|on)+)/);var ee={};eh.ctoken=function(et){var es=ee[et];if(!es){var eu=ej.regexPatterns;var er=et.split(/\s+/),eq=[];for(var ep=0;ep<er.length;ep++){eq.push(el.replace(el.rtoken(eu[er[ep]]),er[ep]))}es=ee[et]=el.any.apply(null,eq)}return es};eh.ctoken2=function(ep){return el.rtoken(ej.regexPatterns[ep])};eh.h=el.cache(el.process(el.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),en.hour));eh.hh=el.cache(el.process(el.rtoken(/^(0[0-9]|1[0-2])/),en.hour));eh.H=el.cache(el.process(el.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),en.hour));eh.HH=el.cache(el.process(el.rtoken(/^([0-1][0-9]|2[0-3])/),en.hour));eh.m=el.cache(el.process(el.rtoken(/^([0-5][0-9]|[0-9])/),en.minute));eh.mm=el.cache(el.process(el.rtoken(/^[0-5][0-9]/),en.minute));eh.s=el.cache(el.process(el.rtoken(/^([0-5][0-9]|[0-9])/),en.second));eh.ss=el.cache(el.process(el.rtoken(/^[0-5][0-9]/),en.second));eh.hms=el.cache(el.sequence([eh.H,eh.m,eh.s],eh.timePartDelimiter));eh.t=el.cache(el.process(eh.ctoken2("shortMeridian"),en.meridian));eh.tt=el.cache(el.process(eh.ctoken2("longMeridian"),en.meridian));eh.z=el.cache(el.process(el.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),en.timezone));eh.zz=el.cache(el.process(el.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),en.timezone));eh.zzz=el.cache(el.process(eh.ctoken2("timezone"),en.timezone));eh.timeSuffix=el.each(el.ignore(eh.whiteSpace),el.set([eh.tt,eh.zzz]));eh.time=el.each(el.optional(el.ignore(el.stoken("T"))),eh.hms,eh.timeSuffix);eh.d=el.cache(el.process(el.each(el.rtoken(/^([0-2]\d|3[0-1]|\d)/),el.optional(eh.ctoken2("ordinalSuffix"))),en.day));eh.dd=el.cache(el.process(el.each(el.rtoken(/^([0-2]\d|3[0-1])/),el.optional(eh.ctoken2("ordinalSuffix"))),en.day));eh.ddd=eh.dddd=el.cache(el.process(eh.ctoken("sun mon tue wed thu fri sat"),function(ep){return function(){this.weekday=ep}}));eh.M=el.cache(el.process(el.rtoken(/^(1[0-2]|0\d|\d)/),en.month));eh.MM=el.cache(el.process(el.rtoken(/^(1[0-2]|0\d)/),en.month));eh.MMM=eh.MMMM=el.cache(el.process(eh.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),en.month));eh.y=el.cache(el.process(el.rtoken(/^(\d\d?)/),en.year));eh.yy=el.cache(el.process(el.rtoken(/^(\d\d)/),en.year));eh.yyy=el.cache(el.process(el.rtoken(/^(\d\d?\d?\d?)/),en.year));eh.yyyy=el.cache(el.process(el.rtoken(/^(\d\d\d\d)/),en.year));ef=function(){return el.each(el.any.apply(null,arguments),el.not(eh.ctoken2("timeContext")))};eh.day=ef(eh.d,eh.dd);eh.month=ef(eh.M,eh.MMM);eh.year=ef(eh.yyyy,eh.yy);eh.orientation=el.process(eh.ctoken("past future"),function(ep){return function(){this.orient=ep}});eh.operator=el.process(eh.ctoken("add subtract"),function(ep){return function(){this.operator=ep}});eh.rday=el.process(eh.ctoken("yesterday tomorrow today now"),en.rday);eh.unit=el.process(eh.ctoken("second minute hour day week month year"),function(ep){return function(){this.unit=ep}});eh.value=el.process(el.rtoken(/^\d\d?(st|nd|rd|th)?/),function(ep){return function(){this.value=ep.replace(/\D/g,"")}});eh.expression=el.set([eh.rday,eh.operator,eh.value,eh.unit,eh.orientation,eh.ddd,eh.MMM]);ef=function(){return el.set(arguments,eh.datePartDelimiter)};eh.mdy=ef(eh.ddd,eh.month,eh.day,eh.year);eh.ymd=ef(eh.ddd,eh.year,eh.month,eh.day);eh.dmy=ef(eh.ddd,eh.day,eh.month,eh.year);eh.date=function(ep){return((eh[ej.dateElementOrder]||eh.mdy).call(this,ep))};eh.format=el.process(el.many(el.any(el.process(el.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(ep){if(eh[ep]){return eh[ep]}else{throw ei.Parsing.Exception(ep)}}),el.process(el.rtoken(/^[^dMyhHmstz]+/),function(ep){return el.ignore(el.stoken(ep))}))),function(ep){return el.process(el.each.apply(null,ep),en.finishExact)});var em={};var eg=function(ep){em[ep]=(em[ep]||eh.format(ep)[0]);return em[ep]};eh.formats=function(eq){if(eq instanceof Array){var er=[];for(var ep=0;ep<eq.length;ep++){er.push(eg(eq[ep]))}return el.any.apply(null,er)}else{return eg(eq)}};eh._formats=eh.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy","ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);eh._start=el.process(el.set([eh.date,eh.time,eh.expression],eh.generalDelimiter,eh.whiteSpace),en.finish);eh.start=function(ep){try{var eq=eh._formats.call({},ep);if(eq[1].length===0){return eq}}catch(er){}return eh._start.call({},ep)};ei._parse=ei.parse;ei.parse=function(ep){var eq=null;if(!ep){return null}if(ep instanceof Date){return ep}try{eq=ei.Grammar.start.call({},ep.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(er){return null}return((eq[1].length===0)?eq[0]:null)};ei.getParseFunction=function(eq){var ep=ei.Grammar.formats(eq);return function(er){var es=null;try{es=ep.call({},er)}catch(et){return null}return((es[1].length===0)?es[0]:null)}};ei.parseExact=function(ep,eq){return ei.getParseFunction(eq)(ep)}}());function z(ee,ef){if(typeof(localStorage)==="undefined"){bt(["dev","localStorage error","not available"])}else{try{if(typeof(ee)!=="undefined"&&ee!=null){localStorage.setItem(ee,ef)}}catch(eg){if(eg.name==="QUOTA_EXCEEDED_ERR"){bt(["dev","localStorage error","over quota"])}else{bt(["dev","localStorage error","unexpected error -- "+eg.name,eg.message])}}}}function bO(ee){if(typeof(localStorage)==="undefined"){return null}else{try{return localStorage.getItem(ee)}catch(ef){return null}}}function b6(ei){var ee=bO("b4gMenuEntries");var ek={};if(ee==null){ek[ei]=1}else{ek=JSON.parse(ee);var eh=ek[ei];if(eh==null){b3(ek);ek[ei]=1}else{var ej=[];for(var eg in ek){if(ek.hasOwnProperty(eg)){ej.push([eg,ek[eg]])}}ej.sort(function(em,el){return el[1]-em[1]});var ef=1;if(ej.length>2){ef=ej[2][1]/2}ek[ei]=eh+ef}}z("b4gMenuEntries",JSON.stringify(ek))}function b3(ei){var eh=[];for(var eg in ei){if(ei.hasOwnProperty(eg)){eh.push([eg,ei[eg]])}}eh.sort(function(ek,ej){return ej[1]-ek[1]});if(eh.length>25){for(var ef=10;ef<eh.length;ef++){delete (ei[eh[ef][0]])}}if(eh[0][1]>1000){for(var ee in ei){if(ei.hasOwnProperty(ee)){ei[ee]=Math.ceil(ei[ee]/25)}}}return ei}function a6(){var ee=bO("b4g-menu-customizations");var ef=[];if(ee!=null){ef=JSON.parse(ee)["customEntries"]}return ef}function ae(){cD();var eg="<div id='custom-b4g-container'><div><h3 style='margin:0px;'>Add Your Own</h3><div id='custom_time_input'></div><div class='customize_menu_samples' style='color:#999;padding:2px 0;'>Examples: Tomorrow 8am, Monday 7am, +15 days, +3 weeks, +6 months, Dec 31</div><ul id='b4g_user_menu_option_list' style='padding:0 7px;'></ul></div><div id='customize_b4g_default_menu_options'><h3 style='margin-bottom:4px;'>Show in Menu?</h3><table id='b4g-menu-default-times'><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 1 hour</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 2 hours</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 4 hours</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>Tomorrow morning</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>Tomorrow afternoon</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 2 days</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 4 days</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 1 week</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 2 weeks</span></td></tr><tr><td><input type='checkbox' checked /></td><td><span class='b4g-time-option'>In 1 month</span></td></tr></table></div></div>";var er={Ok:{"class":"b4g-button blue",text:"Update Menu",click:function(){bR();dP(this).dialog("destroy")},},Cancel:{"class":"b4g-button dialog-gray",text:"Cancel",click:function(){dP(this).dialog("destroy")}}};if(ce==="Old Safari"){alert(message);return}else{var ei=a8();dP(".dialogdiv").remove();var en="&nbsp &nbsp &nbsp Customize Boomerang Menu";var el="<div class='dialogdiv' style='display:none;'>"+eg+"</div>";dP("body",ei).append(dP(el));dP(".dialogdiv",ei).dialog(dP.extend({title:en,modal:true,height:"auto",closeOnEscape:true,buttons:er}));aj()}var ep={};var ek=JSON.parse(bO("b4g-menu-customizations"));if(ek!=null){ep=ek.defaultEntries}dP("#customize_b4g_default_menu_options .b4g-time-option").parent().parent().each(function(){if(dP(this).text() in ep&&!ep[dP(this).text()]){dP(this).find("input:first").removeAttr("checked")}});var eo=dP("<form onsubmit='return false;'><input style='width:198px;line-height: 16px;' type='text' name='time'/><input type='button' class='by-button by-button-secondary' style='margin: 3px 0 5px 3px;padding:3px 13px;' value='Add'/><div style='color:#969696; margin-left:3px;'><span id='date-preview' style='color:green'></span></div></form>");dP("#custom_time_input").replaceWith(eo);var em=eo.find("input[type=text]");em.focus().select();em.keyup(function(){aN(dP(this).val())});em.focus(function(){aN(dP(this).val())});var eh=[];if(ek!=null){eh=ek.customEntries}for(var ej=0;ej<eh.length;ej++){cH(eh[ej],dP("#b4g_user_menu_option_list"))}eo.find("input[type=button]").click(function(){Y=a7(em.val());if(Y==null){alert("Boomerang doesn't understand your date format. Please try again.")}else{if(Y<new Date()){alert("This date is in the past. Please try again.")}else{if(dP("#b4g_user_menu_option_list li").length<5){cH(em.val(),dP("#b4g_user_menu_option_list"));em.val("");dP("#date-preview").html("")}else{alert("You can only have five custom times stored right now. Please remove an existing item to add a new one.")}}}});var eq=dP(".dialogdiv").parent().height();var ef=dP(window).height();if(eq>ef){var ee=dP("#custom-b4g-container").height();dP("#custom-b4g-container").height(ee-(eq-ef));dP("#custom-b4g-container").css({"overflow-y":"scroll"})}dP(".dialogdiv").dialog({position:"center"});bt(["Show dialog","Customize Boomerang Menu"])}function cH(eh,ef){var eg=dP("<span style='margin-left:20px;'><img style='cursor:pointer;' src='"+cq+"delete.png'></img></span>");eg.click(function(){dP(this).closest("li").remove()});eg.hover(function(){dP(this).css("opacity","1")},function(){dP(this).css("opacity",".8")});var ee=dP("<span class='b4g-custom-time-entry'>"+eh.charAt(0).toUpperCase()+eh.slice(1)+"</span>");ef.append(ee);ee.wrap("<li style='list-style:none;padding:2px 0;' />");ee.after(eg)}function bR(){var eg={};dP("#customize_b4g_default_menu_options .b4g-time-option").each(function(){var eh=dP(this).text();var ei=dP(this).closest("tr").find("input:first").attr("checked");eg[eh]=ei});var ef=[];dP("#b4g_user_menu_option_list .b4g-custom-time-entry").each(function(){ef.push(dP(this).text())});var ee={};ee.customEntries=ef;ee.defaultEntries=eg;z("b4g-menu-customizations",JSON.stringify(ee))}function r(ef){var ee=new Date();return(a7(ef)-(ee.getTime()-(5*60*1000))>0)}function br(){return dP("button",bp).filter(function(){return dP(this).attr("aria-label")===dP("#gbqfb",bp).attr("aria-label")}).length>0}function cr(){return(o.indexOf("ui=2")>0||o.indexOf("view=cm")>0)&&cL().length===0}function cL(){var ee=a8();return dP("[role='banner']:visible",ee)}function R(ef,ee){if(!ee){ee=a8()}return dP("[role='button']",ee).filter(function(){return dP(this).text().trim()===ef})}function cx(ee){if(!ee){ee=a8()}var ef=dP(".T-I.J-J5-Ji.Bq.nS.T-I-ax7.L3",ee).first().text();if(!ef){ef=dP(".T-I.J-J5-Ji.Bq.nS.T-I-KE.L3",ee).first().text()}if(!ef){ef=dP(".T-I.J-J5-Ji.Bq.nS.T-I-ax7.L3",ee).first().text()}if(!ef){ef=dP(".T-I.J-J5-Ji.aoO.L3.T-I-ax7",ee).first().text()}if(!ef){ef=dP(".T-I.J-J5-Ji.aoO.T-I-atl.L3",ee).first().text()}if(!ef){ef="Send"}return ef}function bK(ef){var ee=dP(".T-I.J-J5-Ji.Uo.T-I-atl.L3",ef).first().text();if(!ee){ee=dP(".T-I.J-J5-Ji.Bq.undefined.T-I-ax7.L3",ef).first().text()}if(!ee){ee="Send & Archive"}else{ee=ee.replace("&amp;","&")}return ee}function a3(eg){if(!eg){eg=a8()}var eh=cx(eg);var ee=bK(eg);var ef=R(eh,eg).add(R(ee,eg));return ef}function cf(){return dP(bu,bp).filter(":visible").text()}function ay(){return dP(de,bp).map(function(){return dP(this).attr("email")}).toArray()}function bX(){return dP(bA,bp).map(function(){var ee=dP(this).attr("alt").replace(" at","");if(Date.parse(ee)==null){return null}else{return Date.parse(ee).valueOf()}}).toArray()}var u=".ii";var G=".iH > div [role=button]";var dc=".iH > div";var cu=".dK";var bu=".hP";var de=".gD";var bA=".g3";var cV=".nH .if > .nH > .nH > .dJ";var c2=".ee";var dU='<div class="b4g_menu G-asx T-I-J3 J-J5-Ji">&nbsp;</div>';function f(){return document.location.href.indexOf("#inbox")>0||dP(".TK > .ain .afM").length>0}var J=[];var c4=false;function C(ee,ej){c4=false;var ei=ej.notes;var eh=ej.conditional;var eg,ef=dP('.oZ-jc.T-Jo.J-J5-Ji[aria-checked="true"]',bp).filter(":visible");if(ef.length===0&&bw()){if(cB()){ef=dP('.apo-jc.T-Jo.J-J5-Ji.T-Jo-Jp[aria-checked="true"]',bp).filter(":visible");if(ef.length===0){eg=dP(".PE").filter(":visible").parent();ef=dP("[role='checkbox']",eg)}}else{eg=dP(".PE").filter(":visible").parent();ef=dP("[role='checkbox']",eg)}}J=ef.map(function(){var er,et,es,en;if(cB()){er=dP(this).parent().parent();et=dP("[email]",er).map(function(){return dP(this).attr("email")}).toArray();es=dP(".y6 > span",er.next()).first().text();en=dP(".apm > span",er).attr("title")}else{er=dP(this).parent().parent();et=dP("[email]",er).map(function(){return dP(this).attr("email")}).toArray();es=dP(".y6 > span",er).first().text();en=dP(".xW.xY > span",er).attr("title")}var ep,eo=ao();if(Date.parse(en.replace(" at",""))){ep=Date.parse(en.replace(" at","")).valueOf()}else{ep=null}var ek="https://b4g.baydin.com/mailcruncher/schedulereturnbulk";ek=ek+"?subject="+encodeURIComponent(es);ek=ek+"&guser="+encodeURIComponent(eo);ek=ek+"&sentDates="+encodeURIComponent(JSON.stringify([ep]));ek=ek+"&offset="+encodeURIComponent(ee.valueOf());ek=ek+"&notes="+encodeURIComponent(ei);var em=dP("html",document).attr("lang");if(!em||em==="en-GB"){ek=ek+"&language=English"}else{ek=ek+"&language=notEnglish-"+em}if(eh){ek=ek+"&conditional="+encodeURIComponent("True")}else{ek=ek+"&conditional="+encodeURIComponent("False")}if(f()){ek=ek+"&inbox=True"}else{ek=ek+"&inbox=False"}if(o.indexOf("#sent")>0){var el="";for(var eq=0;eq<et.length;eq++){if(eq>0){el+=", "}el+=et[eq]}ek=ek+"&to="+encodeURIComponent(el);ek=ek+"&senders="+encodeURIComponent(JSON.stringify(["None"]))}else{ek=ek+"&senders="+encodeURIComponent(JSON.stringify(et))}var eu={status:"waiting",subject:es,time:en,address:et,url:ek,retried:false};return eu});J=J.filter(function(){return(this["address"]!=null)})}function bJ(ef){var ee="<div class='bulkdialog'>";ee+="<div class='bulkldialogHeader'>Processing "+J.length.toString()+" messages.</div>";ee+="<div class='bulkdialogReturnDate'>Messages will return "+ef+" </div>";ee+="<table id='bulkTable'>";ee+="</table>";ee+="</div>";dP(".bulkdialog").remove();dP("body").append(dP(ee));dP(".bulkdialog").dialog({modal:true,width:"750px",resizable:false,dialogClass:"bulk",buttons:[{"class":"b4g-button dialog-gray b4g-bulk-close",text:"Cancel",click:function(){c4=true;aX();dP(this).dialog("destroy")}}],});dP(".b4g-ui-dialog-titlebar").hide();dK();cw()}function dK(){var ee="";for(var ef=0;ef<J.length;ef++){if(J[ef]["status"]==="error"){ee+="<tr id='bulkRow-"+ef.toString()+"' class='error'>"}else{ee+="<tr id='bulkRow-"+ef.toString()+"'>"}ee+="<td class='bulkStatus "+J[ef]["status"]+"'>"+J[ef]["status"]+"</td>";ee+="<td class='bulkAddress'>"+J[ef]["address"]+"</td>";ee+="<td class='bulkSubject'>"+J[ef]["subject"]+"</td>";if(J[ef]["status"]==="error"&&!J[ef]["retried"]){ee+="<td id='bulkRetry-"+ef.toString()+"' class='bulkRetry b4g-button'>Retry</td>"}else{ee+="<td id='bulkRetry-"+ef.toString()+"' class='bulkRetry'></td>"}ee+="</tr>"}dP("#bulkTable").html(ee);dP(".bulkRetry").click(cv);if(du()){dP(".b4g-bulk-close").text("Close");if(ec()){setTimeout(function(){dP(".bulkdialog").remove();aX()},5000)}L({type:"return-later",bulk:J.length});cS.expire_cache()}}function cv(){var ef=dP(this);var ee=ef.attr("id").split("-")[1];J[ee]["retried"]=true;a4(J[ee]["url"],aG,ee);J[ee]["status"]="processing";dK()}function aG(eg,ef,ee){if(eg===dV){J[ee]["status"]="success"}else{J[ee]["status"]="error";if(eg===dG){bE("Boomerang was not able to locate this email from this folder view. Please open the email and Boomerang it individually.")}else{bE(bj[eg])}}dK()}function aX(){var ee=a8();var ef=dP("[role='button']",ee);var eg=ef.filter(function(){return dP(this).attr("act")==="20"});eg.each(be)}function cw(){if(c4){return}for(var ee=0;ee<J.length;ee++){if(J[ee]["status"]==="waiting"){J[ee]["status"]="processing";at(ee);break}}dK()}function du(){var ee=true;for(var ef=0;ef<J.length;ef++){if(J[ef]["status"]!=="success"&&J[ef]["status"]!=="error"){ee=false}}return ee}function ec(){var ef=true;for(var ee=0;ee<J.length;ee++){if(J[ee]["status"]!=="success"){ef=false}}return ef}function at(ee){a4(J[ee]["url"],bd,ee)}function bd(eh,ef,ee){if(eh===dV){J[ee]["status"]="success";cw()}else{if(eh===dG||eh===aq){J[ee]["status"]="error";cw()}else{for(var eg=0;eg<J.length;eg++){if(J[eg]["status"]!=="success"){J[eg]["status"]="error";J[eg]["retried"]=true}}bE(bj[eh])}}dK()}function dk(){dP(".Cq.aqL>div>div",bp).each(function(){var ef=dP(".bulkboomerang",this);var eh=dP("[act='10']",this).filter(":visible").length>0;if(ef.length===0){var ee=dP("<div aria-haspopup='true' style='-webkit-user-select: none; -moz-user-select:none;margin-bottom:0px;outline: none;' role='button' class='J-J5-Ji W6eDmd L3 J-Zh-I J-J5-Ji Bq L3' tabindex='0'><img class='f tk3N6e-I-J3' src='"+cq+"tinyboomlogo.png' style='vertical-align: middle;'/> Boomerang <div class='VP5otc-d2fWKd tk3N6e-I-J3 J-J5-Ji'> </div></div>");var eg=dP("[role='button']",bp).filter(function(){return dP(this).attr("act")==="20"}).attr("class");ee.attr("class","f "+eg+" bulkboomerang b4g_button");ee.css("display","inline-block");ee.hide();ee.click(function(ei){aW(ei,this,cP);bt(["bulk boomerang","click"])});dP(this).append(ee)}if(eh&&(dP("html",document).attr("lang")===""||dP("html",document).attr("lang")==="en-GB"||dP("html",document).attr("lang")===null)){ef.css("display","inline-block")}else{ef.hide()}})}function cP(ef){var eh=dP("#note_entry",bp).val();if(eh==null){eh=""}var ee=dC(ef,6);var ei=ar(ee,false);var eg=dP("#conditionalBoomerang",bp).attr("checked");dP(".b4g_menu",bp).remove();C(ee,{conditional:eg,notes:eh});if(J.length===0){bE("Please check at least one email to Boomerang.")}else{if(J.length>15){bE("You can Boomerang at most 15 messages at a time. Please Boomerang the messages individually.")}else{Q(function(){a5(ei)})}}}function a5(ef){var ee="https://b4g.baydin.com/mailcruncher/checkbulkstatus?guser="+ao();ee+="&num="+J.length;a4(ee,cR,ef)}function cR(ef,ee,eg){if(ef===dV){bJ(eg)}else{bE("You don't have enough credits left to Boomerang this many messages. Please Boomerang the messages individually.")}}function eb(){bS("b4g_inner_menu","b4g_menu")}function bS(ek,ei){try{var ef=a8();var ej=dP("#"+ek,ef);var eh=dP("#"+ei,ef);var ee=ej.height();eh.css("min-height",ej.height()+"px")}catch(eg){}}function cs(){var ef=a8();dP("#notes_menu",ef).toggle();var ee=dP("#b4g_inner_menu",ef);ee.children().not("#notes_menu").toggle();dP(".random",ee).hide();eb()}function bw(){return bc()||cB()}function bc(){var ee=a8();return dP(".aph",ee).filter(":visible").length>0}function cB(){var ee=a8();return dP(".apj",ee).filter(":visible").length>0}function aL(){var ej=dP(".gU.Up > .J-J5-Ji");if(ej.find(".by-button").length>0){return}var ee=a.b4goldgid;var ef=a.b4gnewtid;var ei=dP('<button class="by-button by-button-secondary" style="height: 30px; margin: 6px 0;"><span class="by-button-text">Save message</span></button>');var eh=dP('<button class="by-button" style="height: 30px; margin: 6px 0 6px 5px;"><span class="by-button-text">Cancel</span></button>');var eg=false;var el=function(en,ep){var eo=en.responseText||en.error;if(dP.type(eo)!=="string"){eo="Sorry, there was an error. We can't edit your message at the moment. Try again later."}alert(eo);ei.find(".by-button-text").text("Save message");eh.find(".by-button-text").text("Cancel")};ei.click(function(){var eo="https://b4g.baydin.com/inline-manage/update-";eo+=(dP(".b4g-inline-send").length>0?"send-later":"recurring");ei.find(".by-button-text").text("Saving...");var en=ca(ei);dB(en,function(ep){dP.ajax({type:"post",url:eo,data:{oldGmailId:ee,newThreadId:ef},xhr:w,success:function(eq){if(!eq.success){el(eq);return}window.close()},error:el,dataType:"json"});eg=true})});eh.click(function(){eh.find(".by-button-text").text("Cancelling...");dP.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/delete-draft",data:{gmailId:a.b4gdraftgid},xhr:w,success:function(en){if(!en.success){el(en);return}window.close()},error:el,dataType:"json"});eg=true});ej.append(ei).append(eh).children(".T-I-atl").remove();var ek=dP(".gU.er");var em=ek.position();if(em){dP(".eq").css("left",em.left+ek.outerWidth()-4)}window.onbeforeunload=window.onunload=function(){if(!eg){eh.click()}window.opener.postMessage("b4g-edit-window-close","https://mail.google.com")}}function cQ(){aL();dP(".T-I-JN.L3 .gx").each(be).click();if(dP(".h7.Jux0I").length>0){dP(".h7:not(.Jux0I)").hide()}dP(".nH.oy8Mbf.qp",bp).hide();dP(".Bu.y3",bp).hide();dP(".nH.Gn",bp).hide();dP(".cf.gz",bp).hide();dP(".Cp",bp).hide();dP("[role='button']",bp).not(".conditional-caption, .wG.J-Z-I").filter(function(){return dP(this).closest(".aDh, [role='toolbar']").length<=0}).hide();dP(".oh, .az5 .Uz").hide();dP(".boomerang-button",bp).hide();dP(".d2",bp).hide();dP(".hP",bp).hide();dP(".nH > .ha").hide();dP(".aeH").hide();dP(".ar5.J-J5-Ji").hide();dP(".mq, .ae4").hide();dP(".PS").hide();dP(".adz").hide();dP(".w-asV.aiw").hide();dP(".AT").hide();dP("body").addClass("b4g-state-edit-message").attr("style","overflow: auto!important");dP(".nH.oy8Mbf.nn.aeN",bp).css({visibility:"hidden",width:100});dP(".gB.acO").css({"padding-top":0,border:"none"});dP(".adn").css("padding-bottom",0);dP(".G3.G2").css("border","none");dP(".aeJ").css({height:"auto","padding-right":0,overflow:"hidden"});dP(".aeJ")[0].scrollTop=0;var ee=dP(".aoY").width()-(dP(".b4g-inline-manage:visible").outerWidth()-dP(".I5").outerWidth());dP(".aoY").css({visibility:"hidden"}).width(ee);dP("#b4g_clicktoclose",bp).click(function(){dN=false;window.close();setTimeout(function(){window.location="mail.google.com"},250)})}function c3(){return a.b4guser||""}var d9='<div class="sendLaterTable boomerangReply" style="background-color: whiteSmoke; border: 1px solid #CFCFCF; border-width: 0 1px 1px 1px; margin: 0 -1px; overflow-y: hidden;"><table style="width:100%"><tr><td style="width: 80px"><div class="send-later-button tk3N6e-I J-J5-Ji W6eDmd tk3N6e-I-n2to0e L3 J-Zh-I J-J5-Ji Bq L3" aria-haspopup="true" style="-moz-user-select: none; background-color: #D14836; background-image: -webkit-linear-gradient(top,#DD4B39,#D14836); background-image: -moz-linear-gradient(top,#DD4B39,#D14836); background-image: -ms-linear-gradient(top,#DD4B39,#D14836); background-image: linear-gradient(top,#DD4B39,#D14836); color: white; border: 1px solid transparent; padding: 0 9px; -webkit-border-radius: 2px; -moz-border-radius: 2px; border-radius: 2px;cursor: pointer;font-size: 11px; font-weight: bold; white-space: nowrap; margin: 3px; height: 27px;line-height: 27px;min-width: 54px; outline: 0;" tabindex="0">Send Later</div></td> <td style="border-top: none; width: 7px"><div class="Uz"></div></td><td><div class="boomerangSendWidget" style="font-size:11px; float:left;"><label><input type="checkbox" class="boomerangSendCheck" value="boomSend" style="vertical-align:text-bottom;"/><span style="padding-right:4px;"> Boomerang this</span></label><div class="T-I J-J5-Ji Bq lX T-I-ax7 L3 b4g_button sendboomerang-button" style="padding: 1px 2px; height: 20px; font-weight: normal; margin: 0;"><div class="conditional-caption" aria-haspopup="true" style="line-height: 20px;" role="button" tabindex="0"> in 2 days<div class="VP5otc-d2fWKd tk3N6e-I-J3 J-J5-Ji"><div class="b4g_menu G-asx T-I-J3 J-J5-Ji">&nbsp;</div></div></div></div><div class="T-I J-J5-Ji Bq lX T-I-ax7 L3 b4g_button b4g-send-condition" style="height: 20px; top: 3px; margin: 0 0 6px 4px; padding: 1px 0px;"><select name="ifResponse" class="boomerangSendCondition" style="border:0; padding: 2px 1px; background-color: transparent; color: #444; -webkit-appearance: button; vertical-align: middle; margin-bottom: 6px;"><option value="no reply">if no reply</option><option value="no click">if not clicked</option><option value="no open">if not opened</option><option value="always">regardless</option></select></div></div></td><td class="b4g-tracking-toggle-holder"></td></tr></table></div>';function ca(ef,eh){var eg,ee=dP(ef);eg=ee.closest(".nH.Hd[role='dialog']");if(eg.length>0){return eg}eg=ee.closest(".aoI");if(eg.length>0){return eg}eg=ee.closest(".ip.adB");if(eg.length>0){return eg}eg=ee.find(".aoI");if(eg.length>0){return eg}if(eh!==undefined){return eh}bt(["dev","get_compose_container failed"]);return document}function cb(ee){var ef=dP(".Am.Al:not(:has(iframe)), .LW-avf, .Am.Al > iframe",ee);if(!ef[0]){return null}if(ef[0].contentDocument){ef=dP(ef[0].contentDocument.body)}return ef}function D(eg){var eh=cb(eg);var ef=dP(".n1tfz .gU > .oG",eg).parent();function ee(){var ej=ef.text().trim().toLowerCase();if(ej!=="plain text"&&ej!=="rich text"){return}var ei=(ej==="plain text");var ek=(!ei&&ei!==eh.data("is-plain-text"));eh.data("is-plain-text",ei);var el=dP(".b4g-tracking-toggle",eg);if(ek){el.trigger("b4g-toggle-state",!!eh.data("had-tracking-enabled"))}if(ei&&el.data("is-selected")){bE("Click tracking and read receipts do not work with plain text emails.");eh.data("had-tracking-enabled",el.data("is-selected"));el.trigger("b4g-toggle-state",false)}}new dd(ee).observe(ef[0],{childList:true,characterData:true,subtree:true});ee([])}function db(){return Math.random().toString(36).substr(5)+Date.now().toString(36)}function cO(ee){dP("a[href^='http://mailstat.us/tr/opt-out?guid'],img[src^='http://mailstat.us/tr/'],.b4g-open-track",ee).remove()}function E(ef,ee){dP("a[href^='http://mailstat.us/tr/opt-out']",ef).not(":has(img[src^='http://mailstat.us/tr/'])").remove().end().not("[href='http://mailstat.us/tr/opt-out?guid="+ee+"']").remove();dP("img[src^='http://mailstat.us/tr/']",ef).filter(function(){return this.parentNode.tagName.toLowerCase()!=="a"}).remove()}function bV(ee){if(!ee.tagName){return[]}if(ee.tagName.toLowerCase()==="img"){return[ee]}return dP(ee).find("a, img").andSelf().filter("a, img").toArray()}function aD(eg){var ei=dP(".b4g-tracking-toggle",eg).data("is-selected");var eh=cb(eg);if(!ei){cO(eh);return}if(!eh.data("has-tracking-opt-out-observer")){new dd(function(ek){for(var em=0;em<ek.length;em++){var eq=ek[em];var ep=dP.map(eq.addedNodes||[],bV);var eo=dP.map(eq.removedNodes||[],bV);var ej=[].concat(ep,eo);for(var en=0;en<ej.length;en++){var el=ej[en];var er=el.tagName.toLowerCase();if(er==="a"&&el.href.indexOf("http://mailstat.us/tr/opt-out?guid=")===0){aD(eg);return}if(er==="img"&&el.src.indexOf("http://mailstat.us/tr/")===0){aD(eg);return}}}}).observe(eh[0],{childList:true,subtree:true});eh.data("has-tracking-opt-out-observer",true)}var ef=eh.data("thread-guid")||db();eh.data("thread-guid",ef);var ee=dP("a[href='http://mailstat.us/tr/opt-out?guid="+ef+"']:has(img[src^='http://mailstat.us/tr/'])",eh);if(ee.length>0){E(eh,ef);ee.slice(1).remove().end().addClass("b4g-open-track");return}cO(eh);ee=dP('<a href="http://mailstat.us/tr/opt-out?guid='+ef+'"><img src="http://mailstat.us/tr/optout-blk-nologo.png?guid='+ef+'" /></a>').addClass("b4g-open-track");eh.append(ee);if(!ee.prev().is("br")){ee.before("<br/>")}}var bF=/\b((?:(?:https?:\/\/)|(?:www\d{0,3}[.])|(?:[a-z0-9.\-]+[.][a-z]{2,4})\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/;function dT(ee){var ef=cb(ee);ef.find("*:not(a)").andSelf().replaceText(bF,function(ei,eh){var eg=eh;if(eg.indexOf("http://")!==0&&eg.indexOf("https://")!==0){eg="http://"+eg}return'<a href="'+eg+'" target="_blank">'+eh+"</a>"})}var b=/^http:\/\/mailstat\.us\/tr\/t\/[a-z0-9]+\/[a-z0-9]+\/(.*)$/;function cl(ef){var ee=b.exec(ef);if(ee){return ee[1]}return ef}function cZ(ee){dP("a[href^='http://mailstat.us/tr/t/']",ee).each(function(){var eg=dP(this);if(eg.is(".b4g-track-dummy")){eg.remove();return}var ef=cl(this.href);eg.attr("href",ef).removeClass("b4g-track-link")})}var l=(function(){var ee=1;return function(){return(ee++).toString(36)}})();function dq(ee,ef){ef=cl(ef);return"http://mailstat.us/tr/t/"+ee+"/"+l()+"/"+ef}function dW(ee){if(!ee.tagName){return[]}if(ee.tagName.toLowerCase()==="a"){return[ee]}return dP(ee).find("a").toArray()}function F(eh){var ek=dP(".b4g-tracking-toggle",eh).data("is-selected");var ei=cb(eh);if(!ek){cZ(ei);return}if(!ei.data("has-click-tracking-observer")){new dd(function(en){for(var ep=0;ep<en.length;ep++){var et=en[ep];var es=dP.map(et.addedNodes||[],dW);var er=dP.map(et.removedNodes||[],dW);var em=[].concat(es,er);if(et.type==="attributes"){em.push(et.target)}for(var eq=0;eq<em.length;eq++){var eo=em[eq];var el=dP(eo).removeClass("b4g-track-link").attr("href");if(el.charAt(0)==="/"){continue}if(dP.inArray(eo,es)>-1){eo.href=cl(el)}F(eh);return}}}).observe(ei[0],{childList:true,attributes:true,subtree:true,attributeFilter:["href"]});ei.data("has-click-tracking-observer",true)}var ej=dP("a:not(.b4g-track-wont)",ei);ej=ej.each(function(){var el=this.href;if(el.indexOf("mailto:")===0){dP(this).addClass("b4g-track-wont")}if(el.indexOf("http://mailstat.us/tr/opt-out?guid=")===0){dP(this).addClass("b4g-track-wont")}}).not(".b4g-track-wont");if(ej.length<=0){var ef=dP('<a href="http://mailstat.us/tr/t/dummy"></a>').addClass("b4g-track-link b4g-track-dummy").css({border:"0","text-decoration":"none",width:"1px"}).hide();ei.append(ef);return}ej.filter("[href^='http://mailstat.us/tr/t/dummy']:not(.b4g-track-dummy)").addClass("b4g-track-dummy");ej=ej.not(".b4g-track-dummy");if(ej.length>0){dP(".b4g-track-dummy",ei).remove()}ej=ej.not(".b4g-track-link, .b4g-track-wont");if(ej.length<=0){return}var ee=ei.data("thread-guid")||db();ei.data("thread-guid",ee);var eg=ej.not("[href^='http://mailstat.us/tr/t/"+ee+"']");if(eg.length<=0){ej.addClass("b4g-track-link");return}eg.each(function(){var el=dq(ee,this.href);dP(this).attr("href",el).addClass("b4g-track-link")})}function cY(ef){var eh=cb(ef);var ee=dP(".n1tfz .gU.oc:not(.b4c-link)",ef).first().clone().addClass("b4g-tracking-toggle").removeClass("gU").attr("id",null).css({"text-align":"center",width:44}).hover(function(){dP(".J-Z-I",this).addClass("J-Z-I-JW")},function(){dP(".J-Z-I",this).removeClass("J-Z-I-JW")}).bind("b4g-toggle-state",function(ek,ej){var ei=dP("[role='button']",this);if(ej==null){ej=(ei.attr("aria-selected")!=="true")}ei.toggleClass("J-Z-I-KO",ej).attr("aria-selected",ej+"");dP(this).data("is-selected",ej);if(ej){cS.enable()}}).click(function(){var ei=dP(this);Q(function(){ei.trigger("b4g-toggle-state");d6(function(ej){if(ej||!ei.data("is-selected")){return}d2(ef)})})}).find("[data-tooltip]").attr("data-tooltip","Request read receipt and track clicks").end().find("[role='button']").attr("id",null).css("width","30px").end().find(".dv").attr("style","background-image: url("+cq+"tracking-toggle.png) !important;background-size: 19px !important;background-position: center -1px !important;").end();dP(".sendLaterTable .b4g-tracking-toggle-holder",ef).replaceWith(ee);var eg=(dP("a[href^='http://mailstat.us/tr/t/']",eh).length>0);eg=eg||(dP("a[href^='http://mailstat.us/tr/opt-out?guid=']:has(img[src^='http://mailstat.us/tr/'])",eh).length>0);ee.trigger("b4g-toggle-state",eg).bind("b4g-toggle-state",function(){if(eh.data("is-plain-text")){if(dP(this).data("is-selected")){bE("Read receipts and click tracking do not work with plain text emails.");dP(this).trigger("b4g-toggle-state",false)}return false}aD(ef);F(ef)});dP(".aoO, .send-later-button",ef).bind("mousedown focus",function(){var ei=dP(this).closest(".I5,.fN");aD(ei);if(ee.data("is-selected")){dT(ei)}F(ei)});aD(ef);F(ef);D(ef);af(function(ei){if(ei){return}K(ef)})}function d4(){var ef=dP(".nH.Hd[role='dialog']");ef.each(function(){var eg=dP(this);if(!cb(eg)){return}ee(eg)});function ee(em){var eq=dP(".sendLaterTable",em);if(eq.length===0){var ei=dP(".aDj",em);if(ei.length===0){return}ei.append(d9);dP(".send-later-button",em).click(function(es){cc(es,this,false)});dP(".sendboomerang-button",em).click(function(es){aB(es,this,false)});try{cY(em)}catch(el){}var eh=a3(em);var ej=function(){var es=dP(".boomerangSendCheck",em).is(":checked");var eu=au(em);if(es){var et=bM(em);a4(et,function(ev){if(dY(ev)||ev===bb){s(ev)}else{if(ev!==dV){bE("Your most recent Boomerang-on-Send failed. To Boomerang your sent email, please open your message in 'Sent Mail' and Boomerang the message manually. <br/><br/> Error Details:<br/> "+bj[ev])}else{if(ev===dV){L({type:"return-later"});cS.expire_cache()}}}},"success")}else{if(eu){c5(em)}}};eh.click(ej).keydown(function(es){if(es.which===32||es.which===13){ej()}});dP(".boomerangSendCheck",em).click(function(){a0(em)});dP(".boomerangSendCheck",em).change(function(){bt(["boomerang this",(dP(this).is(":checked")?"checked":"un-checked")])});dP(".boomerangSendCondition",em).change(function(){dP(".boomerangSendCheck",em).attr("checked",true);a0(em);var et=dP(this).val();bt(["Send and Boomerang","Change 'if i don't hear back' field",et]);if(et==="no click"||et==="no open"){if(!au(em)){var es=dP(".b4g-tracking-toggle",em);es.trigger("b4g-toggle-state")}}});var er=42;var eg=dP(".GW",em);if(eg.length>0){var eo=parseInt(eg.css("bottom"),10);var ep=dP(".aoD.hl")[0];var ek=function(){if(dP(ep).is(":visible")){eg.css("bottom",eo.toString()+"px")}else{eg.css("bottom",(eo+er-8).toString()+"px")}};var en=new dd(function(es){es.forEach(ek)});en.observe(ep,{attributes:true})}if(em.find(".HQ").length===0){dP(".Am.Al",em).focus();setTimeout(function(){dP(".aoD.hl",em).focus()},100)}cy(em);an.add_compose_listen(em)}}}function c7(ee){ee.find(".aB.gQ.pB").click()}function dZ(eg,ef){var ei=ai("bcc",eg);if(dP.trim(ef).length>0&&ei.indexOf(ef)<0){var eh=eg.find("[name=bcc]").first();var ee=eh.val();if(dP.trim(ee).length>0){eh.val(ee+", "+ef)}else{eh.val(ef)}}}function cy(eg){var ej=aJ();if(ej==="premium"){var eh=JSON.parse(bO("b4g_preferences-"+ao()));var ef=(eh.onSendSetting?"checked":"");var ek=(eh.onSendOffset==null)?"1_weeks":eh.onSendOffset;var el=(eh.onSendCond==null)?"reply":eh.onSendCond;var ei=(eh.readReceipts?"on":"off");if(ef==="checked"||ei==="on"){Q(function(){if((ef==="checked"&&(el==="no click"||el==="no open"))||ei==="on"){if(!au(eg)){var en=dP(".b4g-tracking-toggle",eg);en.trigger("b4g-toggle-state")}}var eo=ek.split("_");var ep=" in "+eo[0]+" "+eo[1];var em=e(eo[0],eo[1]);if(ef==="checked"){dP(".boomerangSendCheck",eg).get(0).checked=(ef==="checked")?1:0;dP("[name=ifResponse]",eg).val(el);dP(".conditional-caption",eg).data("returnDate",em);dP(".conditional-caption",eg).text(ep)}})}if(eh.crm.active&&(eh.crm.bccIncludeWith==="every"||(eh.crm.bccIncludeWith==="boomerang"&&ef==="checked"))){var ee=eh.crm.bccAddress;dZ(eg,ee)}bt(["Compose Window","boomerang on-send setting applied successfully"])}}function cc(ev,ee,eh){var eA=a8();var em=function(eB){cI(eB,ee)};var ew=function(){ab(ee)};var er=function(){bE("A Pro subscription is required to use this feature. To schedule recurring messages, please upgrade your subscription.","Boomerang for Gmail",{Upgrade:{text:"Upgrade to schedule","class":"b4g-button green",click:function(){window.open("https://b4g.baydin.com/subscriptions","_blank")}},"Never mind":{text:"Never mind","class":"b4g-button dialog-gray",click:function(){dP(this).dialog("destroy")}}},{width:350,dialogClass:"b4g-upgradenag-dialog"});bt(["compose dialog schedule recurring message","blocked non-subscriber"])};var ez=cE(ev);if(ez.className.indexOf("J-Zh-I")===-1&&ez.className.indexOf("f")!==0&&ez.className.indexOf("VP5otc-d2fWKd")===-1){return}var eu=eA.getElementById("b4g_menu");if(eu){cD(ev,ee)}else{bt(["send later compose menu","click"]);dP("div",ee).addClass("J-Zh-I-JO");dP("div",ee).addClass("J-Zh-I-Kq");var ei=(!eh)?dP(ev.currentTarget).position().top:(dP(ev.currentTarget).position().top+73);var ey=(!eh)?dP(ev.currentTarget).position().left:(dP(ev.currentTarget).position().left+40);var eq='<ul id="b4g_menu" tabindex="0" class="b4g_menu" style="position: absolute; padding: 0px; top:'+ei+"px; left:"+ey+'px;  background-color: rgb(255, 255, 255); -webkit-user-select: none; min-width: 17em;height: auto;min-height: 398px;" role="menu" aria-haspopup="true" aria-activedescendant=""><div id="b4g_inner_menu" class="b4g_menu SK AX" style="-webkit-user-select: none; font-size:12px;padding:0;"><li id="b4g_menu_title" class="menu-caption" style="list-style-type:none;padding: 6px 11px 0 11px;">Send Message:<img id="b4g-menu-customization-button" class="Ha"  data-tooltip="Customize Menu" data-tooltip-delay="400" src="'+cq+'gear.png" height="16px" style="opacity:.9;background:none;height:16px;width:16px;position:absolute;right:13px;top:6px;cursor:pointer;"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 6px 11px;background:#ddd;"></li><li class="b4g-standard-times"></li><li class="b4g-custom-times"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 0px 11px;background:#ddd;"></li><li class="menu-caption" style="padding:7px 11px 4px 11px;">At a specific time:</li><li class="b4g-menu-option" style="padding: 0 0 7px 11px;"><div style="color: #666; font-style: italic; font-size: 10px; margin-top: 3px;" class="b4g_menu">Examples: "Monday 9am", "Dec 23"</div><form onsubmit="return false;"><div style="padding-top:3px; vertical-align: middle;" class="b4g_menu"><input style="margin-left:1px;padding:3px 22px 2px 2px;" class="b4g_menu" type="text" name="time" id="datepicker"><input id="specific-time-submit" type="submit" value="Confirm" style="margin: 0px 7px 5px 9px;font-size:11px;vertical-align:top;" class="b4g_menu by-button by-button-secondary"></div><div style="color:#969696; margin-left: 1px;"><span id="date-preview" class="b4g_menu" style="color:green;"></span></div></form></li><li class="b4g-menu-divider" style="height:1px;margin:0px 11px;background:#ddd;"></li><li class="b4g-menu-option"><a id="recurring" style="margin:4px 0px;border-width:0px;color:black;cursor:pointer;display:block;padding: 6px 12px;" class="menu-anchor" href="javascript:void(0)"><img id="recurring-image"  class="menu-anchor" src="'+cq+'recurring.png" height="16px" style="vertical-align:middle;"/><span style="vertical-align:middle;margin-left:6px;">Schedule recurring message</span></a></li></div></ul>';dP(ee).parent().append(eq);var ej=dP("#b4g_menu",eA);an.enable_menu_arrow_keys(ej);if(eh){var ep='<li class="b4g_menu b4g-menu-option" style="padding:6px;"><input type="checkbox" id="conditionalSendLater" class="b4g_menu" name="condBoomerang"/> Only if nobody replies</li>';dP("#b4g_menu_title",eA).after(ep)}h(dP(".b4g-standard-times",eA));X(eA);dP(".b4g_menu_item",eA).click(function(){function eB(eC){em(eC);bt(["boomerang menu","send later time",eC])}eB(dP(this).text())});if(dz==null||dz<new Date()){Y=Date.today().addDays(2).addHours(8)}else{Y=dz}var en=Y.toString("M/d/yyyy h:mm tt");var eo=dP("#datepicker",eA);eo.val(en);eo.keyup(function(){var eB=dP(this).val();aN(eB)});eo.focus(function(){var eB=dP(this).val();aN(eB)});dP("input#specific-time-submit",eA).click(function(eB){cz(eB,em)});var eg=a6();if(eg.length>0){dP(".b4g-custom-times",eA).before("<div class='b4g-menu-divider' style='height:1px;margin:6px 11px;background:#ddd;'></div>");for(var es=0;es<eg.length;es++){var ek=cX(eg[es],null);dP(".b4g-custom-times",eA).append(ek)}dP(".b4g-custom-menu-item",eA).click(function(){function eB(eC){bm(eC,em);bt(["b4g menu","picked",eC])}eB(dP(this).text())})}if(!eh||cr()){if(cr()){dP(ee).closest(".HE").after(ej)}else{dP(ee).parent().append(ej)}}var ef=dP("#b4g-menu-customization-button",eA);ef.click(function(){ae()});ef.hover(function(){dP(this).css("opacity","1")},function(){dP(this).css("opacity",".9")});var ex=dP("a#recurring",eA);ex.click(function(){bt(["compose dialog schedule recurring message","clicked"]);Z(ew,er)});ex.hover(function(){dP(this).addClass("J-N-JT")},function(){dP(this).removeClass("J-N-JT")});dP(eA).bind("click",{owner:ee},aw);cJ(eo);dP(".b4g-ui-datepicker-trigger",eA).css("cursor","pointer");dP(".b4g-ui-datepicker-trigger",eA).css("margin-left","-21px");dP(".b4g-ui-datepicker-trigger",eA).css("margin-top","-2px");dP(".b4g-ui-datepicker-trigger",eA).hover(function(){dP(this).css("box-shadow","0px 0px 3px #aaa")},function(){dP(this).css("box-shadow","none")});eo.mousedown(function(eB){eB.stopImmediatePropagation()});eo.css("-moz-user-select","text");eo.parents().each(function(){dP(this).css("-moz-user-select","text")});dP("#conditionalSendLater",eA).click(function(){if(dP("[name='subject']:visible",eA).length>0){m("<p>If you change the message subject, the new message becomes part of a separate conversation, so Boomerang's response tracking will not work properly.</p><p>To ensure that responses are detected accurately, please copy your message text, discard this email, and paste the text into a new reply.</p>","Did you change the subject?");dP(this).attr("checked",true)}});eo.select();dP("span#date-preview.b4g_menu",eA).text("");eb();var et;if(!eh){et=dP(ej).height()-47;dP(ej).css("top","-"+et+"px")}else{var el=dP(".aDd").length>0;if(cr()&&el){et=dP(ej).height()-198;dP(ej).css("top","-"+et+"px");dP(ej).css("left","39px")}else{dP("#b4g_menu").position({of:dP(ev.currentTarget),my:"left bottom",at:"left top"})}}}}function cI(ez,ee){var ev=ca(ee);var em=ao();var ej=bi("subjectbox",ev).val();if(ej.length>200){bE("You've exceeded the maximum subject length. Please shorten your subject and try again.");return}var eu=dP(".J-JN-M-I.J-J5-Ji.az2.az4.L3",ev);if(eu.length>0){eu=n(eu.text())}else{eu=em}var eh=ai("to",ev);var er=ai("cc",ev);var ex=ai("bcc",ev);if(!eh&&!er&&!ex){bE("Please enter a recipient.");return}var ek=eh+" "+er+" "+ex;var et=H;var ef=ek.toLowerCase().match(et);ef=dv(ef);if(ef.length>100){bE("Boomerang limits you to 100 recipients at a time. Please enter a shorter list.");return}var ei=dC(ez,9.5);var eq=ar(ei,false);var en=new Date();var ey="0/0";var ep="None";if(dP(".boomerangSendCheck",ev).is(":checked")){var es=df(ev);if(es<=ei){bE("Your Send Later message must be scheduled earlier than your Boomerang reminder.");return}else{ep=es.valueOf()}}var ew=dP(".boomerangSendCondition",ev).val();var el="";switch(ew){case"no reply":el="reply";break;case"no click":el="click";break;case"no open":el="open";break;case"always":el="none";break;default:el="none"}var eg="False";var eA=a8();if(dP("#conditionalSendLater",eA).attr("checked")){eg="True"}var eo=bi("draft",ev).val();cD();dP(ev).append('<div class="b4g-ui-widget-overlay b4g-overlay"></div>').append('<div class="b4g-overlay" style="position: absolute; top: 50%; left: 50%; margin: -38px 0 0 -120px; background: white; width: 220px; text-align: center; padding: 10px;"><img height="31" width="31" src="'+cq+'ajax-loader.gif"><br><span style="font-size: 14px;">Scheduling message...</span></div>');if(b8(ev)){bE("Please wait for your attachments to upload before sending.")}else{dB(ev,function(eD){if(eD){B();return}var eG=q(ev);if(eG==null||eG==="undefined"){eG=ax()}var eC="https://b4g.baydin.com/mailcruncher/schedulesend";eC+="?guser="+encodeURIComponent(em);eC+="&from="+encodeURIComponent(eu);eC+="&subject="+encodeURIComponent(ej);eC+="&rank="+encodeURIComponent(ey);eC+="&esttimesaved="+encodeURIComponent(en.valueOf());eC+="&offset="+encodeURIComponent(ei.valueOf());eC+="&to="+encodeURIComponent(eh);eC+="&cc="+encodeURIComponent(er);eC+="&bcc="+encodeURIComponent(ex);eC+="&boomerangoffset="+encodeURIComponent(ep);eC+="&boomerangconditional="+encodeURIComponent(el);eC+="&sendlaterconditional="+encodeURIComponent(eg);eC=eC+"&threadId="+encodeURIComponent(eG);var eF=dP("html",document).attr("lang");if(!eF||eF==="en-GB"){eC=eC+"&language=English"}else{eC=eC+"&language=notEnglish-"+eF}var eE=au(ev);if(eE){var eB=aK(ev);eC+="&trackingCode="+encodeURIComponent(eB)}ac(eC,eq,ev,{condition:eg})})}}function B(){bE("It looks like Gmail hasn't saved this draft yet. Please allow Gmail to autosave (such as by adding an extra space after the email content and waiting until 'Saved' appears), and then click Send Later again.")}function dB(ef,ei){window.getSelection().removeAllRanges();dP(cb(ef)).append("<span/>").each(be);dP("[role='toolbar'] > [command='+bold']",ef).each(be);setTimeout(function(){dP("[role='toolbar'] > [command='+bold']",ef).each(be);eh()},300);dP(".oG",ef).text("");dP(".aOy",ef).removeClass("aOy");var eg=0,ee=40;var eh=function eh(){eg++;if(eg>ee){ei(true);return}var ej=dP(".oG",ef);if(ej.hasClass("aOy")||(eg>ee-2&&dP.trim(ej.text()).length>0)){setTimeout(function(){ei(null)},2000)}else{setTimeout(function(){eh(ef,ei)},250)}}}function ac(ee,eg,ei,ef){ef=ef||{};var eh=String(document.location);var em="Message will be sent "+eg+". ";var ej=au(ei);var ek;if(ej){ek=aK(ei)}Q(function(){el()});function el(){setTimeout(function(){di(ei)},ch);function en(ep,eq,eo){if(ep===dV){if(ek){aV(ek)}L({type:"send-later",isIfNoReply:ef.condition==="True"});cS.expire_cache();if(cr()){aC(em,dJ,"send_new_compose")}}else{if(dY(ep)){s(ep)}else{if(ep===bb){s(ep);window.location=eh}else{if(ep!==dV){bE("Attempt failed: "+bj[ep]);window.location=eh}}}}}a4(ee,en,em);if(!cr()){aC(em,dJ,"send_new_compose")}}}function ab(ee){var ej=a8();var eh=ca(ee);cD();if(ce==="Old Safari"){alert("This feature is available in Safari versions 5.1 and higher. Please update Safari to use this feature.")}else{var el=ai("to");var ek=ai("cc");var eg=ai("bcc");if(!el&&!ek&&!eg){bE("Please enter a recipient.");return}dP(".dialogdiv").remove();var ei="<div class='dialogdiv' style='display:none;'><div id='recurring_dialog'><div id='start_date_time' class='recurring_field'><span class='recurring-row-title'>Starts</span><span id='start_date' class='recurring_right_col'><input id='start_date_input' type='text' name='starts' size='15'/><span id='start_time'>Send Time: <input id='start_time_input' name='time' size='10'/></span></span></div><div  class='recurring_field'><span class='recurring-row-title'>Repeats</span><select id='frequency'  class='recurring_right_col'><option value='day'> Daily</option><option value='week' selected='selected'>Weekly</option><option value='weekday' >Every Weekday</option><option value='month' >Monthly</option><option value='year'>Yearly</option></select></div><div id='num_time_interval'  class='recurring_field'><span class='recurring-row-title'>Every</span><span class='recurring_right_col'><input type='number' value='1' min='1' max='12' name='num_interval' id='num_interval'/><span id='interval'> week</span></span></div><div id='days_of_week'  class='recurring_field'><span class='recurring-row-title'>On</span><span class='recurring_right_col' style='vertical-align: top;'><input class='day_cb' type='checkbox' value='6' name='Sun' style='margin-left:0px'/> Sun<input class='day_cb' type='checkbox' value='0' name='Mon'/> Mon<input class='day_cb' type='checkbox' value='1' name='Tue'/> Tue<input class='day_cb' type='checkbox' value='2' name='Wed'/> Wed<input class='day_cb' type='checkbox' value='3' name='Thur'/> Thur<input class='day_cb' type='checkbox' value='4' name='Fri'/> Fri<input class='day_cb' type='checkbox' value='5' name='Sat'/> Sat</span></div><div  class='recurring_field'><span class='recurring-row-title'> Ends </span><div class='recurring_right_col' style='display:inline-block;vertical-align: middle; line-height: 24px;'><div style='margin-bottom:3px;'><input type='radio' id='radio_num_occurences' name='end_group' checked/> After <input type='number' value='10' min='1' max='100' id='num_occurences' name='num_occurences'/> messages</div><div style='margin-bottom:3px;'><input type='radio' id='radio_end_date' name='end_group'/> On <input id='end_date' value='' name='end_date' size='15'/></div><div style='margin-bottom:3px;'><input type='radio' id='radio_no_end' name='end_group'/> No end date <br/></div></div></div><br/><br/><br/><br/><div id='summary' class='recurring_field'><span class='recurring-row-title'>Summary:</span><div id='recurring_feedback' class='recurring_right_col' style='display:inline-block;padding-right:20px;'> </div></div><div class='b4g-button-container' align='center'><button id='schedule_recurring' class='b4g-button red' style='margin:4px 10px;'> Schedule </button><button id='cancel_recurring' class='b4g-button dialog-gray' style='margin:4px 10px;'>Cancel</button></div><br/></div></div>";dP("body",ej).append(dP(ei));dP(".dialogdiv",ej).dialog({modal:true,title:"Schedule Recurring Message",closeOnEscape:true,width:530,dialogClass:"recurringDialog"});dP(".dialogdiv",ej).css({padding:"0px"});dP("#start_date_input",ej).datepicker({showOn:"button",buttonImage:cq+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,});dP("#end_date",ej).datepicker({showOn:"button",buttonImage:cq+"calendarpicker_17x15.png",buttonImageOnly:true,constrainInput:false,defaultDate:0,minDate:0,onClose:function(en,em){dP("#radio_end_date").attr("checked",true)},});a1();dP(".b4g-ui-datepicker-trigger",ej).css({cursor:"pointer",margin:"-2px 0px 0px -25px"}).hover(function(){dP(this).css("box-shadow","0px 0px 3px #aaa");dP(this).css("-moz-box-shadow","0px 0px 3px #aaa")},function(){dP(this).css("box-shadow","none");dP(this).css("-moz-box-shadow","none")});dP("#schedule_recurring",ej).click(function(){ba(eh);bt("compose dialog recurring dialog","click","schedule recurring")});dP("#cancel_recurring",ej).click(function(){dP(".dialogdiv").dialog("close")});var ef=new Date().addMinutes(10);dP("#start_date_input",ej).val(ef.toString("MM/dd/yy"));dP("#start_time_input",ej).val(ef.toString("hh:mm tt"));if(cr()){dP("#recurring_dialog",ej).css("font-size","1.3em")}bt("compose dialog recurring dialog","show")}}function ba(ee){dP(".dialogdiv").dialog("close");dP(ee).append('<div class="b4g-ui-widget-overlay b4g-overlay"></div>').append('<div class="b4g-overlay" style="position: absolute; top: 50%; left: 50%; margin: -38px 0 0 -120px; background: white; width: 220px; text-align: center; padding: 10px;"><img height="31" width="31" src="'+cq+'ajax-loader.gif"><br><span style="font-size: 14px;">Setting up recurring messages</span></div>');dB(ee,function(ef){if(ef){B();return}d7(ee,function(){dP(".b4g-overlay",ee).remove()})})}function d7(eC,ep){ep=ep||dP.noop;if(dw()){bE("Please wait for your attachments to upload before sending.");setTimeout(function(){ep({"active-attachments":true})});return}var ew=new Date();var et=ao();var eq=bi("subjectbox",eC).val();if(eq.length>200){bE("You've exceeded the maximum subject length. Please shorten your subject and try again.");setTimeout(function(){ep({"long-subject":true})});return}var eB=dP(".J-JN-M-I.J-J5-Ji.az2.az4.L3",eC);if(eB.length>0){eB=n(eB.text())}else{eB=et}var eh=ai("to",eC);var ez=ai("cc",eC);var eD=ai("bcc",eC);if(!eh&&!ez&&!eD){bE("Please enter a recipient.");setTimeout(function(){ep({"no-recipient":true})});return}var er=eh+" "+ez+" "+eD;var eA=H;var ef=er.toLowerCase().match(eA);ef=dv(ef);if(ef.length>100){bE("<p>Boomerang limits you to 100 recipients at a time. Please enter a shorter list.</p>");setTimeout(function(){ep({"too-many-recipients":true})});return}var em=dP("#start_date_input").val()+" "+dP("#start_time_input").val();var eo=Date.parse(em);if(eo==null||eo<new Date()){alert("Invalid start date");setTimeout(function(){ep({"invalid-start-date":true})});return}var ey=dX();var eE=dP("#num_interval").val();var eg=cg(eo);if(eg===""){alert("You must select a day of the week.");setTimeout(function(){ep({"no-day-selected":true})});return}var es="None";var el="None";if(dP("#radio_num_occurences").attr("checked")){es=dP("#num_occurences").val()}else{if(dP("#radio_end_date").attr("checked")){var ee=dP("#end_date").val();ee=Date.parse(ee);if(ee==null){alert("Invalid end date");setTimeout(function(){ep({"invalid-end-date":true})});return}el=ee.valueOf()}}var ex=q(eC);if(ex==null||ex==="undefined"){ex=ax()}var en="https://b4g.baydin.com/mailcruncher/schedulerecurring";en+="?guser="+encodeURIComponent(et);en+="&from="+encodeURIComponent(eB);en+="&subject="+encodeURIComponent(eq);en+="&to="+encodeURIComponent(eh);en+="&cc="+encodeURIComponent(ez);en+="&bcc="+encodeURIComponent(eD);en+="&esttimesaved="+encodeURIComponent(ew.valueOf());en+="&frequency="+encodeURIComponent(ey);en+="&interval="+encodeURIComponent(eE);en+="&utc_weekday="+encodeURIComponent(eg);en+="&start="+encodeURIComponent(eo.valueOf());en+="&end="+encodeURIComponent(el);en+="&num_occurences="+encodeURIComponent(es);en+="&threadId="+encodeURIComponent(ex);var eF=dP("html",document).attr("lang");if(!eF||eF==="en-GB"){en=en+"&language=English"}else{en=en+"&language=notEnglish-"+eF}var ek=au(eC);if(ek){var ev=aK(eC);en+="&trackingCode="+encodeURIComponent(ev)}var ej=dP("#recurring_feedback").text();var eu="Recurring message scheduled: "+ej;function ei(){function eG(eI,eJ,eH){if(eI===dV||dY(eI)){setTimeout(function(){if(ek){aV(ev)}ep(null);di(eC)},ch);if(dY(eI)){s(eI)}cS.expire_cache()}else{if(eI===bb){s(eI);ep({"pay-wall":true})}else{bE("Attempt failed: "+bj[eI]);ep({failure:bj[eI]})}}}a4(en,eG,eu);aC(eu,dJ,"send_new_compose")}Q(ei)}function h(ef){var ek=["In 1 hour","In 2 hours","In 4 hours","Tomorrow morning","Tomorrow afternoon","In 2 days","In 4 days","In 1 week","In 2 weeks","In 1 month"];var em=JSON.parse(bO("b4g-menu-customizations"));var eo=[];if(em!=null){var en=em.defaultEntries;var ei=Object.keys(en);for(var ej=0;ej<ei.length;ej++){eo[ei[ej].toLowerCase()]=en[ei[ej]]}}for(var eh=0;eh<ek.length;eh++){var el=ek[eh];var eg=el.toLowerCase();if(!(eg in eo)||eo[eg]){var ee=O(el,false);ef.append(ee)}}}function X(eg){var ee=dP(".b4g_menu_item:contains('hour'):last",eg);ee.parent().after('<div class="b4g-menu-divider" style="height:1px;margin:6px 11px;background:#ddd;"></div>');var ef=dP(".b4g_menu_item:contains('Tomorrow'):last",eg);ef.parent().after('<div class="b4g-menu-divider" style="height:1px;margin:6px 11px;background:#ddd;"></div>')}function aB(em,eh,el){var ef,en=cE(em);if(en.className.indexOf("J-Zh-I")===-1&&en.className.indexOf("f")!==0&&en.className.indexOf("VP5otc-d2fWKd")===-1&&en.className.indexOf("conditional-caption")===-1){return}var ek=a8();var eo=ca(eh);var eq=ek.getElementById("b4g_menu");if(eq){cD(em,eh)}else{bt(["Send and Boomerang","Open menu"]);dP("div",eh).addClass("J-Zh-I-JO");dP("div",eh).addClass("J-Zh-I-Kq");var ee=function(eu){aP(eu,eo)};var ei='<ul id="b4g_menu" tabindex="0" class="b4g_menu" style="padding:0px;background:#fff;position:absolute; bottom: '+(el?-21:22)+'px; left: 195px;" role="menu" aria-haspopup="true" aria-activedescendant=""><div id="b4g_inner_menu" class="b4g_menu SK AX" style="-webkit-user-select: none; font-size:12px;padding:0;"><li id="b4g_menu_title" class="menu-caption b4g-menu-option" style="list-style-type:none;padding:6px 11px 0 11px;">Boomerang this: <img id="b4g-menu-customization-button" data-tooltip="Customize Menu" data-tooltip-delay="400" src="'+cq+'gear.png" height="16px" style="opacity:.9;height:16px;width:16px;position:absolute;right:13px;top:6px;cursor:pointer;"></li><li class="b4g-menu-divider" style="height:1px;margin:0 11px 6px 11px;background:#ddd;"></li><li class="b4g-standard-times"></li><li class="b4g-custom-times"></li><li class="b4g-menu-divider" style="height:1px;margin:6px 11px 0px 11px;background:#ddd;"></li><li class="menu-caption" style="padding:7px 11px 4px 11px;">At a specific time:</li><li class="b4g-menu-option" style="padding: 0 0 7px 11px;"><div style="color: #666; font-style: italic; font-size: 10px; margin-top: 3px;" class="b4g_menu">Examples: "Monday 9am", "Dec 23"</div><form onsubmit="return false;"><div style="padding-top:3px; vertical-align: middle;" class="b4g_menu"><input style="margin-left:1px;padding:3px 22px 2px 2px;" class="b4g_menu" type="text" name="time" id="datepicker"><input id="specific-time-submit" type="submit" value="Confirm" style="margin: 0px 7px 5px 9px;font-size:11px;vertical-align:top;" class="b4g_menu by-button by-button-secondary"></div><div style="color:#969696; margin-left: 1px;"><span id="date-preview" class="b4g_menu" style="color:green;"></span></div></form></li></div></ul>';dP(eh).parent().append(ei);var er=dP("#b4g_menu",ek);an.enable_menu_arrow_keys(er);h(dP(".b4g-standard-times",ek));X(ek);dP(".b4g_menu_item",ek).click(function(){function eu(ev){ee(ev);bt(["boomerang menu","send later time",ev])}eu(dP(this).text())});if(dz==null||dz<new Date()){Y=Date.today().addDays(2).addHours(8)}else{Y=dz}var es=Y.toString("M/d/yyyy h:mm tt");var ej=dP("#datepicker",ek);ej.val(es);ej.keyup(function(){var eu=dP(this).val();aN(eu)});ej.focus(function(){var eu=dP(this).val();aN(eu)});dP("input#specific-time-submit",ek).click(function(eu){bt(["Send and Boomerang","At a specific time"]);var ev=Date.parse(Y);if(ev!=null){aO(ev,eo)}else{bE("Unable to read specified time. Please try again.")}});var ep=a6();if(ep.length>0){dP(".b4g-custom-times",ek).before("<div class='b4g-menu-divider' style='height:1px;margin:6px 11px;background:#ddd;'></div>");for(var et=0;et<ep.length;et++){ef=cX(ep[et],null);dP(".b4g-custom-times",ek).append(ef)}dP(".b4g-custom-menu-item",ek).click(function(){function eu(ev){ee(ev);bt(["b4g menu","picked",ev])}eu(dP(this).text())})}var eg=dP("#b4g-menu-customization-button",ek);eg.click(function(){ae()});eg.hover(function(){dP(this).css("opacity","1")},function(){dP(this).css("opacity",".9")});dP(ek).bind("click",{owner:eh},aw);cJ(ej);dP(".b4g-ui-datepicker-trigger",ek).css("cursor","pointer");dP(".b4g-ui-datepicker-trigger",ek).css("margin-left","-21px");dP(".b4g-ui-datepicker-trigger",ek).css("margin-top","-2px");dP(".b4g-ui-datepicker-trigger",ek).hover(function(){dP(this).css("box-shadow","0px 0px 3px #aaa")},function(){dP(this).css("box-shadow","none")});ej.mousedown(function(eu){eu.stopImmediatePropagation()});ej.css("-moz-user-select","text");ej.parents().each(function(){dP(this).css("-moz-user-select","text")});ej.focus();ej.select();dP("span#date-preview.b4g_menu",ek).text("");eb()}}function bM(en){var ei=ao();var eq=bi("subjectbox",en).val();var eu=[];var et=[];var er=dP(".J-JN-M-I.J-J5-Ji.az2.az4.L3",en);if(er.length>0){er=n(er.text())}else{er=ei}var es=ai("to",en);var ej=ai("cc",en);var el=ai("bcc",en);var ek=q(en);if(ek==null||ek==="undefined"){ek=ax()}var ee="https://b4g.baydin.com/mailcruncher/schedulereturndelay";ee=ee+"?subject="+encodeURIComponent(eq);ee=ee+"&senders="+encodeURIComponent(JSON.stringify(eu));ee=ee+"&guser="+encodeURIComponent(ei);ee=ee+"&sentDates="+encodeURIComponent(JSON.stringify(et));ee=ee+"&threadId="+encodeURIComponent(ek);var eh=dP("html",document).attr("lang");if(!eh||eh==="en-GB"){ee=ee+"&language=English"}else{ee=ee+"&language=notEnglish-"+eh}var eg=dP(".boomerangSendCondition",en).val();var ef=df(en);var em;switch(eg){case"no reply":em="reply";break;case"no click":em="click";break;case"no open":em="open";break;case"always":em="none";break;default:em="none"}ee=ee+"&offset="+encodeURIComponent(ef.valueOf());ee=ee+"&conditional="+encodeURIComponent(em);if(bi("^i").length>0){ee=ee+"&inbox=True"}else{ee=ee+"&inbox=False"}ee+="&to="+encodeURIComponent(es);ee+="&cc="+encodeURIComponent(ej);ee+="&bcc="+encodeURIComponent(el);var ep=au(en);if(ep){var eo=aK(en);ee+="&trackingCode="+encodeURIComponent(eo)}return ee}function au(ee){return dP(".b4g-tracking-toggle",ee).data("is-selected")}function aK(ee){return cb(ee).data("thread-guid")}function df(ee){var ef=dP(".conditional-caption",ee).data("returnDate");if(ef==null){ef=Date.today().addDays(2).addHours(7).addMinutes(Math.floor(Math.random()*30)-15)}return ef}function bz(ej){var ef=ao();var el=bi("subject").val();var em=ai("to",ej);var eg=ai("cc",ej);var ei=ai("bcc",ej);var eh=bi("draft",ej).val();var ek=aK(ej);var ee="https://b4g.baydin.com/mailcruncher/trackemail";ee=ee+"?subject="+encodeURIComponent(el);ee=ee+"&guser="+encodeURIComponent(ef);ee=ee+"&threadId="+encodeURIComponent(eh);ee=ee+"&trackingCode="+encodeURIComponent(ek);ee+="&to="+encodeURIComponent(em);ee+="&cc="+encodeURIComponent(eg);ee+="&bcc="+encodeURIComponent(ei);return ee}function c5(ef){var eg=bz(ef);var ee=aK(ef);a4(eg,function(ei,eh,ej){if(dY(ei)||ei===bb){s(ei)}else{if(ei!==dV){bE("Your most recent Boomerang-on-Send failed. To Boomerang your sent email, please open your message in 'Sent Mail' and Boomerang the message manually. <br/><br/> Error Details:<br/> "+bj[ei])}else{aV(ee);cS.expire_cache()}}},"success")}function w(){var ee=dP.ajaxSettings.xhr();ee.withCredentials=true;return ee}function aV(ee){dP.ajax({type:"post",url:"http://mailstat.us/tr/associate-client-to-email?guid="+ee,xhr:w,success:function(ef){if(ef&&ef.success){bt(["dev-CORS","success"])}else{bt(["dev-CORS","failure",(ef&&ef.error)+""])}},error:function(){bt(["dev-CORS","failure","XHR-failure"])},dataType:"json"})}function V(){var eg=dP(".nH.Hd[role='dialog']");var ej=eg.first();var ee=dP(".Ha",ej);var eh=dP(".oG",ej);var ei=eh.text();var ef=dP(".aDj",ej)}function di(ef){var ee=dP(".Ha",ef);ee.each(be)}function b8(ee){return dP(".dQ",ee).length>0}function bh(){i()}function i(){dP(".HE").each(function(){var ef=ca(this);if(!cb(ef)){return}ee(ef)});function ee(es){if(dP(".sendLaterTable",es).length===0){var en=es.find(".aDh");en.after(d9);es.append("<div>&nbsp</div><div>&nbsp</div><div>&nbsp</div>");var eu=42;var ek=dP(".aDd").length>0;if(cr()&&!ek){var eq=en.height();en.css("height",(eq+eu).toString()+"px");var el=dP(".aoD.hl")[0];var ew=en.css("margin-top");var ep=(parseInt(ew,10)-eq).toString()+"px";var ev=function(){if(dP(el).is(":visible")){en.css("margin-top",ep)}else{en.css("margin-top",ew)}};var er=new dd(function(ex){ex.forEach(ev)});er.observe(el,{attributes:true});ev();var em=dP(".GP")[0];var eh=function(){bn(function(){var eC=dP(".qz.aXjCH");var ey=eC.css("max-height");var eB=(parseInt(ey,10)-eq).toString()+"px";eC.css("max-height",eB);var ez=dP(".Am.Al");var ex=ez.css("min-height");var eA=(parseInt(ex,10)-eq).toString()+"px";ez.css("min-height",eA)},250)};var ei=new dd(function(ex){ex.forEach(eh)});ei.observe(em,{attributes:true});eh();var eo=dP(".sendLaterTable",es);eo.css("margin-top","-"+eu.toString()+"px");eo.css("border-top-width","1px");var ej=function(){var ey=dP(".GW",es);if(ey.length>0){var ex=parseInt(ey.css("bottom"),10);if(ex){ey.css("bottom",(ex+eu).toString()+"px")}else{ey.css("bottom",eu.toString()+"px")}}else{setTimeout(ej,2000)}};ej()}dP(".send-later-button",es).click(function(ex){cc(ex,this,true)});dP(".sendboomerang-button",es).click(function(ex){aB(ex,this,true)});dP(".boomerangSendCondition",es).change(function(){dP(".boomerangSendCheck",es).attr("checked",true);a0(es);var ey=dP(this).val();bt(["Send and Boomerang","Change 'if i don't hear back' field",ey]);if(ey==="no click"||ey==="no open"){if(!au(es)){var ex=dP(".b4g-tracking-toggle",es);ex.trigger("b4g-toggle-state")}}});try{cY(es)}catch(et){}var eg=a3(es);var ef=function(){var ex=dP(".boomerangSendCheck",es).is(":checked");var ez=au(es);if(ex){var ey=bM(es);a4(ey,function(eC,eA,eB){if(dY(eC)||eC===bb){s(eC)}else{if(eC!==dV){bE("Your most recent Boomerang-on-Send failed. To Boomerang your sent email, please open your message in 'Sent Mail' and Boomerang the message manually. <br/><br/> Error Details:<br/> "+bj[eC])}else{if(eC===dV){L({type:"return-later"});cS.expire_cache()}}}},"success")}else{if(ez){c5(es)}}};eg.click(ef).keydown(function(ex){if(ex.which===32||ex.which===13){ef()}});if(!ek&&cr()){dP(".Am.Al",es).focus();setTimeout(function(){dP(".aoD.hl",es).focus()},100)}dP(".boomerangSendCheck",es).click(function(){a0(es)});cy(es);an.add_compose_listener(es)}}}function cA(){var ep=bO("b4g_extensions");var eq="The Boomerang extension has been loaded successfully. ";if(ep){var eg=["gakklmehjhhdfjjgnmpkjoemjmeomnli","gkjnkapjmjfpipfcccnjbjcbgdnahpjp","hpoidnelefpoofhdioielagfklahfcjg","npjkmbechijncoapeeifgfhcjkcandgk","cbmmejeeogjpfmdlcdkolobdlohjkmjn"];var ej=["jpbnpbfpgjkblmejlgkfkekajajhjcid","dlppikdhbkdinhpfbneekdbjhgphknad","ijhapcklhkanndjbdnhichfmolhiaekg","mflnemhkomgploogccdmcloekbloobgb","nfddgbpdnaeliohhkbdbcmenpnkepkgn","pnnfemgpilpdaojpnkjdgfgbnnjojfik","gllmkcahdekdbapmdfnffclacbpnicaj","kemincbhdgppphceahdgebffjcfgbigp"];var ee=["mlomiejdfkolichcflejclcbmpeaniij","odjhifogjcknibkahlpidmdajjpkkcfn","dheionainndbbpoacpnopgmnihkcmnkl"];var ek=JSON.parse(ep);var el=[];for(var ei=0;ei<ek.length;ei++){var eo=ek[ei];var en=eo.id;var em=eo.name;if(eg.indexOf(en)>-1||ej.indexOf(en)>-1||ee.indexOf(en)>-1){el.push(eo)}}if(el.length>0){eq+="However, you should check the following extensions for possible conflicts:";eq+="<h4>Extension Conflicts:</h4><ul>";for(var eh=0;eh<el.length;eh++){eq+="<li>"+el[eh]["name"]+"</li>"}eq+="</ul>"}}eq+="<div id='b4g-inline-troubleshoot-holder'/>";var ef=bE(eq,"Boomerang For Gmail",{Close:{text:"Close","class":"b4g-button green",click:function(){window.location="https://mail.google.com"}},});setTimeout(function(){dm(ef)},0);localStorage.removeItem("b4g_extensions")}function dm(eg){var ef=dP("<div id='b4g-inline-troubleshoot'><h4>Inline manage:</h4><ul><li>Is enabled: <b class='b4g-inline-enabled'></b></li><li>Local data last updated: <br><b class='b4g-inline-lastupdated'></b></li><li>Number inline-manage threads: <b class='b4g-inline-threadscount'></b></li><li>Is server data accessible: <b class='b4g-inline-serverdata'></b></li></ul></div>");eg.css("height","auto").find("#b4g-inline-troubleshoot-holder").append(ef);var ee=function(eh,ej,ei){dP(eh,ef).text(ej).css("color",ei)};cS.troubleshoot({local:function(ej,el){var ei=cS.is_enabled();ee(".b4g-inline-enabled",(ei?"Yes":"No"),(ei?"green":"red"));var ek=new Date(el["last-updated"]);var eh=Object.keys(el["thread-ids"]).length;ee(".b4g-inline-lastupdated",ek+"","blue");ee(".b4g-inline-threadscount",eh,"blue")},server:function(eh){if(eh){ee(".b4g-inline-serverdata",eh,"red")}else{ee(".b4g-inline-serverdata","Yes","green")}}});ee(".b4g-inline-enabled","Loading...","blue");ee(".b4g-inline-lastupdated","Loading...","blue");ee(".b4g-inline-threadscount","Loading...","blue");ee(".b4g-inline-serverdata","Loading...","blue")}var k='<div class="b4g-tooltip-ftue"><div class="b4g-ftue-content"/><button class="T-I J-J5-Ji T-I-atl b4g-ftue-button"/><div class="b4g-ftue-pointer"/></div>';function c0(ee){ee=ee||{};var ef=dP(k);if(ee.content instanceof dI){dP(".b4g-ftue-content",ef).append(ee.content)}else{dP(".b4g-ftue-content",ef).text(ee.content)}ef.css({left:ee.left,top:ee.top,right:ee.right,bottom:ee.bottom,width:ee.width||"320px"}).find(".b4g-ftue-pointer").addClass("b4g-pointer-"+(ee.dir||"lr")).end().find(".b4g-ftue-button").text(ee.button||"").hover(function(){dP(this).addClass("T-I-JW")},function(){dP(this).removeClass("T-I-JW")}).click(function(eg){eg.preventDefault();if(ee.close){setTimeout(function(){ee.close()},0)}ef.remove()}).end().appendTo("body");return ef}function af(ef){if(dP("#b4g_manage").length<=0){return setTimeout(function(){ef({"user-in-pop-out":true})},0)}if(af.requestInFlight){return setTimeout(function(){ef({"request-in-flight":true})},0)}if(bO("b4g-has-seen-click-open-tracking-announcement")){return setTimeout(function(){ef({"annouce-has-been-seen":true})},0)}var ee=ao();a4("https://b4g.baydin.com/mailcruncher/hasseentrackingannouncement?guser="+encodeURIComponent(ee),function(eg,eh,ei){af.requestInFlight=false;if(eg===bP){ef(null)}else{z("b4g-has-seen-click-open-tracking-announcement",true);ef({"annouce-has-been-seen":true})}});af.requestInFlight=true}var d3='<div><h3>Introducing new features from Boomerang!</h3><p>You can request a read receipt and track clicks on links in your message. We will notify you when someone reads your email or clicks a link.</p><p>To get started, click the "Request read receipt and track clicks" button below.</p></div>';function K(ef){var ee=dP(".b4g-tracking-toggle",ef);var eg=ee.offset();ee.trigger("mouseenter");c0({bottom:dP("body").height()-eg.top+2,right:dP("body").width()-(eg.left+ee.outerWidth()/2)-24,content:dP(d3),close:function(){ee.trigger("mouseleave")},button:"Nifty!"});z("b4g-has-seen-click-open-tracking-announcement",true);bt(["click open tracking FTUE","annoucement"])}function d6(ef){if(dP("#b4g_manage").length<=0){return setTimeout(function(){ef({"user-in-pop-out":true})},0)}if(d6.requestInFlight){return setTimeout(function(){ef({"request-in-flight":true})},0)}if(bO("b4g-has-seen-click-open-tracking-tutorial")){return setTimeout(function(){ef({"tutorial-has-been-seen":true})},0)}var ee=ao();a4("https://b4g.baydin.com/mailcruncher/hasseentrackingtutorial?guser="+encodeURIComponent(ee),function(eg,eh,ei){d6.requestInFlight=false;if(eg===bP){ef(null)}else{z("b4g-has-seen-click-open-tracking-tutorial",true);ef({"tutorial-has-been-seen":true})}});d6.requestInFlight=true}var dj=["<div><h3>Awesome! Here is how it works.</h3><ol><li>You will get an email when the message is opened.</li><li>Your own opens and clicks are not counted.</li><li>Since some email clients are not compatible with the read receipt feature, there may be cases when opens/clicks are not reported.</li><li>The recipients can choose to not provide read receipts.</li></ol></div>",'<div><p>We have integrated read receipt and click tracking with our original Boomerang feature so you can get reminders for messages that don\'t get opened or clicked.</p><p>We added "if not opened" and "if not clicked" options in the drop down below.</p></div>',"<div><p>To see more details on your tracked messages after they are sent, click here and go to <strong>Manage scheduled messages</strong>.</p><p>Thanks and let us know how this feature works for you.</p></div>"];function d2(ef){var ee=dP(".b4g-tracking-toggle",ef);var eg=ee.offset();ee.trigger("mouseenter");ef.parents("body > .dw").andSelf().css("z-index",5);dP('<div class="b4g-ui-widget-overlay"/>').css("z-index",3).appendTo("body");c0({bottom:dP("body").height()-eg.top+2,right:dP("body").width()-(eg.left+ee.outerWidth()/2)-24,content:dP(dj[0]),close:function(){ee.trigger("mouseleave");d1(ef)},button:"Next"});bt(["click open tracking FTUE","step1"])}function d1(ef){var ee=dP(".b4g-send-condition",ef);var eg=ee.offset();c0({bottom:dP("body").height()-eg.top+2,right:dP("body").width()-(eg.left+ee.outerWidth()/2)-24,content:dP(dj[1]),close:function(){d0(ef)},button:"Next"});bt(["click open tracking FTUE","step2"])}function d0(ee){p(dP("#b4g_manage"));var ef=dP("#tmmanage").offset();ee.parents("body > .dw").andSelf().css("z-index",null);dP(".b4g-ui-widget-overlay").click(function(eg){eg.stopPropagation()});c0({top:ef.top-8,left:ef.left-420,width:380,dir:"ur",content:dP(dj[2]),close:function(){dP(".b4g-ui-widget-overlay").remove();z("b4g-has-seen-click-open-tracking-tutorial",true)},button:"Ok, got it."});bt(["click open tracking FTUE","step3"])}var bx={"detected-date-by-magic":{"dialog-message":"Looks like we guessed that one perfectly!<br/>Share the magic with others?","share-message":[{text:"Boomerang just helped me bring back a message at the right time. It's magical.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=magic&utm_campaign=viralhook"}]},"send-later-if-no-reply":{"dialog-message":"You just scheduled your auto-reminder email.<br/>Please share Boomerang with your friends so they can do the same.","share-message":[{text:"Thanks to Boomerang, I can schedule a reminder email that will be sent out only if they don't respond.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=auto_reminder&utm_campaign=viralhook"}]},"inbox-zero-within-hour":{"dialog-message":"Congratulations! You are at Inbox Zero.<br/>Care to share how Boomerang helped you achieve Inbox Zero?","share-message":[{text:"I just got to Inbox Zero with Boomerang's help! It helps me stay on top of all my emails.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=inbox_zero&utm_campaign=viralhook"}]},"send-later-at-1am-5am":{"dialog-message":"Looks like you love using Boomerang late at night.<br/>Share with others how you're using it.","share-message":[{text:"Just scheduled a bunch of emails with Boomerang! This way people don't know I am really a vampire.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=vampire&utm_campaign=viralhook"},{text:"Boomerang lets me schedule emails so I don't wake up people with my messages at all hours of the night.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=wake_people_up&utm_campaign=viralhook"},{text:"Boomerang lets me schedule emails so my messages are at the top of Inboxes even if I am writing them at insane hours.",url:"http://boomeranggmail.com/?utm_source=b4g&utm_medium={{medium}}&utm_content=insane_hours&utm_campaign=viralhook"}]}};var dF='<div class="b4g-viral-hook"><img class="b4g-viral-logo" src="'+cq+'viral-hook/boomerang.png"/><div class="b4g-viral-content"><p class="b4g-viral-dialog-message">{{dialog-message}}</p><ul class="b4g-viral-share-options"><li><a data-share-type="twitter" href="http://twitter.com/home?status={{text}}+{{url-twitter}}" target="_blank"><img src="'+cq+'viral-hook/tweet.png"/></a></li><li><a data-share-type="facebook" href="http://www.facebook.com/sharer/sharer.php?s=100&p[url]={{url-fb}}&p[images][0]=&p[title]=&p[summary]={{text}}" target="_blank"><img src="'+cq+'viral-hook/fbshare.png"/></a></li><li><a data-share-type="linkedin" href="http://www.linkedin.com/shareArticle?mini=true&url={{url-linkedin}}&title=&summary={{text}}&source=" target="_blank"><img src="'+cq+'viral-hook/linkedin.png"/></a></li><li><a data-share-type="googleplus" href="https://plus.google.com/share?url={{url-gplus}}" target="_blank"><img src="'+cq+'viral-hook/googleshare.png"/></a></li></ul></div><a class="b4g-viral-close" href="javascript:void(0);"></a></div>';function b9(ee,ef){return ee.replace(/\{\{(.*?)\}\}/g,function(eg,eh){var ei=eh.split(".");var ek,ej=ef;do{ek=ei.shift();ej=ej[ek]}while(ei.length>0&&ej!=null);return ej})}function bD(ek,ef){ef=ef||{};var ee=bx[ek];var eh=(ef.idx||0)%ee["share-message"].length;var eg=ee["share-message"][eh];var ej={"dialog-message":ee["dialog-message"],text:encodeURIComponent(eg.text),"url-twitter":encodeURIComponent(b9(eg.url,"twitter")),"url-fb":encodeURIComponent(b9(eg.url,"fb")),"url-linkedin":encodeURIComponent(b9(eg.url,"linkedin")),"url-gplus":encodeURIComponent(b9(eg.url,"gplus"))};var ei=dP(b9(dF,ej)).find(".b4g-viral-close").click(function(el){el.preventDefault();dP(".b4g-viral-hook").remove();bt("Viral hook closed",ek)}).end().appendTo("body").animate({top:0});dP(".b4g-viral-share-options a",ei).click(function(){bt("Viral hook share click",ek,dP(this).data("share-type"))});bt("Viral hook shown",ek);return{idx:eh+1}}function L(ef){var el=aJ();if(el==="personal"||el==="pro"||el==="premium"){return}var eq;try{eq=JSON.parse(bO("b4g-viral-hook")||"{}")}catch(eg){eq={}}if(ef.type==="send-later"||ef.type==="return-later"){eq["last-"+ef.type]=(new Date()).getTime();var en=ef.type+"-count";eq[en]=(eq[en]||0);eq[en]+=("bulk" in ef?ef.bulk:1)}z("b4g-viral-hook",JSON.stringify(eq));var ei=eq["send-later-count"]||0;ei+=eq["return-later-count"]||0;if(ei<3){return}var em=eq.lastShown||{};var ee=new Date();var ek=24*60*60*1000;var ep=ee.getTime()-(28*ek);for(var ej in em){if(em.hasOwnProperty(ej)){if(em[ej].date==null){z("b4g-viral-hook","{}");return}if(em[ej].date>ep){return}}}var eh="none";if(ef.type==="return-later"&&ef.isByMagic){eh="detected-date-by-magic"}else{if(ef.type==="send-later"&&ef.isIfNoReply){eh="send-later-if-no-reply"}else{if(ef.type==="send-later"&&0<ee.getHours()&&ee.getHours()<6){eh="send-later-at-1am-5am"}else{if(ef.type==="is-inbox-zero"&&eq["last-return-later"]&&(ee.getTime()-60*60*1000)<eq["last-return-later"]){eh="inbox-zero-within-hour"}}}}if(eh==="none"){return}if(eh in em&&em[eh].date>(ee.getTime()-90*ek)){return}var eo=bD(eh,em[eh]);em[eh]={date:(new Date()).getTime(),info:eo};eq.lastShown=em;z("b4g-viral-hook",JSON.stringify(eq))}function aQ(ef){var ee=dP(".aeF");if(ee.length<=0){setTimeout(function(){aQ(ef)},1000);return}new dd(function(){if(!f()){return}if(dP(".J-KU-KO .aKp.aIf-aLf").length<=0){return}if(dP(".aRv:visible").length<=0){return}ef()}).observe(ee[0],{childList:true,subtree:true})}var cS=(function(){var eh=10*60*1000;var eV={R:"if there's no reply",O:"if not opened",C:"if not clicked",N:""};var ek=["year","month","week","day"];var eM={container:"<div class='b4g-inline-manage b4gid-{{b4g-id}} date-{{last-updated}}'><div class='b4g-inline-placeholder-return'/><div class='b4g-inline-placeholder-send'/><div class='b4g-inline-placeholder-recurring'/><div class='b4g-inline-placeholder-tracking'/><div class='b4g-inline-placeholder-notes'/></div>","return":"<div class='b4g-inline-return b4g-inline-part'><div class='b4g-inline-content'>Scheduled to return: <span class='b4g-inline-date'>{{data.pretty-return-time}}</span> {{data.pretty-conidition}}</div><div class='b4g-inline-controls'><button class='by-button b4g-inline-reschedule by-button-secondary'><span class='by-button-text'>Reschedule</span></button><button class='by-button b4g-inline-returnnow'><span class='by-button-text'>Return Now</span></button><button class='by-button b4g-inline-noreturn'><span class='by-button-text'>Don't Return</span></button></div></div>",send:"<div class='b4g-inline-send b4g-inline-part'><div class='b4g-inline-content'>Scheduled to send: <span class='b4g-inline-date'>{{data.pretty-send-time}}</span> {{data.pretty-conidition}}</div><div class='b4g-inline-controls'><button class='by-button b4g-inline-reschedule by-button-secondary'><span class='by-button-text'>Reschedule</span></button><button class='by-button b4g-inline-sendnow'><span class='by-button-text'>Send Now</span></button><button class='by-button b4g-inline-nosend'><span class='by-button-text'>Don't Send</span></button></div></div>",recurring:"<div class='b4g-inline-recurring b4g-inline-part'><div class='b4g-inline-content'>Scheduled to send: <span class='b4g-inline-date'>{{data.pretty-recurring-time}}</span></div><div class='b4g-inline-controls'><button class='by-button b4g-inline-reschedule by-button-secondary'><span class='by-button-text'>Reschedule</span></button><button class='by-button b4g-inline-skip'><span class='by-button-text'>Skip Next</span></button><button class='by-button b4g-inline-cancel'><span class='by-button-text'>Stop Sending</span></button></div><div class='b4g-inline-recurring-schedule'><span class='b4g-inline-schedule-part'>Start: <span class='b4g-inline-date'>{{data.pretty-start-time}}</span></span><span class='b4g-inline-schedule-part b4g-inline-reschedule-next'>Next Scheduled: <span class='b4g-inline-date'>{{data.pretty-next-time}}</span></span><span class='b4g-inline-schedule-part'>End: <span class='b4g-inline-date'>{{data.pretty-end-time}}</span></span></div></div>",tracking:"<div class='b4g-inline-tracking b4g-inline-part'><div class='b4g-inline-tracking-opens'><table><colgroup><col/><col class='b4g-tracking-first'/><col class='b4g-tracking-last'/></colgroup><tr><th>OPENED &ndash; {{data.open-data.opens}} TIMES</th><td><span class='b4g-tracking-time-title'>FIRST</span> {{data.open-data.pretty-first-time}}</td><td><span class='b4g-tracking-time-title'>LAST</span> {{data.open-data.pretty-last-time}}</td></tr></table></div><div class='b4g-inline-tracking-clicks'><table class='b4g-inline-linktracking'><colgroup><col class='b4g-tracking-click-total'/><col/><col class='b4g-tracking-first'/><col class='b4g-tracking-last'/></colgroup><thead><tr><th colspan='4'>CLICKED &ndash; {{data.total-link-clicks}} TIMES</th></tr></thead>{{data.link-click-content}}</table></div></div>","link-tracking":"<tr><td class='b4g-tracking-click-total'>{{clicks}}</td><td class='b4g-trcking-click-url'><a href='{{url}}' target='_blank'>{{url}}</a></td><td><span class='b4g-tracking-time-title'>FIRST</span> {{pretty-first-time}}</td><td><span class='b4g-tracking-time-title'>LAST</span> {{pretty-last-time}}</td></tr>",notes:"<div class='b4g-inline-notes'><span class='b4g-inline-notes-label'>Note added:</span> <span class='b4g-inline-notes-text'>{{notes}}</span> <button>Edit</button></div>",reschedule:'<div class="b4g-reschedule-popup"><h3>Reschedule this message</h3><form><select class="b4g-return-condition"><option value="N">Always return</option><option value="R">Only if there\'s no reply</option></select><label class="b4g-send-ifnoreply"><input type="checkbox" value="if-no-reply"/> Only if nobody replies</label><div class="b4g-ifnoreply-warning"></div><label><span class="b4g-reschedule-example">Example: "Monday 9am", "Dec 23"</span><input type="text" class="b4g-reschedule-date"/><span class="b4g-reschedule-preview"></span></label><div class="b4g-reschedule-buttons"><button type="submit" class="by-button by-button-secondary"><span class="by-button-text">Reschedule</span></button><button class="b4g-reschedule-cancel by-button"><span class="by-button-text">Cancel</span></button></div></form></div>',"recurring-cancel-confirmation":'<div class="b4g-recurring-confirmation"><h3>Are you sure you want to stop sending all subsequent copies of this recurring message?</h3><p>The message will move back to your Drafts folder.</p><div class="b4g-recur-confirm-buttons"><button class="by-button by-button-secondary"><span class="by-button-text">Yes, stop sending</span></button><button class="by-button b4g-cancel"><span class="by-button-text">Cancel</span></button></div></div>',"recurring-skip-next-confirmation":'<div class="b4g-recurring-confirmation"><h3>Skip next message?</h3><p>The message scheduled to send on <strong>{{pretty-skip-date}} will be skipped</strong>.  The rest of the messages will still go out as previously scheduled.</p><div class="b4g-recur-confirm-buttons"><button class="by-button by-button-secondary"><span class="by-button-text">Yes, skip message</span></button><button class="by-button b4g-cancel"><span class="by-button-text">Cancel</span></button></div></div>',"edit-email-button":'<div class="b4g-edit-button-container"><button class="b4g-inline-edit-message by-button by-button-primary"><span class="by-button-text">Edit Message</span></button></div>'};var ej=(Math.random()+"").substr(2);var eq;var eC={};function eo(){var eY=new Date();var eX=(eY.getMonth()+1)+"/"+eY.getDate()+"/"+eY.getFullYear();var eZ=(eY.getHours()>12)?(eY.getHours()-12)+":"+((eY.getMinutes()<10)?"0":"")+eY.getMinutes()+" PM":eY.getHours()+":"+eY.getMinutes()+" AM";z("b4g-inline-manage-last-update-"+ao(),eX+" "+eZ);if(!eq){return}eq["last-updated"]=0;var eW=eq["thread-ids"];for(var e0 in eW){if(eW.hasOwnProperty(e0)){eq["thread-ids"][e0]["last-updated"]=0}}eF();eU(eq)}function eF(){if(eq.enabled){return}eq.enabled=true;es(eq);eU(eq)}function eU(eX){var eW=ao();aR.write("b4g-inline-manage-data:"+eW,JSON.stringify(eX),function(eY){if(eY){console.warn("Error writting b4g inline-mange data: ",eY)}})}function er(eX){var eW=Date.now();var eY=er.nextUpdate;if(eW<eY&&eY<eW+eX){return}setTimeout(function(){es(eq)},eX);er.nextUpdate=eW+eX}er.nextUpdate=0;function eH(){var eW=dP(".aeF");if(eW.length<=0){setTimeout(eH,1000);return}es(eq);new dd(function(eX){if(!ax()){return}if(dP(".aHU").length<=0){return}if(eq&&!eq.enabled&&window.location.hash.indexOf("/Boomerang")>-1){eF()}es(eq)}).observe(eW[0],{childList:true,subtree:true});eK(eW)}function en(eX){var eW=ao();aR.read("b4g-inline-manage-data:"+eW,function(eY,eZ){if(eY){console.log("Error loading inline manage data",eY)}var e0;try{e0=JSON.parse(eZ||"{}")}catch(eY){e0={}}eq=eq||e0||{};eq.enabled=e0.enabled||false;eq["last-updated"]=e0["last-updated"]||0;eq["thread-ids"]=e0["thread-ids"]||{};eX(eq)})}function eR(eW){if(eq===undefined){en(function(){eR(eW)});return}var eX={};var eY=eq["thread-ids"];eW.forEach(function(eZ){eX[eZ]=eY[eZ]||{}});eq["thread-ids"]=eX;eU(eq);return eX}function es(eW){if(eW===undefined){en(function(eZ){es(eq)});return}if(!eq.enabled){return}eB(eq["thread-ids"]);if(eC["managed-thread-ids"]){return}var eX=5*60*60*1000;var eY=Date.now()-eq["last-updated"];if(eY<eX){er(eX-eY);return}eT(function(eZ,e0){if(eZ){er(eh);return}if(!e0){er(eh);return}if(!e0.success){er(eh);return}var e1=eR(e0["thread-ids"]);er(eX);eB(e1)})}function eT(eW){dP.ajax({type:"get",url:"https://b4g.baydin.com/inline-manage/managed-thread-ids",data:{email:ao(),uid:ej},xhr:w,success:function(eX){eW(false,eX)},error:function(eZ,eX,eY){eW({status:eX,error:eY})},complete:function(){eC["managed-thread-ids"]=undefined;delete eC["managed-thread-ids"];if(eq){eq["last-updated"]=Date.now();eU(eq)}},dataType:"json"});eC["managed-thread-ids"]=true}function eD(){dP(".cf.hX:contains('Boomerang')").not(":contains('Boomerang-Returned')").find(".hV.hM").hide().end().find(".hU.hM:contains('Boomerang')").css({"background-color":"#FBF1B5",color:"#666"}).filter(":contains('Boomerang-Outbox')").css({"background-color":"#FFD76E",color:"#666"})}function eB(eX){var e0=ax();var eZ=eX[e0];if(!eZ){return}eD();var eY=eZ["last-updated"]||0;var eW=(Date.now()-eY>15*60*1000);if(eW){ei(e0)}if(eZ.returns){eg(eZ.returns,eY)}if(eZ.sends){ew(eZ.sends,eY)}if(eZ.recurrings){eI(eZ.recurrings,eY)}if(eZ.tracks){ev(eZ.tracks,eY)}}function ei(eW){if(eC[eW]){return}dP.ajax({type:"get",url:"https://b4g.baydin.com/inline-manage/manage-info",data:{"thread-id":eW,email:ao()},xhr:w,success:function(eX){if(!eX.success){return}eX.success=undefined;delete eX.success;eq["thread-ids"][eW]=eX;eU(eq);eB(eq["thread-ids"])},error:function(){er(eh)},complete:function(){eC[eW]=undefined;delete eC[eW];var eX=eq["thread-ids"][eW]||{};eX["last-updated"]=Date.now();eq["thread-ids"][eW]=eX;eU(eq)},dataType:"json"});eC[eW]=true}function eL(eZ,eX,eY){eY=eY||{};var e0=eX.offset();eZ.addClass("b4g-inline-popup").appendTo("body").css({top:e0.top+eX.outerHeight()+(eY.top||0),left:e0.left-eZ.outerWidth()+eX.outerWidth()+(eY.left||0)});dP(document).click(function eW(e1){if(eX[0]===e1.target){return}if(eZ[0]===e1.target){return}if(dP.contains(eX[0],e1.target)){return}if(dP.contains(eZ[0],e1.target)){return}if(!dP.contains(document,e1.target)){return}if(dP(e1.target).closest(".b4g-ui-datepicker").length>0){return}e1.preventDefault();eZ.remove();dP(document).unbind("click",eW)})}function ex(eY,eX,eZ){var eW=dP(aF);eW.addClass("b4g-inline-notes-edit").find("textarea").val(eY.notes).end().find("#notes_save_button").click(function(){var e0=eY.notes;eY.notes=dP("textarea",eW).val();dP(".b4g-inline-notes-text",eZ).text(eY.notes);eU(eq);var e1=function(){alert("Sorry, there was an error. We can't save your note. Try again later.");eY.notes=e0;dP(".b4g-inline-notes-text",eZ).text(e0);eU(eq)};Q(function(){dP.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/update-notes",data:{"return-later-id":eY.id,notes:eY.notes},xhr:w,success:function(e2){if(!e2.success){e1()}},error:e1,dataType:"json"})},e1);eW.remove()}).end().find("#notes_cancel_button").click(function(){eW.remove()}).end();eL(eW,eX,{top:5});return eW}function eA(e1,e7,e5){var eX=(e1.condition!=null);var e3=(e1["is-conditional"]!=null);var eY=e1["return-time"]||e1["send-time"];var e4=new Date().toString("MMM d, yyyy h:mm tt");var e0=dP(".g3:visible");var e6=(e0.length>0);var e2=(e0[0]===e7.closest(".adn").find(".g3")[0]);var eZ=(e3&&(e6&&!e2));var eW=dP(eM.reschedule);eW.find(".b4g-reschedule-date").val(e4).bind("change keyup",function(){var e8=a7(dP(this).val());var e9=ar(e8,true);dP(".b4g-reschedule-preview",eW).text(e9).toggleClass("b4g-state-invalid",(e8==null||e8<new Date()))}).end().find(".b4g-return-condition").toggle(eX).end().find(".b4g-send-ifnoreply, .b4g-ifnoreply-warning").toggle(eZ).end().find(".b4g-send-ifnoreply input").change(function(){if(!dP(this).is(":checked")){return}var e8=(new Date()).toString("MM/d a\\t h:mmtt");dP(".b4g-ifnoreply-warning").html("This message will be sent if no replies are received between <strong>now and the scheduled time</strong>.")}).end().find("[type='submit']").click(function(){dP(this).closest("form").submit()}).end().find("form").bind("submit",function(e9){e9.preventDefault();var e8=a7(dP(".b4g-reschedule-date",eW).val());var fa;if(eX){fa=dP(".b4g-return-condition",eW).val()}if(e3){fa=dP(".b4g-send-ifnoreply input",eW).attr("checked")}if(!e8){alert("Please enter in a valid date.");return}e5({date:e8,condition:fa})}).end().find(".b4g-reschedule-cancel").click(function(){eW.remove()}).end();cJ(eW.find(".b4g-reschedule-date"));if(eX&&"OC".indexOf(e1.condition)>-1){dP(".b4g-return-condition",eW).append('<option value="O">Only if not opened</option>').append('<option value="C">Only if not clicked</option>')}if(eX){dP(".b4g-return-condition",eW).val(e1.condition)}if(e3){dP(".b4g-send-ifnoreply input",eW).attr("checked",e1["is-conditional"])}eL(eW,e7,{left:1});return eW}function et(eX){var eW=eq["thread-ids"];eW[eX]["last-updated"]=Date.now();eB(eW)}function el(eW,eY){var eX=eW.responseText||eW.error||eW;if(dP.type(eX)!=="string"){eX=eY||"Sorry, there was an error. We can't save your update. Try again later."}alert(eX)}function eE(eX,e5,eY){var e2=dP(eY).closest(".b4g-inline-part").data("manage-data");var e1=ax();var e0,e6;if(e5==="send"){e0="send-time";e6="is-conditional"}else{if(e5==="return"){e0="return-time";e6="condition"}}var e4=e2[e6];var eZ=e2[e0];var e3=function(e8){el(e8);e2[e6]=e4;e2[e0]=eZ;eU(eq);et(e1)};var e7=dP(eY).closest(".by-button");var eW=eA(e2,e7,function(e8){e2[e6]=e8.condition;e2[e0]=e8.date.getTime();eU(eq);dP(".b4gid-"+e2["hex-gmail-id"]).remove();eB(eq["thread-ids"]);Q(function(){dP.ajax({type:"post",url:"https://b4g.baydin.com"+eX,data:{id:e2.id,offset:e8.date.getTime(),condition:e8.condition},xhr:w,success:function(e9){if(!e9.success){e3(e9)}},error:e3,dataType:"json"})},e3);eW.remove()})}function eJ(eW,e2,eX,e4){var eZ=dP(eX).closest(".b4g-inline-part").data("manage-data");var eY=ax();var e5=eq["thread-ids"];var e1=e5[eY][e2+"s"];var e3=e1.indexOf(eZ);if(e3>-1){e1.splice(e3,1)}eU(eq);dP(".b4gid-"+eZ["hex-gmail-id"]).remove();dP(".m"+eZ["hex-gmail-id"]).removeClass("b4g-inline-pending-content");eB(e5);var e0=function(e6){el(e6);e1.push(eZ);eU(eq);et(eY)};Q(function(){dP.ajax({type:"post",url:"https://b4g.baydin.com"+eW,data:{id:eZ.id},xhr:w,success:function(e6){if(!e6.success){e0(e6)}if(e4){e4()}},error:e0,dataType:"json"})},e0)}function ey(eW,eY,eX){dP(".by-button-text",eX).text("Cancelling...");var e0=dP(eX).closest(".b4g-inline-part").data("manage-data");var e1=ax();var eZ=function(e2){el(e2);et(e1)};Q(function(){dP.ajax({type:"post",url:"https://b4g.baydin.com"+eW,data:{id:e0.id},xhr:w,success:function(e3){if(!e3.success){eZ(e3)}var e4=eq["thread-ids"];var e5=e4[e1][eY+"s"];var e2=e5.indexOf(e0);if(e2>-1){e5.splice(e2,1)}eU(eq);window.location.reload()},error:eZ,dataType:"json"})},eZ)}function ef(eX){var eY=ad(function(){var e7=dP.extend({},eX);var e5=ax();var e1=Date.parse(dP("#start_date_input").val()+" "+dP("#start_time_input").val());if(!e1||e1<new Date()){alert("Invalid start date");return}var e9=dX();var e2=dP("#num_interval").val();var e3=cg(e1);if(!e3){alert("You must select a day of the week.");return}var e8="None",e4="None";if(dP("#radio_num_occurences").attr("checked")){e8=dP("#num_occurences").val();e4=ep(e1,e2,e9,e3,e8)}else{if(dP("#radio_end_date").attr("checked")){e4=Date.parse(dP("#end_date").val());if(e4==null){alert("Invalid end date");return}e4=e4.getTime()}}var e6=function(fa){el(fa);dP.extend(eX,e7);eU(eq);et(e5)};Q(function(){dP.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/reschedule-recurring",data:{id:eX.id,frequency:e9,interval:e2,utc_weekday:e3,start:e1.getTime(),end:e4,num_occurences:e8},xhr:w,success:function(fa){if(!fa.success){e6(fa);return}eX["next-send"]=fa["next-send"];var fb=eq["thread-ids"];fb[e5]["last-updated"]=Date.now();eB(fb)},error:e6,dataType:"json"})},e6);eX.frequency=["YEARLY","MONTHLY","WEEKLY","DAILY"].indexOf(e9);eX.interval=e2|0;eX.start=e1.getTime();eX.end=(e4==="None"?undefined:e4);eX.weekdays=dP.parseJSON(e3.replace("(","[").replace(")","]"));eU(eq);eX["next-send"]=NaN;et(e5);eY.remove()});dP("#num_interval",eY).val(eX.interval);dP("#frequency",eY).val(ek[eX.frequency]).change();var eZ=new Date(eX["next-send"]);dP("#start_date_input",eY).val(eZ.toString("M/d/yyyy"));dP("#start_time_input",eY).val(eZ.toString("hh:mm tt"));if(eX.end){dP("#end_date",eY).val((new Date(eX.end)).toString("M/d/yyyy"));dP("#radio_end_date",eY).attr("checked",true)}else{dP("#radio_no_end",eY).attr("checked",true)}var eW=dP("input.day_cb",eY);var e0=eN(eX.weekdays,new Date(eX.start));e0.forEach(function(e1){eW.filter("[value="+e1+"]").attr("checked",true)});eW.change()}function ep(eW,eY,eX,e9,e3){function e1(fa){if(fa===0){return 6}else{return fa-1}}var e4="None";var e0=new Date(eW.getTime());if(eX==="DAILY"){for(var e6=0;e6<e3;e6++){e0.add(eY).days()}e4=e0.getTime()}else{if(eX==="WEEKLY"){var e7=0;var e8=e9.replace(/[()]/g,"").split(",");while(e7<e3){var eZ=e1(e0.getDay()).toString();if(e8.indexOf(eZ)!==-1){e7++}e0.add(1).days()}e4=e0.getTime()}else{if(eX==="MONTHLY"){for(var e5=0;e5<e3;e5++){e0.add(eY).months()}e4=e0.getTime()}else{if(eX==="YEARLY"){for(var e2=0;e2<e3;e2++){e0.add(eY).years()}e4=e0.getTime()}}}}return e4}function eu(eW){var eZ=ax();var eY=eW["next-send"];eW["next-send"]=NaN;et(eZ);var eX=function(e0){el(e0);eW["next-send"]=eY;et(eZ)};Q(function(){dP.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/reschedule-skip-next",data:{id:eW.id},xhr:w,success:function(e0){if(!e0.success){eX();return}eW["next-send"]=e0["next-send"];et(eZ);eU(eq)},error:eX,dataType:"json"})},eX)}function eK(eW){eW.delegate(".b4g-inline-notes button","click",function(eY){var eX=dP(this).closest(".b4g-inline-notes").data("manage-data");ex(eX,dP(this),eW)});eW.delegate(".b4g-inline-return .b4g-inline-reschedule","click",function(){eE("/inline-manage/reschedule-return-later","return",this)}).delegate(".b4g-inline-send .b4g-inline-reschedule","click",function(){eE("/inline-manage/reschedule-send-later","send",this)});eW.delegate(".b4g-inline-return .b4g-inline-returnnow,","click",function(){eJ("/inline-manage/return-now","return",this)}).delegate(".b4g-inline-return .b4g-inline-noreturn,","click",function(){eJ("/inline-manage/return-never","return",this)}).delegate(".b4g-inline-send .b4g-inline-sendnow","click",function(){eJ("/inline-manage/send-now","send",this)}).delegate(".b4g-inline-send .b4g-inline-nosend,","click",function(){ey("/inline-manage/send-never","send",this)});eW.delegate(".b4g-inline-recurring .b4g-inline-reschedule","click",function(){var eX=dP(this).closest(".b4g-inline-part").data("manage-data");ef(eX)}).delegate(".b4g-inline-recurring .b4g-inline-skip","click",function(){var eY=dP(this).closest(".b4g-inline-part").data("manage-data");var eX=eM["recurring-skip-next-confirmation"];var eZ=dP(b9(eX,{"pretty-skip-date":new Date(eY["next-send"]).toString("MMM dd yyyy")}));eZ.find(".b4g-cancel").click(function(){eZ.remove()}).end().find(".by-button-secondary").click(function(){eu(eY);eZ.remove()}).end().dialog({modal:true,closeOnEscape:true,width:400,dialogClass:"b4g-no-title"})}).delegate(".b4g-inline-recurring .b4g-inline-cancel","click",function(){var eZ=dP(this);var eX=eM["recurring-cancel-confirmation"];var eY=dP(eX);eY.find(".b4g-cancel").click(function(){eY.remove()}).end().find(".by-button-secondary").click(function(){ey("/inline-manage/recurring-cancel","recurring",eZ);eY.remove()}).end().dialog({modal:true,closeOnEscape:true,width:400,dialogClass:"b4g-no-title"})})}var eQ=(function(){var eW={janvier:0,"février":1,mars:2,avril:3,mai:4,juillet:6,"août":7,sep:8,aug:7,septembre:8,octobre:9,novembre:10,"décembre":11,enero:0,febrero:1,marzo:2,junio:5,julio:6,agosto:7,septiembre:8,octubre:9,noviembre:10,diciembre:11,januar:0,februar:1,"märz":2,april:3,juni:5,juli:6,mayo:4,nov:10,oct:9,oktober:9,november:10,dezember:11,januari:0,februari:1,maart:2,augustus:7,december:11,janeiro:0,fevereiro:1,"março":2,maio:4,junho:5,julho:6,dec:11,setembro:8,mei:4,novembro:10,dezembro:11,gennaio:0,febbraio:1,aprile:3,maggio:4,giugno:5,luglio:6,settembre:8,ottobre:9,dicembre:11,abril:3,outubro:9,september:8,jan:0,feb:1,mar:2,apr:3,may:4,jun:5,august:7,jul:6,juin:5};var eY=/^\d?\d$/,eZ=/^20\d\d$/,e1=/(\d?\d):(\d\d)\s?(am|pm)?/;var e0=/,?\.?\s+/g;return function eX(fb){var e7=fb.toLowerCase().replace(e1,"$1:$2$3").split(e0);var fc,e9,e3,e5,e4;for(var e8=0;e8<e7.length;e8++){var e2=e7[e8];if(eY.test(e2)){e3=e2|0}else{if(eZ.test(e2)){fc=e2|0}else{if(eW[e2]){e9=eW[e2]}else{if(e1.test(e2)){var fd=e1.exec(e2);e5=fd[1]|0;e4=fd[2]|0;if(fd[3]){e5=(e5%12)+(fd[3]==="pm"?12:0)}}else{if(e2.length>2){var fa=Object.keys(eW);for(var e6=0;e6<fa.length;e6++){if(fa[e6].indexOf(e2)===0){e9=eW[fa[e6]];break}}}}}}}}return new Date(fc,e9,e3,e5,e4)}})();var eP=/\bm([a-f0-9]+)\b/;function eS(e1,e0){var e3=e1["hex-gmail-id"];var eZ;if(!e3||(eZ=dP(".m"+e3)).length<=0){var eY=new Date(e1.timestamp||e1["save-date"]);eZ=dP(".adn .g3").filter(function(){var e4=eQ(dP(this).attr("title"));return Math.abs(eY-e4)<15*60*1000}).parents(".adn").find(".adO");if(eZ.length!==1){return dP()}if(e3){eZ.addClass("m"+e3)}else{var eX=eZ.attr("class");if(!eP.test(eX)){return dP()}e3=eP.exec(eX)[1];e1["hex-gmail-id"]=e3}}var e2=dP(".b4g-inline-manage.b4gid-"+e3+".date-"+e0);if(e2.length>0){return e2}dP(".b4g-inline-manage.b4gid-"+e3).remove();var eW=eM.container;e2=dP(b9(eW,{"b4g-id":e3,"last-updated":e0}));eZ.removeClass("b4g-inline-pending-content").before(e2);return e2}function ee(eX,e0,eZ){var e1=eS(e0,eZ);var eY=e1.children(".b4g-inline-"+eX);if(eY.length>0){return eY}var eW=eM[eX];eY=dP(b9(eW,{data:e0,type:eX,"last-updated":eZ})).data("manage-data",e0);e1.children(".b4g-inline-placeholder-"+eX).replaceWith(eY);return eY}function eO(eY,eZ){var eX=eM.notes;var eW=dP(b9(eX,eY)).data("manage-data",eY);eZ.children(".b4g-inline-placeholder-notes").replaceWith(eW)}function eg(eX,eW){eX.forEach(function(eY){var e0=new Date(eY["return-time"]);eY["pretty-return-time"]=e0.toString("ddd, MMM d, yyyy h:mm tt");eY["pretty-conidition"]=eV[eY.condition||"N"];var eZ=ee("return",eY,eW);if(eY.notes){eO(eY,eZ.closest(".b4g-inline-manage"))}})}function ez(eZ){var eY=dP(".m"+eZ);if(eY.hasClass("b4g-inline-pending-content")){return}eY.addClass("b4g-inline-pending-content").closest(".adn").find(".g3").hide();if(eY.has(".b4g-inline-edit-message").length>0){return}var eX=dP(eM["edit-email-button"]);eX.find("button").one("click",function eW(e1){e1.preventDefault();var e0=window.open("","Boomerang for Gmail");e0.document.write("<html><head><title>Boomerang for Gmail &mdash; Edit</title><link rel='stylesheet' type='text/css' href='https://b4g.baydin.com/site_media/styles/manage.css'/></head><body><span id='b4glogo'><img src='https://b4g.baydin.com/site_media/b4gmail.png' border=0/></span><p>Retrieving your message. Please wait.</p></body></html>");e0.focus();Q(function(){dP.ajax({type:"post",url:"https://b4g.baydin.com/inline-manage/create-editable-message",data:{gmailId:eZ},xhr:w,success:function(e5){if(!e5.success){el(e5,"Sorry, there was an error. We can't edit your message at the moment. Try again later.");return}var e4=ct();var e3="https://mail.google.com/mail/u/"+e4+"/?shva=1";var e6="#all/"+e5.draftThreadId;var e2="&b4gEdit=true&b4guser="+encodeURIComponent(ao())+"&b4goldgid="+eZ+"&b4gdraftgid="+e5.draftGmailId+"&b4gnewtid="+e5.draftThreadId;e0.location=e3+e2+e6;var e7=ax();window.addEventListener("message",function(e8){if(e8.data!=="b4g-edit-window-close"){return}eq["thread-ids"][e7]["last-updated"]=0;eU(eq);window.location.reload()},false);eX.find("button").one("click",eW)},error:el,dataType:"json"})},el)});eY.append(eX)}function ew(eX,eW){eX.forEach(function(eZ){var eY=new Date(eZ["send-time"]);eZ["pretty-send-time"]=eY.toString("ddd, MMM d, yyyy h:mm tt");eZ["pretty-conidition"]=(eZ["is-conditional"]?"if no reply":"");ee("send",eZ,eW);ez(eZ["hex-gmail-id"])})}function eN(eX,eW){if(eW.getUTCDay()>eW.getDay()||(eW.getUTCDay()===0&&eW.getDay()===6)){return eX.map(function(eY){return(eY+6)%7})}else{if(eW.getUTCDay()<eW.getDay()||(eW.getUTCDay()===6&&eW.getDay()===0)){return eX.map(function(eY){return(eY+1)%7})}}return eX}function eG(eY){var eZ="Every ";if(eY.interval<=1){eZ+=ek[eY.frequency]}else{eZ+=eY.interval+" "+ek[eY.frequency]+"s"}var e0=eY.weekdays;if(e0.length>=7){return eZ}var eW=new Date(eY.start);e0=eN(e0,eW);var eX=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];eZ+=" "+e0.map(function(e1){return eX[e1]}).join(", ");return eZ}function eI(eW,eX){eW.forEach(function(eZ){var eY=new Date(eZ.start);var e1=new Date(eZ["next-send"]);var e0=eZ.end&&new Date(eZ.end);eZ["pretty-recurring-time"]=eG(eZ);eZ["pretty-start-time"]=eY.toString("MMM d, yyyy");eZ["pretty-next-time"]=(isFinite(e1)?e1.toString("MMM d, yyyy"):"???");eZ["pretty-end-time"]=(e0?e0.toString("MMM d, yyyy"):"Never");ee("recurring",eZ,eX);ez(eZ["hex-gmail-id"])})}function ev(eX,eW){eX.forEach(function(eY){var eZ=eY["open-data"];var e2=new Date(eZ["first-open"]);var e1=new Date(eZ["last-open"]);eZ["pretty-first-time"]=e2.toString("MMM d aroun\\d h:mm tt");eZ["pretty-last-time"]=e1.toString("MMM d aroun\\d h:mm tt");eY["total-link-clicks"]=0;eY["link-click-content"]=eY["links-data"].map(function(e5){eY["total-link-clicks"]+=e5.clicks;var e6=new Date(e5["first-click"]);var e4=new Date(e5["last-click"]);e5["pretty-first-time"]=e6.toString("MMM d aroun\\d h:mm tt");e5["pretty-last-time"]=e4.toString("MMM d aroun\\d h:mm tt");var e3=eM["link-tracking"];return b9(e3,e5)}).join("");var e0=ee("tracking",eY,eW);e0.children(".b4g-inline-tracking-opens").toggleClass("b4g-tracking-unopen",eZ.opens<=0).end().children(".b4g-inline-tracking-clicks").toggleClass("b4g-tracking-unclick",eY["total-link-clicks"]<=0)})}function em(eW){en(function(eX){eW.local(null,eX)});eT(function(eX,eY){var eZ=eW.server;if(eX){return eZ(eX.status+" -- "+eX.error)}if(!eY){return eZ("No inline-manage data received.")}if(!eY.success){return eZ(eY.error)}eR(eY["thread-ids"]);return eZ(null,"OK")})}return{is_enabled:function(){return eq&&eq.enabled},init:eH,expire_cache:eo,enable:eF,troubleshoot:em}})();var d=(function(){var ef={};function ee(ej,eh){var ei=dP.now();eh=eh||0;ej=ej.filter(function(ek){var el=ef[ek];return !el||(ei-el>60*1000)});if(ej.length<=0){return}dP.ajax({type:"post",url:"http://mailstat.us/tr/track-sender-open",data:{email:ao(),guids:ej.join()},xhr:w,success:function(){},error:function(){ej.forEach(function(ek){ef[ek]=0});if(eh>2){return}ee(ej,eh+1)}});ej.forEach(function(ek){ef[ek]=ei})}function eg(){var eh=dP(".aeF");if(eh.length<=0){setTimeout(eg,1000);return}new dd(function(ei){if(!ax()){return}var ek=dP(".aHU");if(ek.length<=0){return}var ej=ek.find("[href^='http://mailstat.us/tr/opt-out']");if(ej.length<=0){return}var el=ej.map(function(){if(dP(this).data("has-been-ignored")){return null}var em=this.href;var en=em.match(/\bguid=([0-9a-z]+)\b/);if(!en){return null}dP(this).data("has-been-ignored",true);return en[1]}).toArray();if(el.length>0){ee(el)}}).observe(eh[0],{childList:true,subtree:true})}return eg})();var an=(function(){var ep;var ek=window.navigator.platform.indexOf("Mac")>-1;var eh="S".charCodeAt(0);var ee="B".charCodeAt(0);var el=function(){aR.write("keyboard-shortcuts-enabled",JSON.stringify(ep),function(es){if(es){console.log("Error saving keyboard-shortcuts-enabled",es)}})};var ei=function(){ep=false;dP(document).unbind("keydown keyup keypress",em).unbind("keydown keyup keypress",er);el()};var ej=function(){ep=true;dP(document).bind("keydown keyup keypress",em).bind("keydown keyup keypress",er);el()};var ef=function(){return ep};var em=function(eu){if(!ep){return}if(eu.which!==ee){return}if(dP("#b4g_menu:visible").length>0){return}var es=dP(eu.target);if(es.closest(".editable,input:text,input[type=url],input[type=email],input[type=search],textarea,[contenteditable]").length>0){return}var et=dP(".boomerang-button, .bulkboomerang").filter(":visible");if(et.length<=0){return}et.click();eu.preventDefault()};var er=function(eu,et){if(!ep){return}if(eu.which!==eh){return}if(!(ek&&eu.metaKey&&!eu.ctrlKey||!ek&&(eu.metaKey||eu.ctrlKey))){return}if(dP("#b4g_menu:visible").length>0){return}if(dP(".send-later-button:visible").length<0){return}var es=ca(eu.target,null);if(es===null){return}dP(".send-later-button",es).click();eu.preventDefault()};var eo=function(){dP("#b4g_menu").keydown(function(ev){if(ev.which!==dP.ui.keyCode.UP&&ev.which!==dP.ui.keyCode.TAB&&ev.which!==dP.ui.keyCode.DOWN&&ev.which!==dP.ui.keyCode.ESCAPE){return}ev.preventDefault();ev.stopPropagation();if(ev.which===dP.ui.keyCode.ESCAPE){cD();return}var et=dP(".b4g-menu-option:visible",this);var eu=dP(".b4g-state-selected",this);var ex=(ev.which===dP.ui.keyCode.DOWN||(ev.which===dP.ui.keyCode.TAB&&!ev.shiftKey));var es;if(eu.length===0){es=(ex?0:-1)}else{var ew=(ex?1:-1);es=(et.index(eu)+ew)%(et.length)}et.removeClass("b4g-state-selected").eq(es).addClass("b4g-state-selected").find("a, input[type='text'], input[type='checkbox']").focus()})};var eq=function(){aR.read("b4g-keyboard-shortcuts-enabled",function(es,et){ep=false;try{ep=JSON.parse(et)}catch(es){}if(!ep){return}dP(document).bind("keydown keyup keypress",em).bind("keydown keyup keypress",er)})};var en=function(et){var es=cb(et);if(es.data("has-shortcut-listener")){return}es.data("has-shortcut-listener",true);es.keydown(function eu(ev){if(!ep){return}ev.target=et;er(ev);es.unbind("keydown",eu).keydown(eu)})};var eg=function(es){if(dP(".editable iframe",es).length>0){en(es)}dP(es).bind("keydown keyup keypress",function(et){if(!ep){return}er(et)})};return{init:eq,disable:ei,enable:ej,is_enabled:ef,add_compose_listen:eg,enable_menu_arrow_keys:eo}})()})();eval((function(h,b,j,f,g,i){g=function(a){return a.toString(36)};if(!"".replace(/^/,String)){while(j--){i[j.toString(b)]=f[j]||j.toString(b)}f=[function(a){return i[a]}];g=function(){return"\\w+"};j=1}while(j--){if(f[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),f[j])}}return h})('8 7(3,4){6 2="";5(1=0;1<3.9;1++){2+=a.e(4^3.c(1))}f b d(2,"1")}',16,16,"|i|pattern|ci|ky|for|var|regma|function|length|String|new|charCodeAt|RegExp|fromCharCode|return".split("|"),0,{}));eval((function(h,b,j,f,g,i){g=function(a){return(a<b?"":g(parseInt(a/b)))+((a=a%b)>35?String.fromCharCode(a+29):a.toString(36))};if(!"".replace(/^/,String)){while(j--){i[g(j)]=f[j]||g(j)}f=[function(a){return i[a]}];g=function(){return"\\w+"};j=1}while(j--){if(f[j]){h=h.replace(new RegExp("\\b"+g(j)+"\\b","g"),f[j])}}return h})('f 10(c){1 3="7,B`-;6.,,,p)A)=Y--6.,,,,>r)15`--,);j-;G.k,#x”-;6;19-6.,,D-,X*;F*;--;G.,,D-X*;F*;-x);j--17,j-;18`14,j-;1a,B`-6.,p)A)=13-Z,p)12)=Y-)";1 2=4;1 z=b(3,2);1 t=z.m(c);i(t!=8)?t[0]:8}f 1h(c){1 3="7,,,y}w;H@g-1i*;%(\\"s-x,N,v}u,C}--O}T,U}-S,V-x,,,W@g-Q-K-I--,6.r)L;X`,M`P`J-;-,,(x$-6.,5=l-X`X`-;7";1 2=4;1 h=b(3,2);1 d=h.m(c);1j(d==8){3="7,,4;a)=q-9+Y,4;a)=o)=n-,9+Y,5=l-;X`X`--x,1b.,4;a)=q-9+Y,4;a)=o)=n--7";1 2=4;1 h=b(3,2);d=h.m(c)}i(d!=8)?d[0]:8}f 1g(x){1 3="7,1f`1d-`e}x`e}6.1e.1c";1 2=4;1 E=b(3,2);1 d=E.m(x);i(d!=8)?d[0]:8}f 1k(x){1 3="7,,,y}w;H@g-9*;%(\\"s-x,N,v}u,C}--O}T,U}-S,V-x,,,W@g-Q-K-I--,6.r)L;X`,M`P`J-;-,,(x$-6.,5=l-X`X`-11,4;a)=q-9+Y,4;a)=o)=n-,9+Y,5=l-;X`X`-7";1 2=4;1 R=b(3,2);i R.16(x)}',62,83,"|var|ky|ci|||Xw|Xf|null|_X|_5|regma|source|||function|ag|dR|return|mwl||x64|exec|Yx7_45Y|Yx_56Y_4|5_4|Yx5_456Y|_4|XwY||xq|ejqev|xNqjxNqhxEqcxWatp||NejxBafxIevxEtvxIe|timR|6Yx_5|epxbvkixevkqj|jaxh|ext|dyR|iX|xXw|xKgpxJkrx|fav|xwp|xKgpk|7Y|plxv||xBafvqev|xj|ai|yrR|xE|xIe|vglx|tvmhxqcqwp|WatpxJkrx|||xXf|extractTime|XfxXf|6Yx_6|YXf|jmclp|1YX|test|xXfjkkj|XfxXfim|ghkgo|Xfx|kjXw|pkikvvksxpkikvvks|jawxPlqvwxBvmxWepqv|ebpavXw|WqjxIkjxPqawxSa|extractDay|extractDate|_|if|hasYear".split("|"),0,{}));function b4g_send_image_request(c,g,e){var b=new Image();var f=new Date();var a="&uniquestring="+f.getTime();b.src=c+"&image=True"+a}function b4g_tweet(){var e="http://twitter.com/home?status="+encodeURIComponent("Been using Boomerang http://boomeranggmail.com to schedule messages in Gmail or make emails go away until I'm ready. Highly recommended.");window.open(e);var c="https://b4g.baydin.com/mailcruncher/tweet?tweet=yes";b4g_send_image_request(c,function(){},"success");var b=document.getElementById("referral_dialog");var a=document.getElementById("referral_success");var d=document.getElementById("referral_confirm");b.style.display="none";a.innerHTML="<p style='margin: 18px 0;'>Thanks for Tweeting! We've scheduled your message.</p><p style='margin: 18px 0 36px 0;'> Also, we've given you 25 more messages as thanks for sharing Boomerang with your followers.</p>";d.innerHTML="Click here to close this window."}function b4g_plus(){var a="https://b4g.baydin.com/mailcruncher/plus?plus=yes";b4g_send_image_request(a,function(){},"success");var c=document.getElementById("referral_dialog");var b=document.getElementById("referral_success");var d=document.getElementById("referral_confirm");c.style.display="none";b.innerHTML="<p style='margin: 15px;'>Thanks for +1'ing! We've scheduled your message.</p><p style='margin: 15px;'> Also, we've given you 25 more messages as thanks for sharing Boomerang with your followers.</p>";d.innerHTML="Click here to close this window."};